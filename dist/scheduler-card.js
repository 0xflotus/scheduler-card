!function(e){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function t(e,t,r,a){var i,s=arguments.length,o=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var n=e.length-1;n>=0;n--)(i=e[n])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */}const r="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,a=(e,t,r=null)=>{for(;t!==r;){const r=t.nextSibling;e.removeChild(t),t=r}},i=`{{lit-${String(Math.random()).slice(2)}}}`,s=`\x3c!--${i}--\x3e`,o=new RegExp(`${i}|${s}`);class n{constructor(e,t){this.parts=[],this.element=t;const r=[],a=[],s=document.createTreeWalker(t.content,133,null,!1);let n=0,c=-1,h=0;const{strings:p,values:{length:m}}=e;for(;h<m;){const e=s.nextNode();if(null!==e){if(c++,1===e.nodeType){if(e.hasAttributes()){const t=e.attributes,{length:r}=t;let a=0;for(let e=0;e<r;e++)l(t[e].name,"$lit$")&&a++;for(;a-- >0;){const t=p[h],r=u.exec(t)[2],a=r.toLowerCase()+"$lit$",i=e.getAttribute(a);e.removeAttribute(a);const s=i.split(o);this.parts.push({type:"attribute",index:c,name:r,strings:s}),h+=s.length-1}}"TEMPLATE"===e.tagName&&(a.push(e),s.currentNode=e.content)}else if(3===e.nodeType){const t=e.data;if(t.indexOf(i)>=0){const a=e.parentNode,i=t.split(o),s=i.length-1;for(let t=0;t<s;t++){let r,s=i[t];if(""===s)r=d();else{const e=u.exec(s);null!==e&&l(e[2],"$lit$")&&(s=s.slice(0,e.index)+e[1]+e[2].slice(0,-"$lit$".length)+e[3]),r=document.createTextNode(s)}a.insertBefore(r,e),this.parts.push({type:"node",index:++c})}""===i[s]?(a.insertBefore(d(),e),r.push(e)):e.data=i[s],h+=s}}else if(8===e.nodeType)if(e.data===i){const t=e.parentNode;null!==e.previousSibling&&c!==n||(c++,t.insertBefore(d(),e)),n=c,this.parts.push({type:"node",index:c}),null===e.nextSibling?e.data="":(r.push(e),c--),h++}else{let t=-1;for(;-1!==(t=e.data.indexOf(i,t+1));)this.parts.push({type:"node",index:-1}),h++}}else s.currentNode=a.pop()}for(const e of r)e.parentNode.removeChild(e)}}const l=(e,t)=>{const r=e.length-t.length;return r>=0&&e.slice(r)===t},c=e=>-1!==e.index,d=()=>document.createComment(""),u=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function h(e,t){const{element:{content:r},parts:a}=e,i=document.createTreeWalker(r,133,null,!1);let s=m(a),o=a[s],n=-1,l=0;const c=[];let d=null;for(;i.nextNode();){n++;const e=i.currentNode;for(e.previousSibling===d&&(d=null),t.has(e)&&(c.push(e),null===d&&(d=e)),null!==d&&l++;void 0!==o&&o.index===n;)o.index=null!==d?-1:o.index-l,s=m(a,s),o=a[s]}c.forEach(e=>e.parentNode.removeChild(e))}const p=e=>{let t=11===e.nodeType?0:1;const r=document.createTreeWalker(e,133,null,!1);for(;r.nextNode();)t++;return t},m=(e,t=-1)=>{for(let r=t+1;r<e.length;r++){const t=e[r];if(c(t))return r}return-1};
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */
const f=new WeakMap,v=e=>"function"==typeof e&&f.has(e),y={},g={};
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */
class _{constructor(e,t,r){this.__parts=[],this.template=e,this.processor=t,this.options=r}update(e){let t=0;for(const r of this.__parts)void 0!==r&&r.setValue(e[t]),t++;for(const e of this.__parts)void 0!==e&&e.commit()}_clone(){const e=r?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],a=this.template.parts,i=document.createTreeWalker(e,133,null,!1);let s,o=0,n=0,l=i.nextNode();for(;o<a.length;)if(s=a[o],c(s)){for(;n<s.index;)n++,"TEMPLATE"===l.nodeName&&(t.push(l),i.currentNode=l.content),null===(l=i.nextNode())&&(i.currentNode=t.pop(),l=i.nextNode());if("node"===s.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(l.previousSibling),this.__parts.push(e)}else this.__parts.push(...this.processor.handleAttributeExpressions(l,s.name,s.strings,this.options));o++}else this.__parts.push(void 0),o++;return r&&(document.adoptNode(e),customElements.upgrade(e)),e}}
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */const b=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:e=>e}),w=` ${i} `;class P{constructor(e,t,r,a){this.strings=e,this.values=t,this.type=r,this.processor=a}getHTML(){const e=this.strings.length-1;let t="",r=!1;for(let a=0;a<e;a++){const e=this.strings[a],o=e.lastIndexOf("\x3c!--");r=(o>-1||r)&&-1===e.indexOf("--\x3e",o+1);const n=u.exec(e);t+=null===n?e+(r?w:s):e.substr(0,n.index)+n[1]+n[2]+"$lit$"+n[3]+i}return t+=this.strings[e],t}getTemplateElement(){const e=document.createElement("template");let t=this.getHTML();return void 0!==b&&(t=b.createHTML(t)),e.innerHTML=t,e}}
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */const S=e=>null===e||!("object"==typeof e||"function"==typeof e),E=e=>Array.isArray(e)||!(!e||!e[Symbol.iterator]);class x{constructor(e,t,r){this.dirty=!0,this.element=e,this.name=t,this.strings=r,this.parts=[];for(let e=0;e<r.length-1;e++)this.parts[e]=this._createPart()}_createPart(){return new $(this)}_getValue(){const e=this.strings,t=e.length-1,r=this.parts;if(1===t&&""===e[0]&&""===e[1]){const e=r[0].value;if("symbol"==typeof e)return String(e);if("string"==typeof e||!E(e))return e}let a="";for(let i=0;i<t;i++){a+=e[i];const t=r[i];if(void 0!==t){const e=t.value;if(S(e)||!E(e))a+="string"==typeof e?e:String(e);else for(const t of e)a+="string"==typeof t?t:String(t)}}return a+=e[t],a}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class ${constructor(e){this.value=void 0,this.committer=e}setValue(e){e===y||S(e)&&e===this.value||(this.value=e,v(e)||(this.committer.dirty=!0))}commit(){for(;v(this.value);){const e=this.value;this.value=y,e(this)}this.value!==y&&this.committer.commit()}}class j{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(d()),this.endNode=e.appendChild(d())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=d()),e.__insert(this.endNode=d())}insertAfterPart(e){e.__insert(this.startNode=d()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){if(null===this.startNode.parentNode)return;for(;v(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=y,e(this)}const e=this.__pendingValue;e!==y&&(S(e)?e!==this.value&&this.__commitText(e):e instanceof P?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):E(e)?this.__commitIterable(e):e===g?(this.value=g,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const t=this.startNode.nextSibling,r="string"==typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=r:this.__commitNode(document.createTextNode(r)),this.value=e}__commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof _&&this.value.template===t)this.value.update(e.values);else{const r=new _(t,e.processor,this.options),a=r._clone();r.update(e.values),this.__commitNode(a),this.value=r}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let r,a=0;for(const i of e)r=t[a],void 0===r&&(r=new j(this.options),t.push(r),0===a?r.appendIntoPart(this):r.insertAfterPart(t[a-1])),r.setValue(i),r.commit(),a++;a<t.length&&(t.length=a,this.clear(r&&r.endNode))}clear(e=this.startNode){a(this.startNode.parentNode,e.nextSibling,this.endNode)}}class k{constructor(e,t,r){if(this.value=void 0,this.__pendingValue=void 0,2!==r.length||""!==r[0]||""!==r[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=r}setValue(e){this.__pendingValue=e}commit(){for(;v(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=y,e(this)}if(this.__pendingValue===y)return;const e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=y}}class O extends x{constructor(e,t,r){super(e,t,r),this.single=2===r.length&&""===r[0]&&""===r[1]}_createPart(){return new C(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class C extends ${}let A=!1;(()=>{try{const e={get capture(){return A=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}})();class F{constructor(e,t,r){this.value=void 0,this.__pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=r,this.__boundHandleEvent=e=>this.handleEvent(e)}setValue(e){this.__pendingValue=e}commit(){for(;v(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=y,e(this)}if(this.__pendingValue===y)return;const e=this.__pendingValue,t=this.value,r=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),a=null!=e&&(null==t||r);r&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),a&&(this.__options=D(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=y}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}const D=e=>e&&(A?{capture:e.capture,passive:e.passive,once:e.once}:e.capture)
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */;function R(e){let t=z.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},z.set(e.type,t));let r=t.stringsArray.get(e.strings);if(void 0!==r)return r;const a=e.strings.join(i);return r=t.keyString.get(a),void 0===r&&(r=new n(e,e.getTemplateElement()),t.keyString.set(a,r)),t.stringsArray.set(e.strings,r),r}const z=new Map,I=new WeakMap;
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */const N=new
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */
class{handleAttributeExpressions(e,t,r,a){const i=t[0];if("."===i){return new O(e,t.slice(1),r).parts}if("@"===i)return[new F(e,t.slice(1),a.eventContext)];if("?"===i)return[new k(e,t.slice(1),r)];return new x(e,t,r).parts}handleTextExpression(e){return new j(e)}};
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.3.0");const T=(e,...t)=>new P(e,t,"html",N)
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */,L=(e,t)=>`${e}--${t}`;let V=!0;void 0===window.ShadyCSS?V=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),V=!1);const q=e=>t=>{const r=L(t.type,e);let a=z.get(r);void 0===a&&(a={stringsArray:new WeakMap,keyString:new Map},z.set(r,a));let s=a.stringsArray.get(t.strings);if(void 0!==s)return s;const o=t.strings.join(i);if(s=a.keyString.get(o),void 0===s){const r=t.getTemplateElement();V&&window.ShadyCSS.prepareTemplateDom(r,e),s=new n(t,r),a.keyString.set(o,s)}return a.stringsArray.set(t.strings,s),s},U=["html","svg"],M=new Set,Q=(e,t,r)=>{M.add(e);const a=r?r.element:document.createElement("template"),i=t.querySelectorAll("style"),{length:s}=i;if(0===s)return void window.ShadyCSS.prepareTemplateStyles(a,e);const o=document.createElement("style");for(let e=0;e<s;e++){const t=i[e];t.parentNode.removeChild(t),o.textContent+=t.textContent}(e=>{U.forEach(t=>{const r=z.get(L(t,e));void 0!==r&&r.keyString.forEach(e=>{const{element:{content:t}}=e,r=new Set;Array.from(t.querySelectorAll("style")).forEach(e=>{r.add(e)}),h(e,r)})})})(e);const n=a.content;r?function(e,t,r=null){const{element:{content:a},parts:i}=e;if(null==r)return void a.appendChild(t);const s=document.createTreeWalker(a,133,null,!1);let o=m(i),n=0,l=-1;for(;s.nextNode();){l++;for(s.currentNode===r&&(n=p(t),r.parentNode.insertBefore(t,r));-1!==o&&i[o].index===l;){if(n>0){for(;-1!==o;)i[o].index+=n,o=m(i,o);return}o=m(i,o)}}}(r,o,n.firstChild):n.insertBefore(o,n.firstChild),window.ShadyCSS.prepareTemplateStyles(a,e);const l=n.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==l)t.insertBefore(l.cloneNode(!0),t.firstChild);else if(r){n.insertBefore(o,n.firstChild);const e=new Set;e.add(o),h(r,e)}};window.JSCompiler_renameProperty=(e,t)=>e;const H={toAttribute(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},G=(e,t)=>t!==e&&(t==t||e==e),K={attribute:!0,type:String,converter:H,reflect:!1,hasChanged:G};class B extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach((t,r)=>{const a=this._attributeNameForProperty(r,t);void 0!==a&&(this._attributeToPropertyMap.set(a,r),e.push(a))}),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;void 0!==e&&e.forEach((e,t)=>this._classProperties.set(t,e))}}static createProperty(e,t=K){if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const r="symbol"==typeof e?Symbol():"__"+e,a=this.getPropertyDescriptor(e,r,t);void 0!==a&&Object.defineProperty(this.prototype,e,a)}static getPropertyDescriptor(e,t,r){return{get(){return this[t]},set(a){const i=this[e];this[t]=a,this.requestUpdateInternal(e,i,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this._classProperties&&this._classProperties.get(e)||K}static finalize(){const e=Object.getPrototypeOf(this);if(e.hasOwnProperty("finalized")||e.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]];for(const r of t)this.createProperty(r,e[r])}}static _attributeNameForProperty(e,t){const r=t.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t,r=G){return r(e,t)}static _propertyValueFromAttribute(e,t){const r=t.type,a=t.converter||H,i="function"==typeof a?a:a.fromAttribute;return i?i(e,r):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const r=t.type,a=t.converter;return(a&&a.toAttribute||H.toAttribute)(e,r)}initialize(){this._updateState=0,this._updatePromise=new Promise(e=>this._enableUpdatingResolver=e),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}})}_applyInstanceProperties(){this._instanceProperties.forEach((e,t)=>this[t]=e),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,t,r){t!==r&&this._attributeToProperty(e,r)}_propertyToAttribute(e,t,r=K){const a=this.constructor,i=a._attributeNameForProperty(e,r);if(void 0!==i){const e=a._propertyValueToAttribute(t,r);if(void 0===e)return;this._updateState=8|this._updateState,null==e?this.removeAttribute(i):this.setAttribute(i,e),this._updateState=-9&this._updateState}}_attributeToProperty(e,t){if(8&this._updateState)return;const r=this.constructor,a=r._attributeToPropertyMap.get(e);if(void 0!==a){const e=r.getPropertyOptions(a);this._updateState=16|this._updateState,this[a]=r._propertyValueFromAttribute(t,e),this._updateState=-17&this._updateState}}requestUpdateInternal(e,t,r){let a=!0;if(void 0!==e){const i=this.constructor;r=r||i.getPropertyOptions(e),i._valueHasChanged(this[e],t,r.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==r.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,r))):a=!1}!this._hasRequestedUpdate&&a&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(e,t){return this.requestUpdateInternal(e,t),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(e){}const e=this.performUpdate();return null!=e&&await e,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{e=this.shouldUpdate(t),e?this.update(t):this._markUpdated()}catch(t){throw e=!1,this._markUpdated(),t}e&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(t)),this.updated(t))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((e,t)=>this._propertyToAttribute(t,this[t],e)),this._reflectingProperties=void 0),this._markUpdated()}updated(e){}firstUpdated(e){}}B.finalized=!0;
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */
const J=e=>t=>"function"==typeof t?((e,t)=>(window.customElements.define(e,t),t))(e,t):((e,t)=>{const{kind:r,elements:a}=t;return{kind:r,elements:a,finisher(t){window.customElements.define(e,t)}}})(e,t),W=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?Object.assign(Object.assign({},t),{finisher(r){r.createProperty(t.key,e)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(r){r.createProperty(t.key,e)}};function Z(e){return(t,r)=>void 0!==r?((e,t,r)=>{t.constructor.createProperty(r,e)})(e,t,r):W(e,t)}
/**
    @license
    Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
    This code may only be used under the BSD style license found at
    http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
    http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
    found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
    part of the polymer project is also subject to an additional IP rights grant
    found at http://polymer.github.io/PATENTS.txt
    */const Y=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,X=Symbol();class ee{constructor(e,t){if(t!==X)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&(Y?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const te=(e,...t)=>{const r=t.reduce((t,r,a)=>t+(e=>{if(e instanceof ee)return e.cssText;if("number"==typeof e)return e;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${e}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(r)+e[a+1],e[0]);return new ee(r,X)};
/**
     * @license
     * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
     * This code may only be used under the BSD style license found at
     * http://polymer.github.io/LICENSE.txt
     * The complete set of authors may be found at
     * http://polymer.github.io/AUTHORS.txt
     * The complete set of contributors may be found at
     * http://polymer.github.io/CONTRIBUTORS.txt
     * Code distributed by Google as part of the polymer project is also
     * subject to an additional IP rights grant found at
     * http://polymer.github.io/PATENTS.txt
     */
(window.litElementVersions||(window.litElementVersions=[])).push("2.4.0");const re={};class ae extends B{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const e=this.getStyles();if(Array.isArray(e)){const t=(e,r)=>e.reduceRight((e,r)=>Array.isArray(r)?t(r,e):(e.add(r),e),r),r=t(e,new Set),a=[];r.forEach(e=>a.unshift(e)),this._styles=a}else this._styles=void 0===e?[]:[e];this._styles=this._styles.map(e=>{if(e instanceof CSSStyleSheet&&!Y){const t=Array.prototype.slice.call(e.cssRules).reduce((e,t)=>e+t.cssText,"");return new ee(String(t),X)}return e})}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?Y?this.renderRoot.adoptedStyleSheets=e.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(e=>e.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(e){const t=this.render();super.update(e),t!==re&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)}))}render(){return re}}var ie;ae.finalized=!0,ae.render=(e,t,r)=>{if(!r||"object"!=typeof r||!r.scopeName)throw new Error("The `scopeName` option is required.");const i=r.scopeName,s=I.has(t),o=V&&11===t.nodeType&&!!t.host,n=o&&!M.has(i),l=n?document.createDocumentFragment():t;if(((e,t,r)=>{let i=I.get(t);void 0===i&&(a(t,t.firstChild),I.set(t,i=new j(Object.assign({templateFactory:R},r))),i.appendInto(t)),i.setValue(e),i.commit()})(e,l,Object.assign({templateFactory:q(i)},r)),n){const e=I.get(l);I.delete(l);const r=e.value instanceof _?e.value.template:void 0;Q(i,l,r),a(t,t.firstChild),t.appendChild(l),I.set(t,e)}!s&&o&&window.ShadyCSS.styleElement(t.host)},function(e){e.Level="LEVEL",e.List="LIST"}(ie||(ie={}));var se,oe;function ne(e,t){let r=e>=0?Math.floor(e/60):Math.ceil(e/60),a=e-60*r;return a%t!=0&&(a=Math.round(a/t)*t),a>=60&&(r++,a-=60),r>=24&&(r-=24),60*r+a}function le(e,t={}){let r=!!t.amPm&&t.amPm,a=!!t.absolute&&t.absolute,i=e>=0?Math.floor(e/60):Math.ceil(e/60),s=e-60*i,o="";r&&(o=i>=12?"PM":"AM",(i>12||12==i&&s>0)&&(i-=12));let n=String(Math.abs(i)).padStart(2,"0"),l=String(Math.abs(s)).padStart(2,"0"),c=i<0||s<0;return{hours:n,minutes:l,time:`${c&&!a?"-":""}${n}:${l}${r?" "+o:""}`,signed:c,amPm:o}}function ce(e,t={}){let r=t.stepSize?t.stepSize:1,a=!!t.signed&&t.signed,i=t.max?t.max:1440,s=ne(e,r);return s<0&&!a?e+=1440:s>=1440&&(e-=1440),s<-i?-i:s>i?i:e}function de(e){let t,r,a;if(null!==(a=/^([0-9]{2}):([0-9]{2})$/.exec(e)))[t,r]=[Number(a[1]),Number(a[2])];else if(null!==(a=/^([0-9]{2})([0-9]{2})$/.exec(e)))[t,r]=[Number(a[1]),Number(a[2])];else{if(null!==(a=/^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}[\+|\-][0-9]{2}:[0-9]{2}$/.exec(e))){let e=new Date(a[0]);return de(`${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`)}console.log(`failed to parse timestamp '${e}'`)}return 60*t+r}function ue(e){return e.type==oe.Weekdays?[1,2,3,4,5]:e.type==oe.Custom&&e.custom_days?e.custom_days.sort().filter(e=>0!=e):[]}function he(e){let t=[1,2,3,4,5,6,7],r=[1,2,3,4,5],a=[...e].sort().filter(e=>0!=e);return a.every((e,r)=>e==t[r])?{type:oe.Daily,custom_days:[]}:a.every((e,t)=>e==r[t])?{type:oe.Weekdays,custom_days:[]}:{type:oe.Custom,custom_days:a}}function pe(e){return e==se.Sunrise?"sunrise":"sunset"}!function(e){e.Sunrise="SUNRISE",e.Sunset="SUNSET"}(se||(se={})),function(e){e.Daily="DAILY",e.Weekdays="WEEKDAYS",e.Custom="CUSTOM"}(oe||(oe={}));const me={sunrise:null,sunset:null,title:!0,am_pm:!1,time_step:10,temperature_unit:"",is_admin:!0},fe={climate:{},cover:{},fan:{},light:{},switch:{}},ve={time:{value:de("12:00")},days:{type:oe.Daily},action:"",entity:""},ye="create_routine",ge={type:ie.Level,field:"",unit:"",name:"level",min:0,max:255,step:1,optional:!1},_e={type:ie.List,field:"",name:"option",options:[]};de("00:00"),de("08:00"),de("08:00"),de("16:00"),de("16:00");var be={add:"hinzufügen",cancel:"abbrechen",next:"weiter",save:"speichern",delete:"löschen"},we={no_group_selected:"Wähle zuerst eine Gruppe aus",no_entity_selected:"Wähle zuerst eine Entity aus",no_groups_defined:"Es gibt keine Gruppe",no_entities_for_group:"Es gibt keine Entities in dieser Gruppe",no_actions_for_entity:"Es gibt keine Aktionen für diese Entity",no_entries_defined:"Es gibt keine Einträge"},Pe={group:"Gruppe",entity:"Entity",action:"Aktion",days:"Tage",time:"Zeit",options:"Optionen",day_type_daily:"jeden Tag",day_type_weekdays:"Werktags",day_type_custom:"benutzerdefiniert",shift_with_sun:"Zeit automatisch an Sonnenauf- bzw. Sonnenuntergang anpassen",brightness:"Helligkeit",temperature:"Temperatur",position:"Position"},Se={mon:"Mo",tue:"Di",wed:"Mi",thu:"Do",fri:"Fr",sat:"Sa",sun:"So"},Ee={mon:"Montag",tue:"Dienstag",wed:"Mittwoch",thu:"Donnerstag",fri:"Freitag",sat:"Samstag",sun:"Sonntag"},xe={on:"An",every:"jeden",and:"und",at:"um",before:"vor",after:"nach",sunrise:"Sonnenaufgang",sunset:"Sonnenuntergang"},$e={turn_on:"anschalten",turn_off:"ausschalten",close_cover:"schließen",open_cover:"öffnen",set_temperature:"Temperatur einstellen",set_to:"setzen auf",set_position:"Position setzen",set_hvac_mode:"set mode",set_preset_mode:"set preset",set_value:"set value",select_option:"select option",select_source:"select source",start:"start"},je={camera:"cameras",climate:"Heizung",cover:"Beschattung",fan:"Lüfter",group:"groups",input_boolean:"input_boolean",input_number:"input_number",input_select:"input_select",light:"Licht",media_player:"media players",scene:"scenes",switch:"Schalter",vacuum:"Staubsauger"},ke={scheduler:"Zeitplaner",actions:be,instructions:we,fields:Pe,days_short:Se,days_long:Ee,words:xe,services:$e,domains:je},Oe=Object.freeze({__proto__:null,scheduler:"Zeitplaner",actions:be,instructions:we,fields:Pe,days_short:Se,days_long:Ee,words:xe,services:$e,domains:je,default:ke}),Ce={add:"add item",cancel:"cancel",next:"next",save:"save",delete:"delete"},Ae={no_group_selected:"Select a group first",no_entity_selected:"Select an entity first",no_groups_defined:"There are no groups defined",no_entities_for_group:"There are no entities in this group",no_actions_for_entity:"There are no actions for this entity",no_entries_defined:"There are no items to show"},Fe={group:"Group",entity:"Entity",action:"Action",days:"Days",time:"Time",options:"Options",day_type_daily:"daily",day_type_weekdays:"weekdays",day_type_custom:"custom",shift_with_sun:"automatically adjust time to sunrise/sunset",brightness:"Brightness",temperature:"Temperature",position:"Position"},De={mon:"mon",tue:"tue",wed:"wed",thu:"thu",fri:"fri",sat:"sat",sun:"sun"},Re={mon:"monday",tue:"tuesday",wed:"wednesday",thu:"thursday",fri:"friday",sat:"saturday",sun:"sunday"},ze={on:"on",every:"every",and:"and",at:"at",before:"before",after:"after",sunrise:"sunrise",sunset:"sunset"},Ie={turn_on:"turn on",turn_off:"turn off",close_cover:"close",open_cover:"open",set_temperature:"set temperature",set_to:"set to",set_position:"set position",set_hvac_mode:"set mode",set_preset_mode:"set preset",set_value:"set value",select_option:"select option",select_source:"select source",start:"start"},Ne={camera:"cameras",climate:"climate",cover:"covers",fan:"fans",group:"groups",input_boolean:"input_boolean",input_number:"input_number",input_select:"input_select",light:"lights",media_player:"media players",scene:"scenes",switch:"switches",vacuum:"vacuum"},Te={scheduler:"Scheduler",actions:Ce,instructions:Ae,fields:Fe,days_short:De,days_long:Re,words:ze,services:Ie,domains:Ne},Le=Object.freeze({__proto__:null,scheduler:"Scheduler",actions:Ce,instructions:Ae,fields:Fe,days_short:De,days_long:Re,words:ze,services:Ie,domains:Ne,default:Te}),Ve={add:"Agregar",cancel:"cancelar",next:"siguiente",save:"guardar",delete:"borrar"},qe={no_group_selected:"Selecciona un grupo primero",no_entity_selected:"Selecciona una entidad primero",no_groups_defined:"No hay grupos definidos",no_entities_for_group:"No hay entidades en este grupo",no_actions_for_entity:"No hay acciones para esta entidad",no_entries_defined:"No hay dispositivos definidos"},Ue={group:"Grupo",entity:"Entidad",action:"Acción",days:"Días",time:"Hora",options:"Opciones",day_type_daily:"cada día",day_type_weekdays:"dias semanales",day_type_custom:"personalizado",shift_with_sun:"ajusta automaticamente la hora al amanecer/atardecer",brightness:"Brillo",temperature:"Temperatura",position:"Posición"},Me={mon:"lun",tue:"mar",wed:"mie",thu:"jue",fri:"vie",sat:"sab",sun:"dom"},Qe={mon:"lunes",tue:"martes",wed:"miércoles",thu:"jueves",fri:"viernes",sat:"sábado",sun:"domingo"},He={on:"el",every:"cada",and:"y",at:"a las",before:"antes",after:"después",sunrise:"amanecer",sunset:"atardecer"},Ge={turn_on:"encender",turn_off:"apagar",close_cover:"cerrar",open_cover:"abrir",set_temperature:"establecer temperatura",set_to:"establecer a",set_position:"posición de ajuste",set_hvac_mode:"set mode",set_preset_mode:"set preset",set_value:"set value",select_option:"select option",select_source:"select source",start:"start"},Ke={camera:"cameras",climate:"climatización",cover:"persiana",fan:"ventilador",group:"groups",input_boolean:"input_boolean",input_number:"input_number",input_select:"input_select",light:"luces",media_player:"media players",scene:"scenes",switch:"interruptores",vacuum:"aspirador"},Be={scheduler:"Programador",actions:Ve,instructions:qe,fields:Ue,days_short:Me,days_long:Qe,words:He,services:Ge,domains:Ke},Je=Object.freeze({__proto__:null,scheduler:"Programador",actions:Ve,instructions:qe,fields:Ue,days_short:Me,days_long:Qe,words:He,services:Ge,domains:Ke,default:Be}),We={add:"lisa",cancel:"loobu",next:"edasi",save:"salvesta",delete:"kustuta"},Ze={no_group_selected:"Vali grupp",no_entity_selected:"Vali olem",no_groups_defined:"Gruppe pole määratud",no_entities_for_group:"Antud grupis puuduvad olemid",no_actions_for_entity:"Selles olemis puuduvad tegevused",no_entries_defined:"Pole midagi kuvada"},Ye={group:"Grupp",entity:"Olem",action:"Tegevus",days:"Päev",time:"Aeg",options:"Suvandid",day_type_daily:"iga päev",day_type_weekdays:"tööpäevadel",day_type_custom:"valikuline",shift_with_sun:"määrake automaatselt Päikese tõus/loojang",brightness:"Heledus",temperature:"Temperatuur",position:"Asukoht"},Xe={mon:"E",tue:"T",wed:"K",thu:"N",fri:"R",sat:"L",sun:"P"},et={mon:"Esmaspäev",tue:"Teisipäev",wed:"Kolmapäev",thu:"Neljapäev",fri:"Reede",sat:"Laupäev",sun:"Pühapäev"},tt={on:" ",every:"iga",and:"ja",at:"kell",before:"enne",after:"pärast",sunrise:"päikesetõus",sunset:"loojang"},rt={turn_on:"lülita sisse",turn_off:"lülita välja",close_cover:"sulge",open_cover:"ava",set_temperature:"määra temperatuur",set_to:"seadista väärtusele",set_position:"seadista asendisse",set_hvac_mode:"set mode",set_preset_mode:"set preset",set_value:"set value",select_option:"select option",select_source:"select source",start:"start"},at={camera:"cameras",climate:"kliimaseade",cover:"(akna)katted",fan:"ventilaatorid",group:"groups",input_boolean:"input_boolean",input_number:"input_number",input_select:"input_select",light:"valgustid",media_player:"media players",scene:"scenes",switch:"lülitid",vacuum:"tolmuimejad"},it={scheduler:"Ajastaja",actions:We,instructions:Ze,fields:Ye,days_short:Xe,days_long:et,words:tt,services:rt,domains:at},st=Object.freeze({__proto__:null,scheduler:"Ajastaja",actions:We,instructions:Ze,fields:Ye,days_short:Xe,days_long:et,words:tt,services:rt,domains:at,default:it}),ot={add:"ajouter un item",cancel:"annuler",next:"suivant",save:"sauvegarder",delete:"effacer"},nt={no_group_selected:"Sélectionner un groupe en premier",no_entity_selected:"Sélectionner une entité en premier",no_groups_defined:"Il n'y a pas de groupe défini",no_entities_for_group:"Il n'y a pas d'entité dans ce groupe",no_actions_for_entity:"Il n'y a pas d'action pour cette entité",no_entries_defined:"Il n'y a pas d'item à afficher"},lt={group:"Groupe",entity:"Entité",action:"Action",days:"Jours",time:"Temps",options:"Options",day_type_daily:"chaque jour",day_type_weekdays:"en semaine",day_type_custom:"sur mesure",shift_with_sun:"ajuster automatiquement l'heure au lever/coucher du soleil",brightness:"Luminosité",temperature:"Température",position:"Position"},ct={mon:"lun",tue:"mar",wed:"mer",thu:"jeu",fri:"ven",sat:"sam",sun:"dim"},dt={mon:"lundi",tue:"mardi",wed:"mercredi",thu:"jeudi",fri:"vendredi",sat:"samedi",sun:"dimanche"},ut={on:"marche",every:"tout",and:"et",at:"à",before:"avant",after:"après",sunrise:"lever du soleil",sunset:"coucher du soleil"},ht={turn_on:"allumer",turn_off:"éteindre",close_cover:"fermer",open_cover:"ouvrir",set_temperature:"régler la température",set_to:"défini à",set_position:"position définie",set_hvac_mode:"set mode",set_preset_mode:"set preset",set_value:"set value",select_option:"select option",select_source:"select source",start:"start"},pt={camera:"cameras",climate:"climat",cover:"contrôleur",fan:"ventilateur",group:"groups",input_boolean:"input_boolean",input_number:"input_number",input_select:"input_select",light:"lumière",media_player:"media players",scene:"scenes",switch:"interrupteurs",vacuum:"aspirateur"},mt={scheduler:"Planificateur",actions:ot,instructions:nt,fields:lt,days_short:ct,days_long:dt,words:ut,services:ht,domains:pt},ft=Object.freeze({__proto__:null,scheduler:"Planificateur",actions:ot,instructions:nt,fields:lt,days_short:ct,days_long:dt,words:ut,services:ht,domains:pt,default:mt}),vt={add:"új időzítés",cancel:"mégse",next:"tovább",save:"törlés",delete:"delete"},yt={no_group_selected:"Előbb egy csoportot szükséges választani",no_entity_selected:"Előbb egy entitást szükséges választani",no_groups_defined:"Nincsenek deffiniált csoportok",no_entities_for_group:"Ebben a csoportban nem találhatók entitások",no_actions_for_entity:"Ehhez az entitáshoz nem tartoznak műveletek",no_entries_defined:"Nincs megjeleníthető elem"},gt={group:"Csoport",entity:"Entitás",action:"Művelet",days:"Napokon",time:"Időpontban",options:"Opciók",day_type_daily:"minden nap",day_type_weekdays:"munkanapokon",day_type_custom:"egyedi",shift_with_sun:"Az idő automatikus igazítása napkeltéhez/naplementéhez",brightness:"Fényerő",temperature:"Hőmérséklet",position:"Pozíciót"},_t={mon:"hét",tue:"ked",wed:"sze",thu:"csü",fri:"pén",sat:"szo",sun:"vas"},bt={mon:"hétfő",tue:"kedd",wed:"szerda",thu:"csütörtök",fri:"péntek",sat:"szombat",sun:"vasárnap"},wt={on:"on",every:"minden",and:"és",at:"at",before:"előtt",after:"után",sunrise:"napkelte",sunset:"naplemente"},Pt={turn_on:"bekapcsolás",turn_off:"kikapcsolás",close_cover:"zárás",open_cover:"nyitás",set_temperature:"hőmérséklet",set_to:"beállítva",set_position:"változtass pozíciót",set_hvac_mode:"set mode",set_preset_mode:"set preset",set_value:"set value",select_option:"select option",select_source:"select source",start:"start"},St={camera:"cameras",climate:"termosztát",cover:"redőny",fan:"ventilátor",group:"groups",input_boolean:"input_boolean",input_number:"input_number",input_select:"input_select",light:"lámpa",media_player:"media players",scene:"scenes",switch:"kapcsoló",vacuum:"pórszívó"},Et={scheduler:"Időzítések",actions:vt,instructions:yt,fields:gt,days_short:_t,days_long:bt,words:wt,services:Pt,domains:St},xt=Object.freeze({__proto__:null,scheduler:"Időzítések",actions:vt,instructions:yt,fields:gt,days_short:_t,days_long:bt,words:wt,services:Pt,domains:St,default:Et}),$t={add:"Nieuw item",cancel:"annuleren",next:"verder",save:"opslaan",delete:"verwijder"},jt={no_group_selected:"Selecteer eerst een groep",no_entity_selected:"Selecteer eerst een entiteit",no_groups_defined:"Er zijn geen groepen gedefinieerd",no_entities_for_group:"Deze groep heeft geen entiteiten",no_actions_for_entity:"Deze entiteit heeft geen acties",no_entries_defined:"Er zijn geen items aangemaakt"},kt={group:"Groep",entity:"Entiteit",action:"Actie",days:"Dagen",time:"Tijdstip",options:"Opties",day_type_daily:"Dagelijks",day_type_weekdays:"werkdagen",day_type_custom:"Anders",shift_with_sun:"Automatisch aanpassen aan zonsopgang/zonsondergang",brightness:"Helderheid",temperature:"Temperatuur",position:"Positie"},Ot={mon:"ma",tue:"di",wed:"wo",thu:"do",fri:"vr",sat:"za",sun:"zo"},Ct={mon:"maandag",tue:"dinsdag",wed:"woensdag",thu:"donderdag",fri:"vrijdag",sat:"zaterdag",sun:"zondag"},At={on:"op",every:"elke",and:"en",at:"om",before:"voor",after:"na",sunrise:"zonsopgang",sunset:"zonsondergang"},Ft={turn_on:"aanzetten",turn_off:"uitzetten",close_cover:"sluiten",open_cover:"openen",set_temperature:"temperatuur instellen",set_to:"Zet op",set_position:"positie instellen",set_hvac_mode:"stand aanpassen",set_preset_mode:"voorinstelling kiezen",set_value:"waarde instellen",select_option:"optie selecteren",select_source:"ingang selecteren",start:"starten"},Dt={camera:"cameras",climate:"verwarming",cover:"zonwering",fan:"ventilatie",group:"groepen",input_boolean:"input_boolean",input_number:"input_number",input_select:"input_select",light:"verlichting",media_player:"mediaspelers",scene:"scènes",switch:"schakelaars",vacuum:"stofzuigers"},Rt={scheduler:"Tijdplanner",actions:$t,instructions:jt,fields:kt,days_short:Ot,days_long:Ct,words:At,services:Ft,domains:Dt},zt=Object.freeze({__proto__:null,scheduler:"Tijdplanner",actions:$t,instructions:jt,fields:kt,days_short:Ot,days_long:Ct,words:At,services:Ft,domains:Dt,default:Rt}),It={add:"legg til",cancel:"avbryt",next:"neste",save:"lagre",delete:"slett"},Nt={no_group_selected:"Velg en gruppe først",no_entity_selected:"Velg en entitet først",no_groups_defined:"Ingen grupper definert",no_entities_for_group:"Det finnes ingen entiteter i denne gruppen",no_actions_for_entity:"Det finnes ingen handlinger for denne entiteten",no_entries_defined:"Det er ingen definerte tidsplaner å vise"},Tt={group:"Gruppe",entity:"Entitet",action:"Handling",days:"Dager",time:"Tid",options:"Valg",day_type_daily:"hver dag",day_type_weekdays:"ukedager",day_type_custom:"egendefinert",shift_with_sun:"automatisk juster tid for soloppgang/solnedgang",brightness:"Lysstyrke",temperature:"Temperatur",position:"Posisjon"},Lt={mon:"man",tue:"tir",wed:"ons",thu:"tor",fri:"fre",sat:"lør",sun:"søn"},Vt={mon:"mandag",tue:"tirsdag",wed:"onsdag",thu:"torsdag",fri:"fredag",sat:"lørdag",sun:"søndag"},qt={on:"den",every:"hver",and:"og",at:"på",before:"før",after:"etter",sunrise:"soloppgang",sunset:"solnedgang"},Ut={turn_on:"slå på",turn_off:"slå av",close_cover:"lukk",open_cover:"åpne",set_temperature:"sett temperatur",set_to:"sett til",set_position:"sett posisjon",set_hvac_mode:"set mode",set_preset_mode:"set preset",set_value:"set value",select_option:"select option",select_source:"select source",start:"start"},Mt={camera:"cameras",climate:"klima",cover:"cover",fan:"vifter",group:"groups",input_boolean:"input_boolean",input_number:"input_number",input_select:"input_select",media_player:"media players",scene:"scenes",light:"lys",switch:"brytere",vacuum:"støvsugere"},Qt={scheduler:"Tidsplan",actions:It,instructions:Nt,fields:Tt,days_short:Lt,days_long:Vt,words:qt,services:Ut,domains:Mt},Ht=Object.freeze({__proto__:null,scheduler:"Tidsplan",actions:It,instructions:Nt,fields:Tt,days_short:Lt,days_long:Vt,words:qt,services:Ut,domains:Mt,default:Qt}),Gt={add:"dodaj",cancel:"anuluj",next:"dalej",save:"zapisz",delete:"usuń"},Kt={no_group_selected:"Najpierw wybierz grupę",no_entity_selected:"Najpierw wybierz encję",no_groups_defined:"Nie ma zdefiniowanych grup",no_entities_for_group:"Nie ma encji w tej grupie",no_actions_for_entity:"Nie ma akcji dla tej encji",no_entries_defined:"Nie ma elementów do pokazania"},Bt={group:"Grupa",entity:"Encja",action:"Akcja",days:"Dni",time:"Czas",options:"Opcje",day_type_daily:"codziennie",day_type_weekdays:"dni tygodnia",day_type_custom:"niestandardowy",shift_with_sun:"automatycznie dopasuj czas do wschodów/zachodów",brightness:"Jasność",temperature:"Temperatura",position:"Pozycję"},Jt={mon:"pon",tue:"wt",wed:"śr",thu:"czw",fri:"pt",sat:"sob",sun:"niedz"},Wt={mon:"poniedziałek",tue:"wtorek",wed:"środa",thu:"czwartek",fri:"piątek",sat:"sobota",sun:"niedziela"},Zt={on:"w",every:"każdy",and:"oraz",at:"o",before:"przed",after:"po",sunrise:"wschód",sunset:"zachodów"},Yt={turn_on:"włącz",turn_off:"wyłącz",close_cover:"zamknij",open_cover:"otwórz",set_temperature:"Ustaw temperaturę",set_to:"ustaw na",set_position:"Ustaw pozycję",set_hvac_mode:"set mode",set_preset_mode:"set preset",set_value:"set value",select_option:"select option",select_source:"select source",start:"start"},Xt={camera:"cameras",climate:"termostat",cover:"roleta",fan:"wiatrak",group:"groups",input_boolean:"input_boolean",input_number:"input_number",input_select:"input_select",media_player:"media players",scene:"scenes",light:"światło",switch:"włącznik",vacuum:"odkurzacz"},er={scheduler:"Harmonogram",actions:Gt,instructions:Kt,fields:Bt,days_short:Jt,days_long:Wt,words:Zt,services:Yt,domains:Xt},tr=Object.freeze({__proto__:null,scheduler:"Harmonogram",actions:Gt,instructions:Kt,fields:Bt,days_short:Jt,days_long:Wt,words:Zt,services:Yt,domains:Xt,default:er}),rr={add:"adicionar item",cancel:"cancelar",next:"próximo",save:"gravar",delete:"apagar"},ar={no_group_selected:"Selecione um grupo primeiro",no_entity_selected:"Selecione uma entidade primeiro",no_groups_defined:"Não tem grupo definido",no_entities_for_group:"Não tem entidade no grupo",no_actions_for_entity:"Não há ações para esta entidade",no_entries_defined:"Não tem item pra mostar"},ir={group:"Grupo",entity:"Entidade",action:"Ação",days:"Dias",time:"Hora",options:"Opções",day_type_daily:"todos os dias",day_type_weekdays:"dias da semana",day_type_custom:"personalizado",shift_with_sun:"automaticamente ajusta hora pelo nascer do sol/pôr do sol",brightness:"Brilho",temperature:"Temperatura",position:"Posição"},sr={mon:"seg",tue:"ter",wed:"qua",thu:"qui",fri:"sex",sat:"sab",sun:"dom"},or={mon:"segunda",tue:"terça",wed:"quarta",thu:"quinta",fri:"sexta",sat:"sabádo",sun:"domingo"},nr={on:"on",every:"cada",and:"e",at:"às",before:"antes",after:"depois",sunrise:"nascer do sol",sunset:"pôr do sol"},lr={turn_on:"ligar",turn_off:"desligar",close_cover:"fechar",open_cover:"abrir",set_temperature:"ajustar temperatura",set_to:"ajustar para",set_position:"ajustar posição",set_hvac_mode:"set mode",set_preset_mode:"set preset",set_value:"set value",select_option:"select option",select_source:"select source",start:"start"},cr={camera:"cameras",climate:"ar condicionado",cover:"persiana",fan:"ventilador",group:"groups",input_boolean:"input_boolean",input_number:"input_number",input_select:"input_select",media_player:"media players",scene:"scenes",light:"luz",switch:"interruptor",vacuum:"aspirador"},dr={scheduler:"Agenda",actions:rr,instructions:ar,fields:ir,days_short:sr,days_long:or,words:nr,services:lr,domains:cr},ur=Object.freeze({__proto__:null,scheduler:"Agenda",actions:rr,instructions:ar,fields:ir,days_short:sr,days_long:or,words:nr,services:lr,domains:cr,default:dr}),hr={add:"добавить",cancel:"отменить",next:"далее",save:"сохранить",delete:"удалить"},pr={no_group_selected:"Необходимо выбрать группу",no_entity_selected:"Необходимо выбрать объект",no_groups_defined:"Ни одной группы не создано",no_entities_for_group:"В этой группе нет объектов",no_actions_for_entity:"Для этого объекта нет действий",no_entries_defined:"Объекты отсутствуют"},mr={group:"Группа",entity:"Объект",action:"Действие",days:"Дни",time:"Время",options:"Опции",day_type_daily:"ежедневно",day_type_weekdays:"по будням",day_type_custom:"выбрать дни",shift_with_sun:"автоматически настраивать время на восход / закат",brightness:"Яркость",temperature:"Температура",position:"Позицию"},fr={mon:"пн",tue:"вт",wed:"ср",thu:"чт",fri:"пт",sat:"сб",sun:"вс"},vr={mon:"понедельник",tue:"вторник",wed:"среда",thu:"четверг",fri:"пятница",sat:"суббота",sun:"воскресенье"},yr={on:"по",every:"каждый",and:"и",at:"в",before:"до",after:"после",sunrise:"восхода",sunset:"заката"},gr={turn_on:"включить",turn_off:"выключить",close_cover:"закрыть",open_cover:"открыть",set_temperature:"задать температуру",set_to:"установить",set_position:"установить позицию",set_hvac_mode:"set mode",set_preset_mode:"set preset",set_value:"set value",select_option:"select option",select_source:"select source",start:"start"},_r={camera:"cameras",climate:"Климат",cover:"Жалюзи",fan:"Вентиляторы",group:"groups",input_boolean:"input_boolean",input_number:"input_number",input_select:"input_select",media_player:"media players",scene:"scenes",light:"Свет",switch:"Выключатели",vacuum:"Пылесосы"},br={scheduler:"Планирование",actions:hr,instructions:pr,fields:mr,days_short:fr,days_long:vr,words:yr,services:gr,domains:_r},wr={de:Oe,en:Le,es:Je,et:st,es_419:Je,fr:ft,hu:xt,nb:Ht,nl:zt,nn:Ht,no:Ht,pl:tr,pt:ur,pt_BR:ur,ru:Object.freeze({__proto__:null,scheduler:"Планирование",actions:hr,instructions:pr,fields:mr,days_short:fr,days_long:vr,words:yr,services:gr,domains:_r,default:br})};function Pr(e,t="",r=""){const a=Sr();var i;try{if("test"==a)return"TRANSLATED";i=e.split(".").reduce((e,t)=>e[t],wr[a])}catch(t){i=e.split(".").reduce((e,t)=>e[t],wr.en)}return void 0===i&&(i=e.split(".").reduce((e,t)=>e[t],wr.en)),""!==t&&""!==r&&(i=i.replace(t,r)),i}function Sr(){var e;let t=null===(e=localStorage.getItem("selectedLanguage"))||void 0===e?void 0:e.replace(/['"]+/g,"").replace("-","_");if(!t||"null"==t){const e=document.querySelector("home-assistant").hass;t=e.selectedLanguage||e.language||"en"}return String(t)}const Er={turn_on:"services.turn_on",turn_off:"services.turn_off",open_cover:"services.open_cover",close_cover:"services.close_cover",set_temperature:"services.set_temperature",set_cover_position:"services.set_cover_position",set_hvac_mode:"services.set_hvac_mode",set_preset_mode:"services.set_preset_mode",set_value:"services.set_value",select_option:"services.select_option",select_source:"services.select_source",start:"services.start"},xr={camera:"domains.camera",climate:"domains.climate",cover:"domains.cover",fan:"domains.fan",group:"domains.group",input_boolean:"domains.input_boolean",input_number:"domains.input_number",input_select:"domains.input_select",light:"domains.light",media_player:"domains.media_player",scene:"domains.scene",switch:"domains.switch",vacuum:"domains.vacuum"};function $r(e,t,r={}){let a=Array.isArray(e)?[...e]:Object.assign({},e);return null===e&&(a=Array.isArray(t)?[]:{}),null==t?e:(Object.keys(t).forEach(e=>{let i=t[e];if(void 0!==i)if(null===i&&r.compact)void 0!==a[e]&&delete a[e];else if(Array.isArray(i)&&Array.isArray(a[e])&&!r.overwrite?i=$r(a[e],i,r):"object"!=typeof i||null===i||"object"!=typeof a[e]||r.overwrite||(i=$r(a[e],i,r)),Array.isArray(t))null!==i&&(r.overwrite?a=i:a.push(i));else{if((Array.isArray(i)||"object"==typeof i)&&null!==i&&!Object.keys(i).length&&r.compact)return void delete a[e];Object.assign(a,{[e]:i})}}),a)}function jr(e,t){return e?Object.entries(e).filter(([e])=>t.includes(e)).reduce((e,[t,r])=>Object.assign(e,{[t]:r}),{}):{}}function kr(e,t){return e?Object.entries(e).filter(([e])=>!t.includes(e)).reduce((e,[t,r])=>Object.assign(e,{[t]:r}),{}):{}}function Or(e,t){return Object.entries(e).map(([e,r])=>[e,t(r,e)]).filter(([,e])=>null!=e).reduce((e,[t,r])=>Object.assign(e,{[t]:r}),{})}function Cr(e,t){return Object.entries(e).filter(([e,r])=>t(r,e)).reduce((e,[t,r])=>Object.assign(e,{[t]:r}),{})}function Ar(e,t){return e.reduce((e,r)=>Object.assign(e,{[t(r)]:r}),{})}function Fr(e){if(-1===e.indexOf("."))return"";return String(e.split(".").shift())}function Dr(e){if(-1===e.indexOf("."))return e;return String(e.split(".").pop())}function Rr(e){if(e.type==oe.Daily)return Pr("fields.day_type_daily");if(e.type==oe.Weekdays)return`${Pr("words.on")} ${Pr("fields.day_type_weekdays")}`;{let r=e.custom_days||[],a=Array();r.includes(1)&&a.push(Pr("days_long.mon")),r.includes(2)&&a.push(Pr("days_long.tue")),r.includes(3)&&a.push(Pr("days_long.wed")),r.includes(4)&&a.push(Pr("days_long.thu")),r.includes(5)&&a.push(Pr("days_long.fri")),r.includes(6)&&a.push(Pr("days_long.sat")),r.includes(7)&&a.push(Pr("days_long.sun"));let i=a.join(", ");var t=i.lastIndexOf(", ");return t&&(i=i.slice(0,t)+i.slice(t).replace(", ",` ${Pr("words.and")} `)),`${Pr("words.every")} ${i}`}}function zr(e,t){let r=!!t.amPm&&t.amPm;if(!e.event)return`${Pr("words.at")} ${le(e.value,{amPm:r}).time}`;let a="unknown",i="";if(e.event===se.Sunrise&&null!==t.sunrise){a=le(ce(Number(t.sunrise)+e.value),{amPm:r}).time,i="sunrise"}else if(e.event==se.Sunset&&null!==t.sunset){a=le(ce(Number(t.sunset)+e.value),{amPm:r}).time,i="sunset"}return 0==Math.abs(e.value)?`${Pr("words.at")} ${Pr("words."+e.event)} (${a})`:`${le(e.value,{absolute:!0}).time} ${le(e.value).signed?Pr("words.before"):Pr("words.after")} ${Pr("words."+i)} (${a})`}function Ir(e){return"string"!=typeof e&&(e=String(e)),Vr(e.replace(/_/g," "))}function Nr(e){return"string"!=typeof e&&(e=String(e)),e.match(/^[a-z]+:[a-z0-9-]+$/i)?e:"hass:"+e}function Tr(e,t,r){let a=Ir(t.name);if(e.hasOwnProperty("variable")&&e.variable&&t.variable){let i=Lr(e.variable,t.variable,r);a=`${Pr("services.set_to")} ${i}`}return Vr(a)}function Lr(e,t,r){if(e.type==ie.Level){let a="unit"in(t=t)?t.unit:"";a.length||"temperature"!=t.field||(a=r.temperature_unit);let i=Number(e.value);return"%"==t.unit&&(i=Math.round((i-t.min)/(t.max-t.min)*100),i<t.min?i=t.min:i>t.max&&(i=t.max)),`${i}${a}`}return String(e.value)}function Vr(e){return e.charAt(0).toUpperCase()+e.slice(1)}function qr(e,t){if(Array.isArray(e)&&Array.isArray(t)){let a=[...e].sort(),i=[...t].sort();if(a.length!=a.length)return!1;for(var r=0;r<a.length;r++)if(a[r]!==i[r])return!1;return!0}if("object"==typeof e&&"object"==typeof t){let r=Object.assign({},e),a=Object.assign({},t);const i=Object.keys(r),s=Object.keys(a);if(i.length!==s.length)return!1;for(const e of i){const t=r[e],i=a[e],s="object"==typeof t&&"object"==typeof i&&null!==t&&null!==i;if(s&&!qr(t,i)||!s&&t!==i)return!1}return!0}return!1}var Ur={camera:{icon:"camera"},climate:{icon:"home-thermometer-outline",actions:[{service:"turn_off",icon:"thermometer-off"},{service:"set_temperature",icon:"thermometer",supported_feature:1,variable:{field:"temperature",min:"attribute:min_temp",max:"attribute:max_temp",step:.5}},{service:"set_hvac_mode",variable:{field:"mode",options:[{value:"attribute:hvac_modes:auto",icon:"autorenew"},{value:"attribute:hvac_modes:off",icon:"power"},{value:"attribute:hvac_modes:cool",icon:"snowflake"},{value:"attribute:hvac_modes:heat",icon:"fire"},{value:"attribute:hvac_modes:dry",icon:"water-percent"},{value:"attribute:hvac_modes:fan_only",icon:"fan"}]}},{service:"set_preset_mode",supported_feature:16,variable:{field:"preset",options:[{value:"attribute:preset_modes:none",icon:"account-outline"},{value:"attribute:preset_modes:eco",icon:"leaf"},{value:"attribute:preset_modes:away",icon:"car-traction-control"},{value:"attribute:preset_modes:boost",icon:"rocket-launch-outline"},{value:"attribute:preset_modes:comfort",icon:"car-seat-cooler"},{value:"attribute:preset_modes:home",icon:"home-outline"},{value:"attribute:preset_modes:sleep",icon:"sleep"},{value:"attribute:preset_modes:activity",icon:"motion-sensor"}]}}]},cover:{icon:"window-shutter",actions:[{service:"open_cover",icon:"window-shutter-open"},{service:"close_cover",icon:"window-shutter"},{service:"set_cover_position",icon:"window-shutter",supported_feature:4,variable:{field:"position",unit:"%",min:0,max:100}}]},fan:{icon:"fan",actions:[{service:"turn_on",icon:"fan"},{service:"turn_off",icon:"fan-off"},{service:"set_speed",supported_feature:1,variable:{field:"speed",options:"attribute:speed_list"}},{service:"oscillate",icon:"arrow-left-right",supported_feature:2,variable:{field:"oscillating",options:[{value:"True"},{value:"False"}]}},{service:"set_direction",icon:"autorenew",supported_feature:4,variable:{field:"direction",options:[{value:"forward",icon:"rotate-right"},{value:"reverse",icon:"rotate-left"}]}}]},humidifier:{icon:"humidity",actions:[{service:"set_humidity",variable:{field:"humidity",min:"attribute:min_humidity",max:"attribute:max_humidity",step:1}},{service:"set_mode",supported_feature:1,variable:{field:"mode",options:[{value:"attribute:available_modes:normal",icon:"account-outline"},{value:"attribute:available_modes:eco",icon:"leaf"},{value:"attribute:available_modes:away",icon:"car-traction-control"},{value:"attribute:available_modes:boost",icon:"rocket-launch-outline"},{value:"attribute:available_modes:comfort",icon:"car-seat-cooler"},{value:"attribute:available_modes:home",icon:"home-outline"},{value:"attribute:available_modes:sleep",icon:"sleep"},{value:"attribute:available_modes:auto",icon:"autorenew"},{value:"attribute:available_modes:baby",icon:"baby-bottle-outline"}]}}]},group:{icon:"expand-all-outline"},input_boolean:{icon:"flash",actions:[{service:"turn_on",icon:"toggle-switch-outline"},{service:"turn_off",icon:"toggle-switch-off-outline"}]},input_number:{icon:"sort-numeric-variant",actions:[{service:"set_value",icon:"counter",variable:{field:"value",min:"attribute:min",max:"attribute:max",step:"attribute:step"}}]},input_select:{icon:"form-select",actions:[{service:"select_option",icon:"counter",variable:{field:"option",options:"attribute:options"}}]},light:{icon:"lightbulb-outline",actions:[{service:"turn_on",icon:"lightbulb-on-outline",variable:{field:"brightness",unit:"%",supported_feature:1}},{service:"turn_off",icon:"lightbulb-off-outline"}]},media_player:{icon:"speaker",actions:[{service:"turn_on",icon:"power",supported_feature:128},{service:"turn_off",icon:"power-off",supported_feature:256},{service:"select_source",icon:"music-box-multiple-outline",supported_feature:2048,variable:{field:"source",options:"attribute:source_list"}}]},scene:{icon:"lightbulb-group-outline",actions:[{service:"turn_on",icon:"play"}]},script:{icon:"script-text",actions:[{service:"turn_on",icon:"power"},{service:"turn_off",icon:"power-off"},{service:"attribute:entity_id",icon:"play",name:"run"}]},switch:{icon:"flash",actions:[{service:"turn_on",icon:"toggle-switch-outline"},{service:"turn_off",icon:"toggle-switch-off-outline"}]},vacuum:{icon:"robot-vacuum",actions:[{service:"turn_on",icon:"power",supported_feature:1},{service:"start",icon:"play-circle-outline",supported_feature:8192},{service:"start_pause",icon:"play-circle-outline",supported_feature:4}]}};function Mr(e){let t={id:"",name:e.service in Er?Pr(Er[e.service]):Dr(e.service),icon:"flash",service:"",routine:!1};return t=$r(t,e),t=$r(t,{id:Br(t)}),t}function Qr(e,t){let r=Object.assign({},e),a=Fr(t.entity_id);return Fr(r.service)==a&&(r=$r(r,{service:Dr(r.service)})),r=Or(r,e=>Hr(e,t)),r=function(e,t){var r;if(e.supported_feature&&0==(t&e.supported_feature))return null;(null===(r=e.variable)||void 0===r?void 0:r.supported_feature)&&0==(t&e.variable.supported_feature)&&(e=$r(e,{variable:null},{compact:!0}));return e}(r,t.attributes.supported_features),(null==r?void 0:r.variable)&&(r=function(e,t){let r=Object.assign({},e),a=e.variable;a.name||(a=$r(a,{name:a.field}));if(a=Or(a,e=>Hr(e,t)),"options"in a){let e=[...a.options];e=e.map(e=>"object"!=typeof e?{value:e}:$r(e,{value:Hr(e.value,t)})).filter(e=>e.value),a=$r(a,{options:e},{overwrite:!0});let i=$r(_e,a);r=$r(r,{variable:i},{overwrite:!0})}else{let e=$r(ge,a);r=$r(r,{variable:e})}return r}(r,t)),r}function Hr(e,t){if("string"!=typeof e)return e;let r=String(e).match(/^attribute:(\w+):?(\w+)?$/);return null===r?e:"entity_id"==r[1]?t.entity_id:r[1]in t.attributes?void 0!==r[2]?Array.isArray(t.attributes[r[1]])&&t.attributes[r[1]].includes(r[2])?r[2]:null:t.attributes[r[1]]:null}function Gr(e){let t=e.entity,r=e.service;Fr(t)&&Fr(r)?r=Dr(r):!Fr(t)&&Fr(r)&&(t=Fr(r)+"."+t,r=Dr(r));let a=kr(e,["service","entity","service_data"]),i=$r({},{entity:t,service:r,service_data:Object.keys(a).length?a:null},{compact:!0});return i=$r(i,jr(e,["service_data"])),i}function Kr(e,t){let r=Gr(e),a=t.find(e=>{let t=Br(e);return e.service==r.service&&(t==Br(r)||!!(e.variable&&r.service_data&&Object.keys(r.service_data).includes(e.variable.field))&&t==Br($r(r,{service_data:{[e.variable.field]:null}},{compact:!0})))});return a||null}function Br(e){let t=e=>Object.entries(e).sort((e,t)=>e[0]>t[0]?1:-1).map(([e,r])=>[e,"object"==typeof r&&null!==r?t(r):r]).reduce((e,[t,r])=>Object.assign(e,{[t]:r}),{}),r=jr(e,["service","service_data"]);return r=t(r),Object.values(r).map(e=>JSON.stringify(e).replace(/[\W]/g," ").split(" ").filter(e=>" "!=e&&""!=e).join("_")).join("_")}function Jr(e){return e.match(/^switch.schedule_[0-9a-f]{6}$/)}class Wr{constructor(){this.domainConfig={},this.entityConfig={},this.entities=[],this.standard_configuration=!0}SetConfig(e){this.domainConfig=e.domains,this.entityConfig=e.entities,this.standard_configuration=e.standard_configuration}InDomainCfg(e){let t=Fr(e);if(!(t in this.domainConfig))return!1;let r=this.domainConfig[t];return!("boolean"==typeof r&&!r)&&(!((null==r?void 0:r.include)&&!r.include.includes(e))&&(!(null==r?void 0:r.exclude)||!r.exclude.includes(e)))}InEntityCfg(e){return e in this.entityConfig}InConfig(e){return!Jr(e)&&(this.InDomainCfg(e)||this.InEntityCfg(e))}Find(e){return this.entities.find(t=>t.id==e)}Get(e=[]){let t=[];if(e&&e.length){(Array.isArray(e)?e:[e]).filter(e=>void 0!==this.Find(e)).forEach(e=>t.push(Object.assign({},this.entities[e])))}else t=[...this.entities];return t.sort((e,t)=>e.name>t.name?1:-1),t}Add(e,t){if(this.Find(e))return;let r={id:e,name:Dr(e),icon:"folder-outline",actions:[]};r=$r(r,kr(t,["actions"])),this.entities.push(r)}Set(e,t){if(!this.Find(e))throw`Entity '${e}' does not exist`;for(var r=0;r<this.entities.length;r++)if(this.entities[r].id==e){let e=this.entities[r];return Object.assign(e,t),void(this.entities[r]=e)}}GetConfig(e){var t;let r=e.entity_id,a=Fr(r),i={actions:[]},s={},o=[];if(Ur[a]&&this.standard_configuration&&(i=$r(i,kr(Ur[a],["actions"])),(null===(t=Ur[a])||void 0===t?void 0:t.actions)&&(s=$r(s,Ar(Ur[a].actions,Br)))),i=$r(i,{name:e.attributes.friendly_name,icon:e.attributes.icon}),this.InDomainCfg(r)&&(i=$r(i,kr(this.domainConfig[a],["actions"])),this.domainConfig[a]&&this.domainConfig[a].actions)){let e=Ar(this.domainConfig[a].actions,Br);s=$r(s,e),o=o.concat(Object.keys(e))}if(this.InEntityCfg(r)&&(i=$r(i,kr(this.entityConfig[r],["actions"])),this.entityConfig[r]&&this.entityConfig[r].actions)){let e=Ar(this.entityConfig[r].actions,Br);s=$r(s,e),o=o.concat(Object.keys(e))}return o.length&&(s=Cr(s,(e,t)=>o.includes(t))),i=$r(i,{actions:Object.values(s)}),i}AddAction(e,t){let r=this.Find(e);if(!r)throw Error(`Entity '${e}' must be created before actions can be assigned`);if(r.actions.find(e=>e.id==t.id))return;let a=[...r.actions];a.push(t),this.Set(e,{actions:a})}}class Zr{constructor(){this.groupConfig={},this.groups=[],this.standard_configuration=!0}SetConfig(e){this.groupConfig=e.groups,this.standard_configuration=e.standard_configuration}Find(e){return this.groups.find(t=>t.id==e)}Get(){let e=[...this.groups].filter(e=>"discovered"!=e.id);return e.sort((e,t)=>e.name>t.name?1:-1),this.Find("discovered")&&e.push(Object.assign({},this.Find("discovered"))),e}Add(e,t){if(this.Find(e))return;let r={id:e,name:e in xr?Pr(xr[e]):e,icon:"folder-outline",domains:[],entities:[]};r=$r(r,t),this.groups.push(r)}Set(e,t){if(!this.Find(e))throw`Group '${e}' does not exist`;for(var r=0;r<this.groups.length;r++)if(this.groups[r].id==e){let e=this.groups[r];return Object.assign(e,t),void(this.groups[r]=e)}}InGroup(e,t){let r=this.Find(e),a=Fr(t);return!!r&&(r.entities.includes(t)||r.domains.includes(a))}InConfig(e){return void 0!==this.groups.find(t=>this.InGroup(t.id,e))}CreateGroups(e){Object.entries(this.groupConfig).forEach(([e,t])=>this.Add(e,t)),e.forEach(e=>{var t;if(this.InConfig(e))return;let r=Fr(e),a=this.Find(r);if(a){let t=[...a.entities];t.push(e),this.Set(r,{entities:t})}else{let a={entities:[e]};(null===(t=Ur[r])||void 0===t?void 0:t.icon)&&this.standard_configuration&&Object.assign(a,{icon:Ur[r].icon}),this.Add(r,a)}})}}class Yr{constructor(){this.discover_existing=!0,this.standard_configuration=!0,this.entities=new Wr,this.groups=new Zr}setUserConfig(e){void 0!==e.discover_existing&&(this.discover_existing=e.discover_existing),void 0!==e.standard_configuration&&(this.standard_configuration=e.standard_configuration);let t=e.entities||{},r=this.standard_configuration?fe:{},a=e.groups||{};Object.assign(r,e.domains),this.entities.SetConfig({entities:t,domains:r,standard_configuration:this.standard_configuration}),this.groups.SetConfig({groups:a,standard_configuration:this.standard_configuration})}GetGroups(){return this.groups.Get()}GetEntitiesForGroup(e){return this.groups.Find(e)?this.entities.Get().filter(t=>this.groups.InGroup(e,t.id)):[]}FindEntity(e){if(!e)return null;let t=this.entities.Find(e);return t||null}FindAction(e,t){if(!e||!t)return null;let r=this.entities.Find(e);return r?r.actions.find(e=>e.id==t):null}GetActionsForEntity(e){if(!e)return[];let t=this.entities.Find(e);if(!t)return[];let r=[...t.actions];return r.sort((e,t)=>e.name>t.name?1:-1),r}GetEntityConfig(e){return this.entities.GetConfig(e)}LoadEntities(e){if(Object.entries(e).forEach(([e,t])=>{if(!this.entities.InConfig(e))return;let r=this.GetEntityConfig(t);if(this.entities.Add(e,r),r.actions){r.actions.map(e=>Qr(e,t)).filter(e=>e).map(Mr).forEach(t=>this.entities.AddAction(e,t))}}),this.groups.CreateGroups(this.entities.Get().map(e=>e.id)),!this.discover_existing)return;let t=[];if(Object.entries(e).filter(([e])=>Jr(e)).forEach(([r,a])=>{let i=a.attributes.actions;i&&i.forEach(r=>{let a=(Fr(r.entity)||Fr(r.service))+"."+r.entity.split(".").pop();if(!(a in e))return;let i=e[a],s=this.GetEntityConfig(i);this.entities.Find(a)||(this.entities.Add(a,s),t.push(a));let o=s.actions?Kr(r,s.actions):null;o||(o=jr(Gr(r),["service","service_data"]));let n=Mr(o);this.entities.AddAction(a,n)})}),t.length){let e={entities:t,icon:"reload-alert"};this.groups.Add("discovered",e)}}}const Xr=te`
      /* list view */

      div.list-item {
        display: grid;
        grid-template-columns: min-content 1fr min-content;
        grid-template-rows: min-content min-content min-content min-content;
        grid-template-areas: "icon name switch"
                             "icon action switch"
                             "icon days switch"
                             "icon time switch";
        grid-gap: 2px 20px;
        background: none;
        cursor: pointer;
        padding: 10px 20px;
        position: relative;
        z-index: 1;
      }

      div.list-item:before  {
        content: " ";
        background: var(--list-item-background-color);
        opacity: 0.1;
        position: absolute;
        left: 0px;
        top: 0px;
        width: 100%;
        height: 100%;
        z-index: -1;
       }

      div.list-item:hover:before {
          background: var(--primary-color);
          border-radius: 4px;
      }

      div.list-item-icon {
        grid-area: icon;
        color: var(--state-icon-color);
      }

      div.list-item-icon ha-icon {
        width: 24px;
        height: 24px;
      }

      div.list-item-icon.enabled {
        color: var(--state-icon-active-color);
      }

      div.list-item-switch {
        grid-area: switch;
      }

      div.list-item-switch ha-switch {
        margin-top: 3px;
      }

      div.list-item-name {
        grid-area: name;
        font-weight: 500;
        color: var(--primary-text-color);
      }

      div.list-item-action {
        grid-area: action;
        color: var(--secondary-text-color);
      }

      div.list-item-days {
        grid-area: days;
        color: var(--secondary-text-color);
      }

      div.list-item-time {
        grid-area: time;
        color: var(--secondary-text-color);
      }

      div.disabled div.list-item-icon, div.disabled div.list-item-name, div.disabled div.list-item-action, div.disabled div.list-item-days, div.disabled div.list-item-time {
        color: var(--disabled-text-color);
      }

      /* add/edit view */
   
      div.header {
        color: var(--secondary-text-color);
        text-transform: uppercase;
        font-size: 12px;
        font-weight: 500;
        margin: 0px 0px 0px 0px;
      }

      div.card-section {
        padding: 10px 10px;
      }

      div.card-section.first {
        padding-top: 0px;
      }
      
      div.card-section.last {
        padding-bottom: 10px;
      }

      div.text-field {
        color: var(--disabled-text-color);
      }

      div.summary {
        display: grid;
        grid-template-columns: 1fr max-content 1fr;
        grid-template-areas: "entity arrow action";
        grid-auto-flow: column;
        grid-gap: 5px;
      }

      div.summary-entity { grid-area: entity; }
      div.summary-action { grid-area: action; }
      div.summary-text { grid-area: text; }
      div.summary-icon { grid-area: icon; }
      div.summary-arrow {
        grid-area: arrow;
        color: var(--secondary-text-color);
        display: flex;
        justify-content:center;
        align-items:center;
      }

      div.summary-entity, div.summary-action {
        color: var(--dark-primary-color);
        padding: 10px;
        font-size: 14px;
        font-weight: 500;
        --mdc-icon-size: 20px;
        position: relative;
        display: flex;
        justify-content:center;
        align-items:center;
        display: grid;
        grid-template-columns: min-content 1fr;
        grid-template-areas: "icon text";
        grid-auto-flow: column;
        grid-gap: 10px;
      }

       div.summary-entity:before, div.summary-action:before  {
        content: " ";
        background: var(--primary-color);
        opacity: 0.15;
        border-radius: 4px;
        position: absolute;
        left: 0px;
        top: 0px;
        width: 100%;
        height: 100%;
        z-index: 1;
       }

       div.summary-text::first-letter {
        text-transform: uppercase;
       }

      div#day-list-custom.closed {
        display: none;
      }
      
      div#day-list-custom {
        overflow: hidden;
        max-height: 100px; /* approximate max height */
        transition-property: all;
        transition-duration: 1s;
        transition-timing-function: cubic-bezier(0, 1, 0.5, 1);
      }

      mwc-button {
        margin: 2px 0px;
      }

      mwc-button.active {
        background: var(--primary-color);
        --mdc-theme-primary: var(--text-primary-color);
        border-radius: 4px;
      }
      
      div.option-item {
        padding: 2px 5px;
        display: flex;
        align-items: center;
      }
      
      .padded-right {
        margin-right: 11px;
      }
`;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function ea(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}var ta=ea((function(e,t){
/** @license URI.js v4.4.0 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */
!function(e){function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1){t[0]=t[0].slice(0,-1);for(var a=t.length-1,i=1;i<a;++i)t[i]=t[i].slice(1,-1);return t[a]=t[a].slice(1),t.join("")}return t[0]}function r(e){return"(?:"+e+")"}function a(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function i(e){return e.toUpperCase()}function s(e){var a=t("[0-9]","[A-Fa-f]"),i=r(r("%[EFef]"+a+"%"+a+a+"%"+a+a)+"|"+r("%[89A-Fa-f]"+a+"%"+a+a)+"|"+r("%"+a+a)),s="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",o=t("[\\:\\/\\?\\#\\[\\]\\@]",s),n=e?"[\\uE000-\\uF8FF]":"[]",l=t("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),c=(r("[A-Za-z]"+t("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),r(r(i+"|"+t(l,s,"[\\:]"))+"*"),r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("0?[1-9][0-9]")+"|0?0?[0-9]")),d=r(c+"\\."+c+"\\."+c+"\\."+c),u=r(a+"{1,4}"),h=r(r(u+"\\:"+u)+"|"+d),p=r(r(u+"\\:")+"{6}"+h),m=r("\\:\\:"+r(u+"\\:")+"{5}"+h),f=r(r(u)+"?\\:\\:"+r(u+"\\:")+"{4}"+h),v=r(r(r(u+"\\:")+"{0,1}"+u)+"?\\:\\:"+r(u+"\\:")+"{3}"+h),y=r(r(r(u+"\\:")+"{0,2}"+u)+"?\\:\\:"+r(u+"\\:")+"{2}"+h),g=r(r(r(u+"\\:")+"{0,3}"+u)+"?\\:\\:"+u+"\\:"+h),_=r(r(r(u+"\\:")+"{0,4}"+u)+"?\\:\\:"+h),b=r(r(r(u+"\\:")+"{0,5}"+u)+"?\\:\\:"+u),w=r(r(r(u+"\\:")+"{0,6}"+u)+"?\\:\\:"),P=r([p,m,f,v,y,g,_,b,w].join("|")),S=r(r(l+"|"+i)+"+"),E=(r("[vV]"+a+"+\\."+t(l,s,"[\\:]")+"+"),r(r(i+"|"+t(l,s))+"*"),r(i+"|"+t(l,s,"[\\:\\@]")));return r(r(i+"|"+t(l,s,"[\\@]"))+"+"),r(r(E+"|"+t("[\\/\\?]",n))+"*"),{NOT_SCHEME:new RegExp(t("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",l,s),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",l,s),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",l,s),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",l,s),"g"),NOT_QUERY:new RegExp(t("[^\\%]",l,s,"[\\:\\@\\/\\?]",n),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",l,s,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",l,s),"g"),UNRESERVED:new RegExp(l,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",l,o),"g"),PCT_ENCODED:new RegExp(i,"g"),IPV4ADDRESS:new RegExp("^("+d+")$"),IPV6ADDRESS:new RegExp("^\\[?("+P+")"+r(r("\\%25|\\%(?!"+a+"{2})")+"("+S+")")+"?\\]?$")}}var o=s(!1),n=s(!0),l=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],a=!0,i=!1,s=void 0;try{for(var o,n=e[Symbol.iterator]();!(a=(o=n.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){i=!0,s=e}finally{try{!a&&n.return&&n.return()}finally{if(i)throw s}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},c=2147483647,d=/^xn--/,u=/[^\0-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=Math.floor,f=String.fromCharCode;function v(e){throw new RangeError(p[e])}function y(e,t){var r=e.split("@"),a="";r.length>1&&(a=r[0]+"@",e=r[1]);var i=function(e,t){for(var r=[],a=e.length;a--;)r[a]=t(e[a]);return r}((e=e.replace(h,".")).split("."),t).join(".");return a+i}function g(e){for(var t=[],r=0,a=e.length;r<a;){var i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<a){var s=e.charCodeAt(r++);56320==(64512&s)?t.push(((1023&i)<<10)+(1023&s)+65536):(t.push(i),r--)}else t.push(i)}return t}var _=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},b=function(e,t,r){var a=0;for(e=r?m(e/700):e>>1,e+=m(e/t);e>455;a+=36)e=m(e/35);return m(a+36*e/(e+38))},w=function(e){var t,r=[],a=e.length,i=0,s=128,o=72,n=e.lastIndexOf("-");n<0&&(n=0);for(var l=0;l<n;++l)e.charCodeAt(l)>=128&&v("not-basic"),r.push(e.charCodeAt(l));for(var d=n>0?n+1:0;d<a;){for(var u=i,h=1,p=36;;p+=36){d>=a&&v("invalid-input");var f=(t=e.charCodeAt(d++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:36;(f>=36||f>m((c-i)/h))&&v("overflow"),i+=f*h;var y=p<=o?1:p>=o+26?26:p-o;if(f<y)break;var g=36-y;h>m(c/g)&&v("overflow"),h*=g}var _=r.length+1;o=b(i-u,_,0==u),m(i/_)>c-s&&v("overflow"),s+=m(i/_),i%=_,r.splice(i++,0,s)}return String.fromCodePoint.apply(String,r)},P=function(e){var t=[],r=(e=g(e)).length,a=128,i=0,s=72,o=!0,n=!1,l=void 0;try{for(var d,u=e[Symbol.iterator]();!(o=(d=u.next()).done);o=!0){var h=d.value;h<128&&t.push(f(h))}}catch(e){n=!0,l=e}finally{try{!o&&u.return&&u.return()}finally{if(n)throw l}}var p=t.length,y=p;for(p&&t.push("-");y<r;){var w=c,P=!0,S=!1,E=void 0;try{for(var x,$=e[Symbol.iterator]();!(P=(x=$.next()).done);P=!0){var j=x.value;j>=a&&j<w&&(w=j)}}catch(e){S=!0,E=e}finally{try{!P&&$.return&&$.return()}finally{if(S)throw E}}var k=y+1;w-a>m((c-i)/k)&&v("overflow"),i+=(w-a)*k,a=w;var O=!0,C=!1,A=void 0;try{for(var F,D=e[Symbol.iterator]();!(O=(F=D.next()).done);O=!0){var R=F.value;if(R<a&&++i>c&&v("overflow"),R==a){for(var z=i,I=36;;I+=36){var N=I<=s?1:I>=s+26?26:I-s;if(z<N)break;var T=z-N,L=36-N;t.push(f(_(N+T%L,0))),z=m(T/L)}t.push(f(_(z,0))),s=b(i,k,y==p),i=0,++y}}}catch(e){C=!0,A=e}finally{try{!O&&D.return&&D.return()}finally{if(C)throw A}}++i,++a}return t.join("")},S=function(e){return y(e,(function(e){return u.test(e)?"xn--"+P(e):e}))},E=function(e){return y(e,(function(e){return d.test(e)?w(e.slice(4).toLowerCase()):e}))},x={};function $(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function j(e){for(var t="",r=0,a=e.length;r<a;){var i=parseInt(e.substr(r+1,2),16);if(i<128)t+=String.fromCharCode(i),r+=3;else if(i>=194&&i<224){if(a-r>=6){var s=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&i)<<6|63&s)}else t+=e.substr(r,6);r+=6}else if(i>=224){if(a-r>=9){var o=parseInt(e.substr(r+4,2),16),n=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&i)<<12|(63&o)<<6|63&n)}else t+=e.substr(r,9);r+=9}else t+=e.substr(r,3),r+=3}return t}function k(e,t){function r(e){var r=j(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,$).replace(t.PCT_ENCODED,i)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,$).replace(t.PCT_ENCODED,i)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,$).replace(t.PCT_ENCODED,i)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,$).replace(t.PCT_ENCODED,i)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,$).replace(t.PCT_ENCODED,i)),e}function O(e){return e.replace(/^0*(.*)/,"$1")||"0"}function C(e,t){var r=e.match(t.IPV4ADDRESS)||[],a=l(r,2)[1];return a?a.split(".").map(O).join("."):e}function A(e,t){var r=e.match(t.IPV6ADDRESS)||[],a=l(r,3),i=a[1],s=a[2];if(i){for(var o=i.toLowerCase().split("::").reverse(),n=l(o,2),c=n[0],d=n[1],u=d?d.split(":").map(O):[],h=c.split(":").map(O),p=t.IPV4ADDRESS.test(h[h.length-1]),m=p?7:8,f=h.length-m,v=Array(m),y=0;y<m;++y)v[y]=u[y]||h[f+y]||"";p&&(v[m-1]=C(v[m-1],t));var g=v.reduce((function(e,t,r){if(!t||"0"===t){var a=e[e.length-1];a&&a.index+a.length===r?a.length++:e.push({index:r,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],_=void 0;if(g&&g.length>1){var b=v.slice(0,g.index),w=v.slice(g.index+g.length);_=b.join(":")+"::"+w.join(":")}else _=v.join(":");return s&&(_+="%"+s),_}return e}var F=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,D=void 0==="".match(/(){0}/)[1];function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},a=!1!==t.iri?n:o;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var i=e.match(F);if(i){D?(r.scheme=i[1],r.userinfo=i[3],r.host=i[4],r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=i[7],r.fragment=i[8],isNaN(r.port)&&(r.port=i[5])):(r.scheme=i[1]||void 0,r.userinfo=-1!==e.indexOf("@")?i[3]:void 0,r.host=-1!==e.indexOf("//")?i[4]:void 0,r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=-1!==e.indexOf("?")?i[7]:void 0,r.fragment=-1!==e.indexOf("#")?i[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?i[4]:void 0)),r.host&&(r.host=A(C(r.host,a),a)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var s=x[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||s&&s.unicodeSupport)k(r,a);else{if(r.host&&(t.domainHost||s&&s.domainHost))try{r.host=S(r.host.replace(a.PCT_ENCODED,j).toLowerCase())}catch(e){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+e}k(r,o)}s&&s.parse&&s.parse(r,t)}else r.error=r.error||"URI can not be parsed.";return r}function z(e,t){var r=!1!==t.iri?n:o,a=[];return void 0!==e.userinfo&&(a.push(e.userinfo),a.push("@")),void 0!==e.host&&a.push(A(C(String(e.host),r),r).replace(r.IPV6ADDRESS,(function(e,t,r){return"["+t+(r?"%25"+r:"")+"]"}))),"number"!=typeof e.port&&"string"!=typeof e.port||(a.push(":"),a.push(String(e.port))),a.length?a.join(""):void 0}var I=/^\.\.?\//,N=/^\/\.(\/|$)/,T=/^\/\.\.(\/|$)/,L=/^\/?(?:.|\n)*?(?=\/|$)/;function V(e){for(var t=[];e.length;)if(e.match(I))e=e.replace(I,"");else if(e.match(N))e=e.replace(N,"/");else if(e.match(T))e=e.replace(T,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match(L);if(!r)throw new Error("Unexpected dot segment condition");var a=r[0];e=e.slice(a.length),t.push(a)}return t.join("")}function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?n:o,a=[],i=x[(t.scheme||e.scheme||"").toLowerCase()];if(i&&i.serialize&&i.serialize(e,t),e.host)if(r.IPV6ADDRESS.test(e.host));else if(t.domainHost||i&&i.domainHost)try{e.host=t.iri?E(e.host):S(e.host.replace(r.PCT_ENCODED,j).toLowerCase())}catch(r){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+r}k(e,r),"suffix"!==t.reference&&e.scheme&&(a.push(e.scheme),a.push(":"));var s=z(e,t);if(void 0!==s&&("suffix"!==t.reference&&a.push("//"),a.push(s),e.path&&"/"!==e.path.charAt(0)&&a.push("/")),void 0!==e.path){var l=e.path;t.absolutePath||i&&i.absolutePath||(l=V(l)),void 0===s&&(l=l.replace(/^\/\//,"/%2F")),a.push(l)}return void 0!==e.query&&(a.push("?"),a.push(e.query)),void 0!==e.fragment&&(a.push("#"),a.push(e.fragment)),a.join("")}function U(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments[3],i={};return a||(e=R(q(e,r),r),t=R(q(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(i.scheme=t.scheme,i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=V(t.path||""),i.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=V(t.path||""),i.query=t.query):(t.path?("/"===t.path.charAt(0)?i.path=V(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?i.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:i.path=t.path:i.path="/"+t.path,i.path=V(i.path)),i.query=t.query):(i.path=e.path,void 0!==t.query?i.query=t.query:i.query=e.query),i.userinfo=e.userinfo,i.host=e.host,i.port=e.port),i.scheme=e.scheme),i.fragment=t.fragment,i}function M(e,t){return e&&e.toString().replace(t&&t.iri?n.PCT_ENCODED:o.PCT_ENCODED,j)}var Q={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var r="https"===String(e.scheme).toLowerCase();return e.port!==(r?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},H={scheme:"https",domainHost:Q.domainHost,parse:Q.parse,serialize:Q.serialize};function G(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var K={scheme:"ws",domainHost:!0,parse:function(e,t){var r=e;return r.secure=G(r),r.resourceName=(r.path||"/")+(r.query?"?"+r.query:""),r.path=void 0,r.query=void 0,r},serialize:function(e,t){if(e.port!==(G(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var r=e.resourceName.split("?"),a=l(r,2),i=a[0],s=a[1];e.path=i&&"/"!==i?i:void 0,e.query=s,e.resourceName=void 0}return e.fragment=void 0,e}},B={scheme:"wss",domainHost:K.domainHost,parse:K.parse,serialize:K.serialize},J={},W="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Z="[0-9A-Fa-f]",Y=r(r("%[EFef]"+Z+"%"+Z+Z+"%"+Z+Z)+"|"+r("%[89A-Fa-f]"+Z+"%"+Z+Z)+"|"+r("%"+Z+Z)),X=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),ee=new RegExp(W,"g"),te=new RegExp(Y,"g"),re=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',X),"g"),ae=new RegExp(t("[^]",W,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),ie=ae;function se(e){var t=j(e);return t.match(ee)?t:e}var oe={scheme:"mailto",parse:function(e,t){var r=e,a=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var i=!1,s={},o=r.query.split("&"),n=0,l=o.length;n<l;++n){var c=o[n].split("=");switch(c[0]){case"to":for(var d=c[1].split(","),u=0,h=d.length;u<h;++u)a.push(d[u]);break;case"subject":r.subject=M(c[1],t);break;case"body":r.body=M(c[1],t);break;default:i=!0,s[M(c[0],t)]=M(c[1],t)}}i&&(r.headers=s)}r.query=void 0;for(var p=0,m=a.length;p<m;++p){var f=a[p].split("@");if(f[0]=M(f[0]),t.unicodeSupport)f[1]=M(f[1],t).toLowerCase();else try{f[1]=S(M(f[1],t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}a[p]=f.join("@")}return r},serialize:function(e,t){var r,a=e,s=null!=(r=e.to)?r instanceof Array?r:"number"!=typeof r.length||r.split||r.setInterval||r.call?[r]:Array.prototype.slice.call(r):[];if(s){for(var o=0,n=s.length;o<n;++o){var l=String(s[o]),c=l.lastIndexOf("@"),d=l.slice(0,c).replace(te,se).replace(te,i).replace(re,$),u=l.slice(c+1);try{u=t.iri?E(u):S(M(u,t).toLowerCase())}catch(e){a.error=a.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}s[o]=d+"@"+u}a.path=s.join(",")}var h=e.headers=e.headers||{};e.subject&&(h.subject=e.subject),e.body&&(h.body=e.body);var p=[];for(var m in h)h[m]!==J[m]&&p.push(m.replace(te,se).replace(te,i).replace(ae,$)+"="+h[m].replace(te,se).replace(te,i).replace(ie,$));return p.length&&(a.query=p.join("&")),a}},ne=/^([^\:]+)\:(.*)/,le={scheme:"urn",parse:function(e,t){var r=e.path&&e.path.match(ne),a=e;if(r){var i=t.scheme||a.scheme||"urn",s=r[1].toLowerCase(),o=r[2],n=i+":"+(t.nid||s),l=x[n];a.nid=s,a.nss=o,a.path=void 0,l&&(a=l.parse(a,t))}else a.error=a.error||"URN can not be parsed.";return a},serialize:function(e,t){var r=t.scheme||e.scheme||"urn",a=e.nid,i=r+":"+(t.nid||a),s=x[i];s&&(e=s.serialize(e,t));var o=e,n=e.nss;return o.path=(a||t.nid)+":"+n,o}},ce=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,de={scheme:"urn:uuid",parse:function(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,t.tolerant||r.uuid&&r.uuid.match(ce)||(r.error=r.error||"UUID is not valid."),r},serialize:function(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r}};x[Q.scheme]=Q,x[H.scheme]=H,x[K.scheme]=K,x[B.scheme]=B,x[oe.scheme]=oe,x[le.scheme]=le,x[de.scheme]=de,e.SCHEMES=x,e.pctEncChar=$,e.pctDecChars=j,e.parse=R,e.removeDotSegments=V,e.serialize=q,e.resolveComponents=U,e.resolve=function(e,t,r){var a=function(e,t){var r=e;if(t)for(var a in t)r[a]=t[a];return r}({scheme:"null"},r);return q(U(R(e,a),R(t,a),a,!0),a)},e.normalize=function(e,t){return"string"==typeof e?e=q(R(e,t),t):"object"===a(e)&&(e=R(q(e,t),t)),e},e.equal=function(e,t,r){return"string"==typeof e?e=q(R(e,r),r):"object"===a(e)&&(e=q(e,r)),"string"==typeof t?t=q(R(t,r),r):"object"===a(t)&&(t=q(t,r)),e===t},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?n.ESCAPE:o.ESCAPE,$)},e.unescapeComponent=M,Object.defineProperty(e,"__esModule",{value:!0})}(t)})),ra=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var a,i,s;if(Array.isArray(t)){if((a=t.length)!=r.length)return!1;for(i=a;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((a=(s=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=a;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,s[i]))return!1;for(i=a;0!=i--;){var o=s[i];if(!e(t[o],r[o]))return!1}return!0}return t!=t&&r!=r},aa={copy:function(e,t){for(var r in t=t||{},e)t[r]=e[r];return t},checkDataType:ia,checkDataTypes:function(e,t,r){switch(e.length){case 1:return ia(e[0],t,r,!0);default:var a="",i=oa(e);for(var s in i.array&&i.object&&(a=i.null?"(":"(!"+t+" || ",a+="typeof "+t+' !== "object")',delete i.null,delete i.array,delete i.object),i.number&&delete i.integer,i)a+=(a?" && ":"")+ia(s,t,r,!0);return a}},coerceToTypes:function(e,t){if(Array.isArray(t)){for(var r=[],a=0;a<t.length;a++){var i=t[a];(sa[i]||"array"===e&&"array"===i)&&(r[r.length]=i)}if(r.length)return r}else{if(sa[t])return[t];if("array"===e&&"array"===t)return["array"]}},toHash:oa,getProperty:ca,escapeQuotes:da,equal:ra,ucs2length:function(e){for(var t,r=0,a=e.length,i=0;i<a;)r++,(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<a&&56320==(64512&(t=e.charCodeAt(i)))&&i++;return r},varOccurences:function(e,t){t+="[^0-9]";var r=e.match(new RegExp(t,"g"));return r?r.length:0},varReplace:function(e,t,r){return t+="([^0-9])",r=r.replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"),r+"$1")},schemaHasRules:function(e,t){if("boolean"==typeof e)return!e;for(var r in e)if(t[r])return!0},schemaHasRulesExcept:function(e,t,r){if("boolean"==typeof e)return!e&&"not"!=r;for(var a in e)if(a!=r&&t[a])return!0},schemaUnknownRules:function(e,t){if("boolean"==typeof e)return;for(var r in e)if(!t[r])return r},toQuotedString:ua,getPathExpr:function(e,t,r,a){return ma(e,r?"'/' + "+t+(a?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):a?"'[' + "+t+" + ']'":"'[\\'' + "+t+" + '\\']'")},getPath:function(e,t,r){var a=ua(r?"/"+fa(t):ca(t));return ma(e,a)},getData:function(e,t,r){var a,i,s,o;if(""===e)return"rootData";if("/"==e[0]){if(!ha.test(e))throw new Error("Invalid JSON-pointer: "+e);i=e,s="rootData"}else{if(!(o=e.match(pa)))throw new Error("Invalid JSON-pointer: "+e);if(a=+o[1],"#"==(i=o[2])){if(a>=t)throw new Error("Cannot access property/index "+a+" levels up, current level is "+t);return r[t-a]}if(a>t)throw new Error("Cannot access data "+a+" levels up, current level is "+t);if(s="data"+(t-a||""),!i)return s}for(var n=s,l=i.split("/"),c=0;c<l.length;c++){var d=l[c];d&&(s+=ca(va(d)),n+=" && "+s)}return n},unescapeFragment:function(e){return va(decodeURIComponent(e))},unescapeJsonPointer:va,escapeFragment:function(e){return encodeURIComponent(fa(e))},escapeJsonPointer:fa};function ia(e,t,r,a){var i=a?" !== ":" === ",s=a?" || ":" && ",o=a?"!":"",n=a?"":"!";switch(e){case"null":return t+i+"null";case"array":return o+"Array.isArray("+t+")";case"object":return"("+o+t+s+"typeof "+t+i+'"object"'+s+n+"Array.isArray("+t+"))";case"integer":return"(typeof "+t+i+'"number"'+s+n+"("+t+" % 1)"+s+t+i+t+(r?s+o+"isFinite("+t+")":"")+")";case"number":return"(typeof "+t+i+'"'+e+'"'+(r?s+o+"isFinite("+t+")":"")+")";default:return"typeof "+t+i+'"'+e+'"'}}var sa=oa(["string","number","integer","boolean","null"]);function oa(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}var na=/^[a-z$_][a-z$_0-9]*$/i,la=/'|\\/g;function ca(e){return"number"==typeof e?"["+e+"]":na.test(e)?"."+e:"['"+da(e)+"']"}function da(e){return e.replace(la,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function ua(e){return"'"+da(e)+"'"}var ha=/^\/(?:[^~]|~0|~1)*$/,pa=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function ma(e,t){return'""'==e?t:(e+" + "+t).replace(/([^\\])' \+ '/g,"$1")}function fa(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function va(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}var ya=function(e){aa.copy(e,this)};var ga=ea((function(e){var t=e.exports=function(e,r,a){"function"==typeof r&&(a=r,r={}),function e(r,a,i,s,o,n,l,c,d,u){if(s&&"object"==typeof s&&!Array.isArray(s)){for(var h in a(s,o,n,l,c,d,u),s){var p=s[h];if(Array.isArray(p)){if(h in t.arrayKeywords)for(var m=0;m<p.length;m++)e(r,a,i,p[m],o+"/"+h+"/"+m,n,o,h,s,m)}else if(h in t.propsKeywords){if(p&&"object"==typeof p)for(var f in p)e(r,a,i,p[f],o+"/"+h+"/"+f.replace(/~/g,"~0").replace(/\//g,"~1"),n,o,h,s,f)}else(h in t.keywords||r.allKeys&&!(h in t.skipKeywords))&&e(r,a,i,p,o+"/"+h,n,o,h,s)}i(s,o,n,l,c,d,u)}}(r,"function"==typeof(a=r.cb||a)?a:a.pre||function(){},a.post||function(){},e,"",e)};t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},t.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},t.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}})),_a=ba;function ba(e,t,r){var a=this._refs[r];if("string"==typeof a){if(!this._refs[a])return ba.call(this,e,t,a);a=this._refs[a]}if((a=a||this._schemas[r])instanceof ya)return $a(a.schema,this._opts.inlineRefs)?a.schema:a.validate||this._compile(a);var i,s,o,n=wa.call(this,t,r);return n&&(i=n.schema,t=n.root,o=n.baseId),i instanceof ya?s=i.validate||e.call(this,i.schema,t,void 0,o):void 0!==i&&(s=$a(i,this._opts.inlineRefs)?i:e.call(this,i,t,void 0,o)),s}function wa(e,t){var r=ta.parse(t),a=ka(r),i=ja(this._getId(e.schema));if(0===Object.keys(e.schema).length||a!==i){var s=Ca(a),o=this._refs[s];if("string"==typeof o)return Pa.call(this,e,o,r);if(o instanceof ya)o.validate||this._compile(o),e=o;else{if(!((o=this._schemas[s])instanceof ya))return;if(o.validate||this._compile(o),s==Ca(t))return{schema:o,root:e,baseId:i};e=o}if(!e.schema)return;i=ja(this._getId(e.schema))}return Ea.call(this,r,i,e.schema,e)}function Pa(e,t,r){var a=wa.call(this,e,t);if(a){var i=a.schema,s=a.baseId;e=a.root;var o=this._getId(i);return o&&(s=Aa(s,o)),Ea.call(this,r,s,i,e)}}ba.normalizeId=Ca,ba.fullPath=ja,ba.url=Aa,ba.ids=function(e){var t=Ca(this._getId(e)),r={"":t},a={"":ja(t,!1)},i={},s=this;return ga(e,{allKeys:!0},(function(e,t,o,n,l,c,d){if(""!==t){var u=s._getId(e),h=r[n],p=a[n]+"/"+l;if(void 0!==d&&(p+="/"+("number"==typeof d?d:aa.escapeFragment(d))),"string"==typeof u){u=h=Ca(h?ta.resolve(h,u):u);var m=s._refs[u];if("string"==typeof m&&(m=s._refs[m]),m&&m.schema){if(!ra(e,m.schema))throw new Error('id "'+u+'" resolves to more than one schema')}else if(u!=Ca(p))if("#"==u[0]){if(i[u]&&!ra(e,i[u]))throw new Error('id "'+u+'" resolves to more than one schema');i[u]=e}else s._refs[u]=p}r[t]=h,a[t]=p}})),i},ba.inlineRef=$a,ba.schema=wa;var Sa=aa.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function Ea(e,t,r,a){if(e.fragment=e.fragment||"","/"==e.fragment.slice(0,1)){for(var i=e.fragment.split("/"),s=1;s<i.length;s++){var o=i[s];if(o){if(void 0===(r=r[o=aa.unescapeFragment(o)]))break;var n;if(!Sa[o]&&((n=this._getId(r))&&(t=Aa(t,n)),r.$ref)){var l=Aa(t,r.$ref),c=wa.call(this,a,l);c&&(r=c.schema,a=c.root,t=c.baseId)}}}return void 0!==r&&r!==a.schema?{schema:r,root:a,baseId:t}:void 0}}var xa=aa.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function $a(e,t){return!1!==t&&(void 0===t||!0===t?function e(t){var r;if(Array.isArray(t)){for(var a=0;a<t.length;a++)if("object"==typeof(r=t[a])&&!e(r))return!1}else for(var i in t){if("$ref"==i)return!1;if("object"==typeof(r=t[i])&&!e(r))return!1}return!0}(e):t?function e(t){var r,a=0;if(Array.isArray(t)){for(var i=0;i<t.length;i++)if("object"==typeof(r=t[i])&&(a+=e(r)),a==1/0)return 1/0}else for(var s in t){if("$ref"==s)return 1/0;if(xa[s])a++;else if("object"==typeof(r=t[s])&&(a+=e(r)+1),a==1/0)return 1/0}return a}(e)<=t:void 0)}function ja(e,t){return!1!==t&&(e=Ca(e)),ka(ta.parse(e))}function ka(e){return ta.serialize(e).split("#")[0]+"#"}var Oa=/#\/?$/;function Ca(e){return e?e.replace(Oa,""):""}function Aa(e,t){return t=Ca(t),ta.resolve(e,t)}var Fa={Validation:Ra((function(e){this.message="validation failed",this.errors=e,this.ajv=this.validation=!0})),MissingRef:Ra(Da)};function Da(e,t,r){this.message=r||Da.message(e,t),this.missingRef=_a.url(e,t),this.missingSchema=_a.normalizeId(_a.fullPath(this.missingRef))}function Ra(e){return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}Da.message=function(e,t){return"can't resolve reference "+t+" from id "+e};var za=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var r,a="boolean"==typeof t.cycles&&t.cycles,i=t.cmp&&(r=t.cmp,function(e){return function(t,a){var i={key:t,value:e[t]},s={key:a,value:e[a]};return r(i,s)}}),s=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var r,o;if(Array.isArray(t)){for(o="[",r=0;r<t.length;r++)r&&(o+=","),o+=e(t[r])||"null";return o+"]"}if(null===t)return"null";if(-1!==s.indexOf(t)){if(a)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var n=s.push(t)-1,l=Object.keys(t).sort(i&&i(t));for(o="",r=0;r<l.length;r++){var c=l[r],d=e(t[c]);d&&(o&&(o+=","),o+=JSON.stringify(c)+":"+d)}return s.splice(n,1),"{"+o+"}"}}(e)},Ia=function(e,t,r){var a="",i=!0===e.schema.$async,s=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),o=e.self._getId(e.schema);if(e.opts.strictKeywords){var n=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(n){var l="unknown keyword: "+n;if("log"!==e.opts.strictKeywords)throw new Error(l);e.logger.warn(l)}}if(e.isTop&&(a+=" var validate = ",i&&(e.async=!0,a+="async "),a+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",o&&(e.opts.sourceCode||e.opts.processCode)&&(a+=" /*# sourceURL="+o+" */ ")),"boolean"==typeof e.schema||!s&&!e.schema.$ref){var c=e.level,d=e.dataLevel,u=e.schema["false schema"],h=e.schemaPath+e.util.getProperty("false schema"),p=e.errSchemaPath+"/false schema",m=!e.opts.allErrors,f="data"+(d||""),v="valid"+c;if(!1===e.schema){e.isTop?m=!0:a+=" var "+v+" = false; ",(W=W||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'false schema' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'boolean schema is false' "),e.opts.verbose&&(a+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var y=a;a=W.pop(),!e.compositeRule&&m?e.async?a+=" throw new ValidationError(["+y+"]); ":a+=" validate.errors = ["+y+"]; return false; ":a+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?a+=i?" return data; ":" validate.errors = null; return true; ":a+=" var "+v+" = true; ";return e.isTop&&(a+=" }; return validate; "),a}if(e.isTop){var g=e.isTop;c=e.level=0,d=e.dataLevel=0,f="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[void 0],void 0!==e.schema.default&&e.opts.useDefaults&&e.opts.strictDefaults){var _="default is ignored in the schema root";if("log"!==e.opts.strictDefaults)throw new Error(_);e.logger.warn(_)}a+=" var vErrors = null; ",a+=" var errors = 0;     ",a+=" if (rootData === undefined) rootData = data; "}else{c=e.level,f="data"+((d=e.dataLevel)||"");if(o&&(e.baseId=e.resolve.url(e.baseId,o)),i&&!e.async)throw new Error("async schema in sync schema");a+=" var errs_"+c+" = errors;"}v="valid"+c,m=!e.opts.allErrors;var b="",w="",P=e.schema.type,S=Array.isArray(P);if(P&&e.opts.nullable&&!0===e.schema.nullable&&(S?-1==P.indexOf("null")&&(P=P.concat("null")):"null"!=P&&(P=[P,"null"],S=!0)),S&&1==P.length&&(P=P[0],S=!1),e.schema.$ref&&s){if("fail"==e.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');!0!==e.opts.extendRefs&&(s=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(a+=" "+e.RULES.all.$comment.code(e,"$comment")),P){if(e.opts.coerceTypes)var E=e.util.coerceToTypes(e.opts.coerceTypes,P);var x=e.RULES.types[P];if(E||S||!0===x||x&&!Z(x)){h=e.schemaPath+".type",p=e.errSchemaPath+"/type",h=e.schemaPath+".type",p=e.errSchemaPath+"/type";var $=S?"checkDataTypes":"checkDataType";if(a+=" if ("+e.util[$](P,f,e.opts.strictNumbers,!0)+") { ",E){var j="dataType"+c,k="coerced"+c;a+=" var "+j+" = typeof "+f+"; var "+k+" = undefined; ","array"==e.opts.coerceTypes&&(a+=" if ("+j+" == 'object' && Array.isArray("+f+") && "+f+".length == 1) { "+f+" = "+f+"[0]; "+j+" = typeof "+f+"; if ("+e.util.checkDataType(e.schema.type,f,e.opts.strictNumbers)+") "+k+" = "+f+"; } "),a+=" if ("+k+" !== undefined) ; ";var O=E;if(O)for(var C,A=-1,F=O.length-1;A<F;)"string"==(C=O[A+=1])?a+=" else if ("+j+" == 'number' || "+j+" == 'boolean') "+k+" = '' + "+f+"; else if ("+f+" === null) "+k+" = ''; ":"number"==C||"integer"==C?(a+=" else if ("+j+" == 'boolean' || "+f+" === null || ("+j+" == 'string' && "+f+" && "+f+" == +"+f+" ","integer"==C&&(a+=" && !("+f+" % 1)"),a+=")) "+k+" = +"+f+"; "):"boolean"==C?a+=" else if ("+f+" === 'false' || "+f+" === 0 || "+f+" === null) "+k+" = false; else if ("+f+" === 'true' || "+f+" === 1) "+k+" = true; ":"null"==C?a+=" else if ("+f+" === '' || "+f+" === 0 || "+f+" === false) "+k+" = null; ":"array"==e.opts.coerceTypes&&"array"==C&&(a+=" else if ("+j+" == 'string' || "+j+" == 'number' || "+j+" == 'boolean' || "+f+" == null) "+k+" = ["+f+"]; ");a+=" else {   ",(W=W||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",a+=S?""+P.join(","):""+P,a+="' } ",!1!==e.opts.messages&&(a+=" , message: 'should be ",a+=S?""+P.join(","):""+P,a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";y=a;a=W.pop(),!e.compositeRule&&m?e.async?a+=" throw new ValidationError(["+y+"]); ":a+=" validate.errors = ["+y+"]; return false; ":a+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } if ("+k+" !== undefined) {  ";var D=d?"data"+(d-1||""):"parentData";a+=" "+f+" = "+k+"; ",d||(a+="if ("+D+" !== undefined)"),a+=" "+D+"["+(d?e.dataPathArr[d]:"parentDataProperty")+"] = "+k+"; } "}else{(W=W||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",a+=S?""+P.join(","):""+P,a+="' } ",!1!==e.opts.messages&&(a+=" , message: 'should be ",a+=S?""+P.join(","):""+P,a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";y=a;a=W.pop(),!e.compositeRule&&m?e.async?a+=" throw new ValidationError(["+y+"]); ":a+=" validate.errors = ["+y+"]; return false; ":a+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}a+=" } "}}if(e.schema.$ref&&!s)a+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",m&&(a+=" } if (errors === ",a+=g?"0":"errs_"+c,a+=") { ",w+="}");else{var R=e.RULES;if(R)for(var z=-1,I=R.length-1;z<I;)if(Z(x=R[z+=1])){if(x.type&&(a+=" if ("+e.util.checkDataType(x.type,f,e.opts.strictNumbers)+") { "),e.opts.useDefaults)if("object"==x.type&&e.schema.properties){u=e.schema.properties;var N=Object.keys(u);if(N)for(var T,L=-1,V=N.length-1;L<V;){if(void 0!==(M=u[T=N[L+=1]]).default){var q=f+e.util.getProperty(T);if(e.compositeRule){if(e.opts.strictDefaults){_="default is ignored for: "+q;if("log"!==e.opts.strictDefaults)throw new Error(_);e.logger.warn(_)}}else a+=" if ("+q+" === undefined ","empty"==e.opts.useDefaults&&(a+=" || "+q+" === null || "+q+" === '' "),a+=" ) "+q+" = ","shared"==e.opts.useDefaults?a+=" "+e.useDefault(M.default)+" ":a+=" "+JSON.stringify(M.default)+" ",a+="; "}}}else if("array"==x.type&&Array.isArray(e.schema.items)){var U=e.schema.items;if(U){A=-1;for(var M,Q=U.length-1;A<Q;)if(void 0!==(M=U[A+=1]).default){q=f+"["+A+"]";if(e.compositeRule){if(e.opts.strictDefaults){_="default is ignored for: "+q;if("log"!==e.opts.strictDefaults)throw new Error(_);e.logger.warn(_)}}else a+=" if ("+q+" === undefined ","empty"==e.opts.useDefaults&&(a+=" || "+q+" === null || "+q+" === '' "),a+=" ) "+q+" = ","shared"==e.opts.useDefaults?a+=" "+e.useDefault(M.default)+" ":a+=" "+JSON.stringify(M.default)+" ",a+="; "}}}var H=x.rules;if(H)for(var G,K=-1,B=H.length-1;K<B;)if(Y(G=H[K+=1])){var J=G.code(e,G.keyword,x.type);J&&(a+=" "+J+" ",m&&(b+="}"))}if(m&&(a+=" "+b+" ",b=""),x.type&&(a+=" } ",P&&P===x.type&&!E)){a+=" else { ";var W;h=e.schemaPath+".type",p=e.errSchemaPath+"/type";(W=W||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",a+=S?""+P.join(","):""+P,a+="' } ",!1!==e.opts.messages&&(a+=" , message: 'should be ",a+=S?""+P.join(","):""+P,a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";y=a;a=W.pop(),!e.compositeRule&&m?e.async?a+=" throw new ValidationError(["+y+"]); ":a+=" validate.errors = ["+y+"]; return false; ":a+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } "}m&&(a+=" if (errors === ",a+=g?"0":"errs_"+c,a+=") { ",w+="}")}}function Z(e){for(var t=e.rules,r=0;r<t.length;r++)if(Y(t[r]))return!0}function Y(t){return void 0!==e.schema[t.keyword]||t.implements&&function(t){for(var r=t.implements,a=0;a<r.length;a++)if(void 0!==e.schema[r[a]])return!0}(t)}return m&&(a+=" "+w+" "),g?(i?(a+=" if (errors === 0) return data;           ",a+=" else throw new ValidationError(vErrors); "):(a+=" validate.errors = vErrors; ",a+=" return errors === 0;       "),a+=" }; return validate;"):a+=" var "+v+" = errors === errs_"+c+";",a},Na=aa.ucs2length,Ta=Fa.Validation,La=function e(t,r,a,i){var s=this,o=this._opts,n=[void 0],l={},c=[],d={},u=[],h={},p=[];r=r||{schema:t,refVal:n,refs:l};var m=Va.call(this,t,r,i),f=this._compilations[m.index];if(m.compiling)return f.callValidate=function e(){var t=f.validate,r=t.apply(this,arguments);return e.errors=t.errors,r};var v=this._formats,y=this.RULES;try{var g=b(t,r,a,i);f.validate=g;var _=f.callValidate;return _&&(_.schema=g.schema,_.errors=null,_.refs=g.refs,_.refVal=g.refVal,_.root=g.root,_.$async=g.$async,o.sourceCode&&(_.source=g.source)),g}finally{qa.call(this,t,r,i)}function b(t,a,i,d){var h=!a||a&&a.schema==t;if(a.schema!=r.schema)return e.call(s,t,a,i,d);var m,f=!0===t.$async,g=Ia({isTop:!0,schema:t,isRoot:h,baseId:d,root:a,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:Fa.MissingRef,RULES:y,validate:Ia,util:aa,resolve:_a,resolveRef:w,usePattern:E,useDefault:x,useCustomRule:$,opts:o,formats:v,logger:s.logger,self:s});g=Ka(n,Ha)+Ka(c,Ma)+Ka(u,Qa)+Ka(p,Ga)+g,o.processCode&&(g=o.processCode(g,t));try{m=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",g)(s,y,v,r,n,u,p,ra,Na,Ta),n[0]=m}catch(e){throw s.logger.error("Error compiling schema, function code:",g),e}return m.schema=t,m.errors=null,m.refs=l,m.refVal=n,m.root=h?m:a,f&&(m.$async=!0),!0===o.sourceCode&&(m.source={code:g,patterns:c,defaults:u}),m}function w(t,i,c){i=_a.url(t,i);var d,u,h=l[i];if(void 0!==h)return S(d=n[h],u="refVal["+h+"]");if(!c&&r.refs){var p=r.refs[i];if(void 0!==p)return S(d=r.refVal[p],u=P(i,d))}u=P(i);var m=_a.call(s,b,r,i);if(void 0===m){var f=a&&a[i];f&&(m=_a.inlineRef(f,o.inlineRefs)?f:e.call(s,f,r,a,t))}if(void 0!==m)return function(e,t){var r=l[e];n[r]=t}(i,m),S(m,u);!function(e){delete l[e]}(i)}function P(e,t){var r=n.length;return n[r]=t,l[e]=r,"refVal"+r}function S(e,t){return"object"==typeof e||"boolean"==typeof e?{code:t,schema:e,inline:!0}:{code:t,$async:e&&!!e.$async}}function E(e){var t=d[e];return void 0===t&&(t=d[e]=c.length,c[t]=e),"pattern"+t}function x(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return aa.toQuotedString(e);case"object":if(null===e)return"null";var t=za(e),r=h[t];return void 0===r&&(r=h[t]=u.length,u[r]=e),"default"+r}}function $(e,t,r,a){if(!1!==s._opts.validateSchema){var i=e.definition.dependencies;if(i&&!i.every((function(e){return Object.prototype.hasOwnProperty.call(r,e)})))throw new Error("parent schema must have all required keywords: "+i.join(","));var n=e.definition.validateSchema;if(n)if(!n(t)){var l="keyword schema is invalid: "+s.errorsText(n.errors);if("log"!=s._opts.validateSchema)throw new Error(l);s.logger.error(l)}}var c,d=e.definition.compile,u=e.definition.inline,h=e.definition.macro;if(d)c=d.call(s,t,r,a);else if(h)c=h.call(s,t,r,a),!1!==o.validateSchema&&s.validateSchema(c,!0);else if(u)c=u.call(s,a,e.keyword,t,r);else if(!(c=e.definition.validate))return;if(void 0===c)throw new Error('custom keyword "'+e.keyword+'"failed to compile');var m=p.length;return p[m]=c,{code:"customRule"+m,validate:c}}};function Va(e,t,r){var a=Ua.call(this,e,t,r);return a>=0?{index:a,compiling:!0}:(a=this._compilations.length,this._compilations[a]={schema:e,root:t,baseId:r},{index:a,compiling:!1})}function qa(e,t,r){var a=Ua.call(this,e,t,r);a>=0&&this._compilations.splice(a,1)}function Ua(e,t,r){for(var a=0;a<this._compilations.length;a++){var i=this._compilations[a];if(i.schema==e&&i.root==t&&i.baseId==r)return a}return-1}function Ma(e,t){return"var pattern"+e+" = new RegExp("+aa.toQuotedString(t[e])+");"}function Qa(e){return"var default"+e+" = defaults["+e+"];"}function Ha(e,t){return void 0===t[e]?"":"var refVal"+e+" = refVal["+e+"];"}function Ga(e){return"var customRule"+e+" = customRules["+e+"];"}function Ka(e,t){if(!e.length)return"";for(var r="",a=0;a<e.length;a++)r+=t(a,e);return r}var Ba=ea((function(e){var t=e.exports=function(){this._cache={}};t.prototype.put=function(e,t){this._cache[e]=t},t.prototype.get=function(e){return this._cache[e]},t.prototype.del=function(e){delete this._cache[e]},t.prototype.clear=function(){this._cache={}}})),Ja=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,Wa=[0,31,28,31,30,31,30,31,31,30,31,30,31],Za=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,Ya=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,Xa=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,ei=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,ti=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,ri=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,ai=/^(?:\/(?:[^~/]|~0|~1)*)*$/,ii=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,si=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,oi=ni;function ni(e){return e="full"==e?"full":"fast",aa.copy(ni[e])}function li(e){var t=e.match(Ja);if(!t)return!1;var r=+t[1],a=+t[2],i=+t[3];return a>=1&&a<=12&&i>=1&&i<=(2==a&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(r)?29:Wa[a])}function ci(e,t){var r=e.match(Za);if(!r)return!1;var a=r[1],i=r[2],s=r[3],o=r[5];return(a<=23&&i<=59&&s<=59||23==a&&59==i&&60==s)&&(!t||o)}ni.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":ei,url:ti,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:Ya,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:pi,uuid:ri,"json-pointer":ai,"json-pointer-uri-fragment":ii,"relative-json-pointer":si},ni.full={date:li,time:ci,"date-time":function(e){var t=e.split(di);return 2==t.length&&li(t[0])&&ci(t[1],!0)},uri:function(e){return ui.test(e)&&Xa.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":ei,url:ti,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:Ya,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:pi,uuid:ri,"json-pointer":ai,"json-pointer-uri-fragment":ii,"relative-json-pointer":si};var di=/t|\s/i;var ui=/\/|:/;var hi=/[^\\]\\Z/;function pi(e){if(hi.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}}var mi=function(e,t,r){var a,i=" ",s=e.level,o=e.dataLevel,n=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(o||""),h=e.opts.$data&&n&&n.$data;h?(i+=" var schema"+s+" = "+e.util.getData(n.$data,o,e.dataPathArr)+"; ",a="schema"+s):a=n;var p="maximum"==t,m=p?"exclusiveMaximum":"exclusiveMinimum",f=e.schema[m],v=e.opts.$data&&f&&f.$data,y=p?"<":">",g=p?">":"<",_=void 0;if(!h&&"number"!=typeof n&&void 0!==n)throw new Error(t+" must be number");if(!v&&void 0!==f&&"number"!=typeof f&&"boolean"!=typeof f)throw new Error(m+" must be number or boolean");if(v){var b=e.util.getData(f.$data,o,e.dataPathArr),w="exclusive"+s,P="exclType"+s,S="exclIsNumber"+s,E="' + "+(j="op"+s)+" + '";i+=" var schemaExcl"+s+" = "+b+"; ",i+=" var "+w+"; var "+P+" = typeof "+(b="schemaExcl"+s)+"; if ("+P+" != 'boolean' && "+P+" != 'undefined' && "+P+" != 'number') { ";var x;_=m;(x=x||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(_||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: '"+m+" should be boolean' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var $=i;i=x.pop(),!e.compositeRule&&d?e.async?i+=" throw new ValidationError(["+$+"]); ":i+=" validate.errors = ["+$+"]; return false; ":i+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else if ( ",h&&(i+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),i+=" "+P+" == 'number' ? ( ("+w+" = "+a+" === undefined || "+b+" "+y+"= "+a+") ? "+u+" "+g+"= "+b+" : "+u+" "+g+" "+a+" ) : ( ("+w+" = "+b+" === true) ? "+u+" "+g+"= "+a+" : "+u+" "+g+" "+a+" ) || "+u+" !== "+u+") { var op"+s+" = "+w+" ? '"+y+"' : '"+y+"='; ",void 0===n&&(_=m,c=e.errSchemaPath+"/"+m,a=b,h=v)}else{E=y;if((S="number"==typeof f)&&h){var j="'"+E+"'";i+=" if ( ",h&&(i+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),i+=" ( "+a+" === undefined || "+f+" "+y+"= "+a+" ? "+u+" "+g+"= "+f+" : "+u+" "+g+" "+a+" ) || "+u+" !== "+u+") { "}else{S&&void 0===n?(w=!0,_=m,c=e.errSchemaPath+"/"+m,a=f,g+="="):(S&&(a=Math[p?"min":"max"](f,n)),f===(!S||a)?(w=!0,_=m,c=e.errSchemaPath+"/"+m,g+="="):(w=!1,E+="="));j="'"+E+"'";i+=" if ( ",h&&(i+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),i+=" "+u+" "+g+" "+a+" || "+u+" !== "+u+") { "}}_=_||t,(x=x||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(_||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { comparison: "+j+", limit: "+a+", exclusive: "+w+" } ",!1!==e.opts.messages&&(i+=" , message: 'should be "+E+" ",i+=h?"' + "+a:a+"'"),e.opts.verbose&&(i+=" , schema:  ",i+=h?"validate.schema"+l:""+n,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";$=i;return i=x.pop(),!e.compositeRule&&d?e.async?i+=" throw new ValidationError(["+$+"]); ":i+=" validate.errors = ["+$+"]; return false; ":i+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",d&&(i+=" else { "),i},fi=function(e,t,r){var a,i=" ",s=e.level,o=e.dataLevel,n=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(o||""),h=e.opts.$data&&n&&n.$data;if(h?(i+=" var schema"+s+" = "+e.util.getData(n.$data,o,e.dataPathArr)+"; ",a="schema"+s):a=n,!h&&"number"!=typeof n)throw new Error(t+" must be number");i+="if ( ",h&&(i+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),i+=" "+u+".length "+("maxItems"==t?">":"<")+" "+a+") { ";var p=t,m=m||[];m.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(p||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+a+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have ",i+="maxItems"==t?"more":"fewer",i+=" than ",i+=h?"' + "+a+" + '":""+n,i+=" items' "),e.opts.verbose&&(i+=" , schema:  ",i+=h?"validate.schema"+l:""+n,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var f=i;return i=m.pop(),!e.compositeRule&&d?e.async?i+=" throw new ValidationError(["+f+"]); ":i+=" validate.errors = ["+f+"]; return false; ":i+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",d&&(i+=" else { "),i},vi=function(e,t,r){var a,i=" ",s=e.level,o=e.dataLevel,n=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(o||""),h=e.opts.$data&&n&&n.$data;if(h?(i+=" var schema"+s+" = "+e.util.getData(n.$data,o,e.dataPathArr)+"; ",a="schema"+s):a=n,!h&&"number"!=typeof n)throw new Error(t+" must be number");var p="maxLength"==t?">":"<";i+="if ( ",h&&(i+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),!1===e.opts.unicode?i+=" "+u+".length ":i+=" ucs2length("+u+") ",i+=" "+p+" "+a+") { ";var m=t,f=f||[];f.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(m||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+a+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT be ",i+="maxLength"==t?"longer":"shorter",i+=" than ",i+=h?"' + "+a+" + '":""+n,i+=" characters' "),e.opts.verbose&&(i+=" , schema:  ",i+=h?"validate.schema"+l:""+n,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var v=i;return i=f.pop(),!e.compositeRule&&d?e.async?i+=" throw new ValidationError(["+v+"]); ":i+=" validate.errors = ["+v+"]; return false; ":i+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",d&&(i+=" else { "),i},yi=function(e,t,r){var a,i=" ",s=e.level,o=e.dataLevel,n=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(o||""),h=e.opts.$data&&n&&n.$data;if(h?(i+=" var schema"+s+" = "+e.util.getData(n.$data,o,e.dataPathArr)+"; ",a="schema"+s):a=n,!h&&"number"!=typeof n)throw new Error(t+" must be number");i+="if ( ",h&&(i+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),i+=" Object.keys("+u+").length "+("maxProperties"==t?">":"<")+" "+a+") { ";var p=t,m=m||[];m.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(p||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+a+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have ",i+="maxProperties"==t?"more":"fewer",i+=" than ",i+=h?"' + "+a+" + '":""+n,i+=" properties' "),e.opts.verbose&&(i+=" , schema:  ",i+=h?"validate.schema"+l:""+n,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var f=i;return i=m.pop(),!e.compositeRule&&d?e.async?i+=" throw new ValidationError(["+f+"]); ":i+=" validate.errors = ["+f+"]; return false; ":i+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",d&&(i+=" else { "),i},gi={$ref:function(e,t,r){var a,i,s=" ",o=e.level,n=e.dataLevel,l=e.schema[t],c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(n||""),h="valid"+o;if("#"==l||"#/"==l)e.isRoot?(a=e.async,i="validate"):(a=!0===e.root.schema.$async,i="root.refVal[0]");else{var p=e.resolveRef(e.baseId,l,e.isRoot);if(void 0===p){var m=e.MissingRefError.message(e.baseId,l);if("fail"==e.opts.missingRefs){e.logger.error(m),(g=g||[]).push(s),s="",!1!==e.createErrors?(s+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { ref: '"+e.util.escapeQuotes(l)+"' } ",!1!==e.opts.messages&&(s+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(l)+"' "),e.opts.verbose&&(s+=" , schema: "+e.util.toQuotedString(l)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),s+=" } "):s+=" {} ";var f=s;s=g.pop(),!e.compositeRule&&d?e.async?s+=" throw new ValidationError(["+f+"]); ":s+=" validate.errors = ["+f+"]; return false; ":s+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",d&&(s+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs)throw new e.MissingRefError(e.baseId,l,m);e.logger.warn(m),d&&(s+=" if (true) { ")}}else if(p.inline){var v=e.util.copy(e);v.level++;var y="valid"+v.level;v.schema=p.schema,v.schemaPath="",v.errSchemaPath=l,s+=" "+e.validate(v).replace(/validate\.schema/g,p.code)+" ",d&&(s+=" if ("+y+") { ")}else a=!0===p.$async||e.async&&!1!==p.$async,i=p.code}if(i){var g;(g=g||[]).push(s),s="",e.opts.passContext?s+=" "+i+".call(this, ":s+=" "+i+"( ",s+=" "+u+", (dataPath || '')",'""'!=e.errorPath&&(s+=" + "+e.errorPath);var _=s+=" , "+(n?"data"+(n-1||""):"parentData")+" , "+(n?e.dataPathArr[n]:"parentDataProperty")+", rootData)  ";if(s=g.pop(),a){if(!e.async)throw new Error("async schema referenced by sync schema");d&&(s+=" var "+h+"; "),s+=" try { await "+_+"; ",d&&(s+=" "+h+" = true; "),s+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",d&&(s+=" "+h+" = false; "),s+=" } ",d&&(s+=" if ("+h+") { ")}else s+=" if (!"+_+") { if (vErrors === null) vErrors = "+i+".errors; else vErrors = vErrors.concat("+i+".errors); errors = vErrors.length; } ",d&&(s+=" else { ")}return s},allOf:function(e,t,r){var a=" ",i=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,n=!e.opts.allErrors,l=e.util.copy(e),c="";l.level++;var d="valid"+l.level,u=l.baseId,h=!0,p=i;if(p)for(var m,f=-1,v=p.length-1;f<v;)m=p[f+=1],(e.opts.strictKeywords?"object"==typeof m&&Object.keys(m).length>0:e.util.schemaHasRules(m,e.RULES.all))&&(h=!1,l.schema=m,l.schemaPath=s+"["+f+"]",l.errSchemaPath=o+"/"+f,a+="  "+e.validate(l)+" ",l.baseId=u,n&&(a+=" if ("+d+") { ",c+="}"));return n&&(a+=h?" if (true) { ":" "+c.slice(0,-1)+" "),a},anyOf:function(e,t,r){var a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+i,h="errs__"+i,p=e.util.copy(e),m="";p.level++;var f="valid"+p.level;if(o.every((function(t){return e.opts.strictKeywords?"object"==typeof t&&Object.keys(t).length>0:e.util.schemaHasRules(t,e.RULES.all)}))){var v=p.baseId;a+=" var "+h+" = errors; var "+u+" = false;  ";var y=e.compositeRule;e.compositeRule=p.compositeRule=!0;var g=o;if(g)for(var _,b=-1,w=g.length-1;b<w;)_=g[b+=1],p.schema=_,p.schemaPath=n+"["+b+"]",p.errSchemaPath=l+"/"+b,a+="  "+e.validate(p)+" ",p.baseId=v,a+=" "+u+" = "+u+" || "+f+"; if (!"+u+") { ",m+="}";e.compositeRule=p.compositeRule=y,a+=" "+m+" if (!"+u+") {   var err =   ",!1!==e.createErrors?(a+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?a+=" throw new ValidationError(vErrors); ":a+=" validate.errors = vErrors; return false; "),a+=" } else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } ",e.opts.allErrors&&(a+=" } ")}else c&&(a+=" if (true) { ");return a},$comment:function(e,t,r){var a=" ",i=e.schema[t],s=e.errSchemaPath+"/"+t,o=(e.opts.allErrors,e.util.toQuotedString(i));return!0===e.opts.$comment?a+=" console.log("+o+");":"function"==typeof e.opts.$comment&&(a+=" self._opts.$comment("+o+", "+e.util.toQuotedString(s)+", validate.root.schema);"),a},const:function(e,t,r){var a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+i,h=e.opts.$data&&o&&o.$data;h&&(a+=" var schema"+i+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; "),h||(a+=" var schema"+i+" = validate.schema"+n+";"),a+="var "+u+" = equal("+d+", schema"+i+"); if (!"+u+") {   ";var p=p||[];p.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValue: schema"+i+" } ",!1!==e.opts.messages&&(a+=" , message: 'should be equal to constant' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ";var m=a;return a=p.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+m+"]); ":a+=" validate.errors = ["+m+"]; return false; ":a+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" }",c&&(a+=" else { "),a},contains:function(e,t,r){var a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+i,h="errs__"+i,p=e.util.copy(e);p.level++;var m="valid"+p.level,f="i"+i,v=p.dataLevel=e.dataLevel+1,y="data"+v,g=e.baseId,_=e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all);if(a+="var "+h+" = errors;var "+u+";",_){var b=e.compositeRule;e.compositeRule=p.compositeRule=!0,p.schema=o,p.schemaPath=n,p.errSchemaPath=l,a+=" var "+m+" = false; for (var "+f+" = 0; "+f+" < "+d+".length; "+f+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers,!0);var w=d+"["+f+"]";p.dataPathArr[v]=f;var P=e.validate(p);p.baseId=g,e.util.varOccurences(P,y)<2?a+=" "+e.util.varReplace(P,y,w)+" ":a+=" var "+y+" = "+w+"; "+P+" ",a+=" if ("+m+") break; }  ",e.compositeRule=p.compositeRule=b,a+="  if (!"+m+") {"}else a+=" if ("+d+".length == 0) {";var S=S||[];S.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'should contain a valid item' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ";var E=a;return a=S.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+E+"]); ":a+=" validate.errors = ["+E+"]; return false; ":a+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else { ",_&&(a+="  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } "),e.opts.allErrors&&(a+=" } "),a},dependencies:function(e,t,r){var a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="errs__"+i,h=e.util.copy(e),p="";h.level++;var m="valid"+h.level,f={},v={},y=e.opts.ownProperties;for(w in o)if("__proto__"!=w){var g=o[w],_=Array.isArray(g)?v:f;_[w]=g}a+="var "+u+" = errors;";var b=e.errorPath;for(var w in a+="var missing"+i+";",v)if((_=v[w]).length){if(a+=" if ( "+d+e.util.getProperty(w)+" !== undefined ",y&&(a+=" && Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(w)+"') "),c){a+=" && ( ";var P=_;if(P)for(var S=-1,E=P.length-1;S<E;){C=P[S+=1],S&&(a+=" || "),a+=" ( ( "+(R=d+(D=e.util.getProperty(C)))+" === undefined ",y&&(a+=" || ! Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(C)+"') "),a+=") && (missing"+i+" = "+e.util.toQuotedString(e.opts.jsonPointers?C:D)+") ) "}a+=")) {  ";var x="missing"+i,$="' + "+x+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(b,x,!0):b+" + "+x);var j=j||[];j.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(w)+"', missingProperty: '"+$+"', depsCount: "+_.length+", deps: '"+e.util.escapeQuotes(1==_.length?_[0]:_.join(", "))+"' } ",!1!==e.opts.messages&&(a+=" , message: 'should have ",1==_.length?a+="property "+e.util.escapeQuotes(_[0]):a+="properties "+e.util.escapeQuotes(_.join(", ")),a+=" when property "+e.util.escapeQuotes(w)+" is present' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ";var k=a;a=j.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+k+"]); ":a+=" validate.errors = ["+k+"]; return false; ":a+=" var err = "+k+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{a+=" ) { ";var O=_;if(O)for(var C,A=-1,F=O.length-1;A<F;){C=O[A+=1];var D=e.util.getProperty(C),R=($=e.util.escapeQuotes(C),d+D);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(b,C,e.opts.jsonPointers)),a+=" if ( "+R+" === undefined ",y&&(a+=" || ! Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(C)+"') "),a+=") {  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(w)+"', missingProperty: '"+$+"', depsCount: "+_.length+", deps: '"+e.util.escapeQuotes(1==_.length?_[0]:_.join(", "))+"' } ",!1!==e.opts.messages&&(a+=" , message: 'should have ",1==_.length?a+="property "+e.util.escapeQuotes(_[0]):a+="properties "+e.util.escapeQuotes(_.join(", ")),a+=" when property "+e.util.escapeQuotes(w)+" is present' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}a+=" }   ",c&&(p+="}",a+=" else { ")}e.errorPath=b;var z=h.baseId;for(var w in f){g=f[w];(e.opts.strictKeywords?"object"==typeof g&&Object.keys(g).length>0:e.util.schemaHasRules(g,e.RULES.all))&&(a+=" "+m+" = true; if ( "+d+e.util.getProperty(w)+" !== undefined ",y&&(a+=" && Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(w)+"') "),a+=") { ",h.schema=g,h.schemaPath=n+e.util.getProperty(w),h.errSchemaPath=l+"/"+e.util.escapeFragment(w),a+="  "+e.validate(h)+" ",h.baseId=z,a+=" }  ",c&&(a+=" if ("+m+") { ",p+="}"))}return c&&(a+="   "+p+" if ("+u+" == errors) {"),a},enum:function(e,t,r){var a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+i,h=e.opts.$data&&o&&o.$data;h&&(a+=" var schema"+i+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; ");var p="i"+i,m="schema"+i;h||(a+=" var "+m+" = validate.schema"+n+";"),a+="var "+u+";",h&&(a+=" if (schema"+i+" === undefined) "+u+" = true; else if (!Array.isArray(schema"+i+")) "+u+" = false; else {"),a+=u+" = false;for (var "+p+"=0; "+p+"<"+m+".length; "+p+"++) if (equal("+d+", "+m+"["+p+"])) { "+u+" = true; break; }",h&&(a+="  }  "),a+=" if (!"+u+") {   ";var f=f||[];f.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValues: schema"+i+" } ",!1!==e.opts.messages&&(a+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ";var v=a;return a=f.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+v+"]); ":a+=" validate.errors = ["+v+"]; return false; ":a+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" }",c&&(a+=" else { "),a},format:function(e,t,r){var a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||"");if(!1===e.opts.format)return c&&(a+=" if (true) { "),a;var u,h=e.opts.$data&&o&&o.$data;h?(a+=" var schema"+i+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; ",u="schema"+i):u=o;var p=e.opts.unknownFormats,m=Array.isArray(p);if(h){a+=" var "+(f="format"+i)+" = formats["+u+"]; var "+(v="isObject"+i)+" = typeof "+f+" == 'object' && !("+f+" instanceof RegExp) && "+f+".validate; var "+(y="formatType"+i)+" = "+v+" && "+f+".type || 'string'; if ("+v+") { ",e.async&&(a+=" var async"+i+" = "+f+".async; "),a+=" "+f+" = "+f+".validate; } if (  ",h&&(a+=" ("+u+" !== undefined && typeof "+u+" != 'string') || "),a+=" (","ignore"!=p&&(a+=" ("+u+" && !"+f+" ",m&&(a+=" && self._opts.unknownFormats.indexOf("+u+") == -1 "),a+=") || "),a+=" ("+f+" && "+y+" == '"+r+"' && !(typeof "+f+" == 'function' ? ",e.async?a+=" (async"+i+" ? await "+f+"("+d+") : "+f+"("+d+")) ":a+=" "+f+"("+d+") ",a+=" : "+f+".test("+d+"))))) {"}else{var f;if(!(f=e.formats[o])){if("ignore"==p)return e.logger.warn('unknown format "'+o+'" ignored in schema at path "'+e.errSchemaPath+'"'),c&&(a+=" if (true) { "),a;if(m&&p.indexOf(o)>=0)return c&&(a+=" if (true) { "),a;throw new Error('unknown format "'+o+'" is used in schema at path "'+e.errSchemaPath+'"')}var v,y=(v="object"==typeof f&&!(f instanceof RegExp)&&f.validate)&&f.type||"string";if(v){var g=!0===f.async;f=f.validate}if(y!=r)return c&&(a+=" if (true) { "),a;if(g){if(!e.async)throw new Error("async format in sync schema");a+=" if (!(await "+(_="formats"+e.util.getProperty(o)+".validate")+"("+d+"))) { "}else{a+=" if (! ";var _="formats"+e.util.getProperty(o);v&&(_+=".validate"),a+="function"==typeof f?" "+_+"("+d+") ":" "+_+".test("+d+") ",a+=") { "}}var b=b||[];b.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { format:  ",a+=h?""+u:""+e.util.toQuotedString(o),a+="  } ",!1!==e.opts.messages&&(a+=" , message: 'should match format \"",a+=h?"' + "+u+" + '":""+e.util.escapeQuotes(o),a+="\"' "),e.opts.verbose&&(a+=" , schema:  ",a+=h?"validate.schema"+n:""+e.util.toQuotedString(o),a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ";var w=a;return a=b.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+w+"]); ":a+=" validate.errors = ["+w+"]; return false; ":a+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } ",c&&(a+=" else { "),a},if:function(e,t,r){var a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+i,h="errs__"+i,p=e.util.copy(e);p.level++;var m="valid"+p.level,f=e.schema.then,v=e.schema.else,y=void 0!==f&&(e.opts.strictKeywords?"object"==typeof f&&Object.keys(f).length>0:e.util.schemaHasRules(f,e.RULES.all)),g=void 0!==v&&(e.opts.strictKeywords?"object"==typeof v&&Object.keys(v).length>0:e.util.schemaHasRules(v,e.RULES.all)),_=p.baseId;if(y||g){var b;p.createErrors=!1,p.schema=o,p.schemaPath=n,p.errSchemaPath=l,a+=" var "+h+" = errors; var "+u+" = true;  ";var w=e.compositeRule;e.compositeRule=p.compositeRule=!0,a+="  "+e.validate(p)+" ",p.baseId=_,p.createErrors=!0,a+="  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; }  ",e.compositeRule=p.compositeRule=w,y?(a+=" if ("+m+") {  ",p.schema=e.schema.then,p.schemaPath=e.schemaPath+".then",p.errSchemaPath=e.errSchemaPath+"/then",a+="  "+e.validate(p)+" ",p.baseId=_,a+=" "+u+" = "+m+"; ",y&&g?a+=" var "+(b="ifClause"+i)+" = 'then'; ":b="'then'",a+=" } ",g&&(a+=" else { ")):a+=" if (!"+m+") { ",g&&(p.schema=e.schema.else,p.schemaPath=e.schemaPath+".else",p.errSchemaPath=e.errSchemaPath+"/else",a+="  "+e.validate(p)+" ",p.baseId=_,a+=" "+u+" = "+m+"; ",y&&g?a+=" var "+(b="ifClause"+i)+" = 'else'; ":b="'else'",a+=" } "),a+=" if (!"+u+") {   var err =   ",!1!==e.createErrors?(a+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { failingKeyword: "+b+" } ",!1!==e.opts.messages&&(a+=" , message: 'should match \"' + "+b+" + '\" schema' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?a+=" throw new ValidationError(vErrors); ":a+=" validate.errors = vErrors; return false; "),a+=" }   ",c&&(a+=" else { ")}else c&&(a+=" if (true) { ");return a},items:function(e,t,r){var a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+i,h="errs__"+i,p=e.util.copy(e),m="";p.level++;var f="valid"+p.level,v="i"+i,y=p.dataLevel=e.dataLevel+1,g="data"+y,_=e.baseId;if(a+="var "+h+" = errors;var "+u+";",Array.isArray(o)){var b=e.schema.additionalItems;if(!1===b){a+=" "+u+" = "+d+".length <= "+o.length+"; ";var w=l;l=e.errSchemaPath+"/additionalItems",a+="  if (!"+u+") {   ";var P=P||[];P.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+o.length+" } ",!1!==e.opts.messages&&(a+=" , message: 'should NOT have more than "+o.length+" items' "),e.opts.verbose&&(a+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ";var S=a;a=P.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+S+"]); ":a+=" validate.errors = ["+S+"]; return false; ":a+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } ",l=w,c&&(m+="}",a+=" else { ")}var E=o;if(E)for(var x,$=-1,j=E.length-1;$<j;)if(x=E[$+=1],e.opts.strictKeywords?"object"==typeof x&&Object.keys(x).length>0:e.util.schemaHasRules(x,e.RULES.all)){a+=" "+f+" = true; if ("+d+".length > "+$+") { ";var k=d+"["+$+"]";p.schema=x,p.schemaPath=n+"["+$+"]",p.errSchemaPath=l+"/"+$,p.errorPath=e.util.getPathExpr(e.errorPath,$,e.opts.jsonPointers,!0),p.dataPathArr[y]=$;var O=e.validate(p);p.baseId=_,e.util.varOccurences(O,g)<2?a+=" "+e.util.varReplace(O,g,k)+" ":a+=" var "+g+" = "+k+"; "+O+" ",a+=" }  ",c&&(a+=" if ("+f+") { ",m+="}")}if("object"==typeof b&&(e.opts.strictKeywords?"object"==typeof b&&Object.keys(b).length>0:e.util.schemaHasRules(b,e.RULES.all))){p.schema=b,p.schemaPath=e.schemaPath+".additionalItems",p.errSchemaPath=e.errSchemaPath+"/additionalItems",a+=" "+f+" = true; if ("+d+".length > "+o.length+") {  for (var "+v+" = "+o.length+"; "+v+" < "+d+".length; "+v+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers,!0);k=d+"["+v+"]";p.dataPathArr[y]=v;O=e.validate(p);p.baseId=_,e.util.varOccurences(O,g)<2?a+=" "+e.util.varReplace(O,g,k)+" ":a+=" var "+g+" = "+k+"; "+O+" ",c&&(a+=" if (!"+f+") break; "),a+=" } }  ",c&&(a+=" if ("+f+") { ",m+="}")}}else if(e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all)){p.schema=o,p.schemaPath=n,p.errSchemaPath=l,a+="  for (var "+v+" = 0; "+v+" < "+d+".length; "+v+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers,!0);k=d+"["+v+"]";p.dataPathArr[y]=v;O=e.validate(p);p.baseId=_,e.util.varOccurences(O,g)<2?a+=" "+e.util.varReplace(O,g,k)+" ":a+=" var "+g+" = "+k+"; "+O+" ",c&&(a+=" if (!"+f+") break; "),a+=" }"}return c&&(a+=" "+m+" if ("+h+" == errors) {"),a},maximum:mi,minimum:mi,maxItems:fi,minItems:fi,maxLength:vi,minLength:vi,maxProperties:yi,minProperties:yi,multipleOf:function(e,t,r){var a,i=" ",s=e.level,o=e.dataLevel,n=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(o||""),h=e.opts.$data&&n&&n.$data;if(h?(i+=" var schema"+s+" = "+e.util.getData(n.$data,o,e.dataPathArr)+"; ",a="schema"+s):a=n,!h&&"number"!=typeof n)throw new Error(t+" must be number");i+="var division"+s+";if (",h&&(i+=" "+a+" !== undefined && ( typeof "+a+" != 'number' || "),i+=" (division"+s+" = "+u+" / "+a+", ",e.opts.multipleOfPrecision?i+=" Math.abs(Math.round(division"+s+") - division"+s+") > 1e-"+e.opts.multipleOfPrecision+" ":i+=" division"+s+" !== parseInt(division"+s+") ",i+=" ) ",h&&(i+="  )  "),i+=" ) {   ";var p=p||[];p.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { multipleOf: "+a+" } ",!1!==e.opts.messages&&(i+=" , message: 'should be multiple of ",i+=h?"' + "+a:a+"'"),e.opts.verbose&&(i+=" , schema:  ",i+=h?"validate.schema"+l:""+n,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var m=i;return i=p.pop(),!e.compositeRule&&d?e.async?i+=" throw new ValidationError(["+m+"]); ":i+=" validate.errors = ["+m+"]; return false; ":i+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",d&&(i+=" else { "),i},not:function(e,t,r){var a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="errs__"+i,h=e.util.copy(e);h.level++;var p="valid"+h.level;if(e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all)){h.schema=o,h.schemaPath=n,h.errSchemaPath=l,a+=" var "+u+" = errors;  ";var m,f=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.createErrors=!1,h.opts.allErrors&&(m=h.opts.allErrors,h.opts.allErrors=!1),a+=" "+e.validate(h)+" ",h.createErrors=!0,m&&(h.opts.allErrors=m),e.compositeRule=h.compositeRule=f,a+=" if ("+p+") {   ";var v=v||[];v.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'should NOT be valid' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ";var y=a;a=v.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+y+"]); ":a+=" validate.errors = ["+y+"]; return false; ":a+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else {  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; } ",e.opts.allErrors&&(a+=" } ")}else a+="  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'should NOT be valid' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(a+=" if (false) { ");return a},oneOf:function(e,t,r){var a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+i,h="errs__"+i,p=e.util.copy(e),m="";p.level++;var f="valid"+p.level,v=p.baseId,y="prevValid"+i,g="passingSchemas"+i;a+="var "+h+" = errors , "+y+" = false , "+u+" = false , "+g+" = null; ";var _=e.compositeRule;e.compositeRule=p.compositeRule=!0;var b=o;if(b)for(var w,P=-1,S=b.length-1;P<S;)w=b[P+=1],(e.opts.strictKeywords?"object"==typeof w&&Object.keys(w).length>0:e.util.schemaHasRules(w,e.RULES.all))?(p.schema=w,p.schemaPath=n+"["+P+"]",p.errSchemaPath=l+"/"+P,a+="  "+e.validate(p)+" ",p.baseId=v):a+=" var "+f+" = true; ",P&&(a+=" if ("+f+" && "+y+") { "+u+" = false; "+g+" = ["+g+", "+P+"]; } else { ",m+="}"),a+=" if ("+f+") { "+u+" = "+y+" = true; "+g+" = "+P+"; }";return e.compositeRule=p.compositeRule=_,a+=m+"if (!"+u+") {   var err =   ",!1!==e.createErrors?(a+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { passingSchemas: "+g+" } ",!1!==e.opts.messages&&(a+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?a+=" throw new ValidationError(vErrors); ":a+=" validate.errors = vErrors; return false; "),a+="} else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; }",e.opts.allErrors&&(a+=" } "),a},pattern:function(e,t,r){var a,i=" ",s=e.level,o=e.dataLevel,n=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(o||""),h=e.opts.$data&&n&&n.$data;h?(i+=" var schema"+s+" = "+e.util.getData(n.$data,o,e.dataPathArr)+"; ",a="schema"+s):a=n,i+="if ( ",h&&(i+=" ("+a+" !== undefined && typeof "+a+" != 'string') || "),i+=" !"+(h?"(new RegExp("+a+"))":e.usePattern(n))+".test("+u+") ) {   ";var p=p||[];p.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { pattern:  ",i+=h?""+a:""+e.util.toQuotedString(n),i+="  } ",!1!==e.opts.messages&&(i+=" , message: 'should match pattern \"",i+=h?"' + "+a+" + '":""+e.util.escapeQuotes(n),i+="\"' "),e.opts.verbose&&(i+=" , schema:  ",i+=h?"validate.schema"+l:""+e.util.toQuotedString(n),i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var m=i;return i=p.pop(),!e.compositeRule&&d?e.async?i+=" throw new ValidationError(["+m+"]); ":i+=" validate.errors = ["+m+"]; return false; ":i+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",d&&(i+=" else { "),i},properties:function(e,t,r){var a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="errs__"+i,h=e.util.copy(e),p="";h.level++;var m="valid"+h.level,f="key"+i,v="idx"+i,y=h.dataLevel=e.dataLevel+1,g="data"+y,_="dataProperties"+i,b=Object.keys(o||{}).filter(D),w=e.schema.patternProperties||{},P=Object.keys(w).filter(D),S=e.schema.additionalProperties,E=b.length||P.length,x=!1===S,$="object"==typeof S&&Object.keys(S).length,j=e.opts.removeAdditional,k=x||$||j,O=e.opts.ownProperties,C=e.baseId,A=e.schema.required;if(A&&(!e.opts.$data||!A.$data)&&A.length<e.opts.loopRequired)var F=e.util.toHash(A);function D(e){return"__proto__"!==e}if(a+="var "+u+" = errors;var "+m+" = true;",O&&(a+=" var "+_+" = undefined;"),k){if(a+=O?" "+_+" = "+_+" || Object.keys("+d+"); for (var "+v+"=0; "+v+"<"+_+".length; "+v+"++) { var "+f+" = "+_+"["+v+"]; ":" for (var "+f+" in "+d+") { ",E){if(a+=" var isAdditional"+i+" = !(false ",b.length)if(b.length>8)a+=" || validate.schema"+n+".hasOwnProperty("+f+") ";else{var R=b;if(R)for(var z=-1,I=R.length-1;z<I;)J=R[z+=1],a+=" || "+f+" == "+e.util.toQuotedString(J)+" "}if(P.length){var N=P;if(N)for(var T=-1,L=N.length-1;T<L;)se=N[T+=1],a+=" || "+e.usePattern(se)+".test("+f+") "}a+=" ); if (isAdditional"+i+") { "}if("all"==j)a+=" delete "+d+"["+f+"]; ";else{var V=e.errorPath,q="' + "+f+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers)),x)if(j)a+=" delete "+d+"["+f+"]; ";else{a+=" "+m+" = false; ";var U=l;l=e.errSchemaPath+"/additionalProperties",(re=re||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { additionalProperty: '"+q+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is an invalid additional property":a+="should NOT have additional properties",a+="' "),e.opts.verbose&&(a+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ";var M=a;a=re.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+M+"]); ":a+=" validate.errors = ["+M+"]; return false; ":a+=" var err = "+M+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=U,c&&(a+=" break; ")}else if($)if("failing"==j){a+=" var "+u+" = errors;  ";var Q=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.schema=S,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers);var H=d+"["+f+"]";h.dataPathArr[y]=f;var G=e.validate(h);h.baseId=C,e.util.varOccurences(G,g)<2?a+=" "+e.util.varReplace(G,g,H)+" ":a+=" var "+g+" = "+H+"; "+G+" ",a+=" if (!"+m+") { errors = "+u+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+d+"["+f+"]; }  ",e.compositeRule=h.compositeRule=Q}else{h.schema=S,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers);H=d+"["+f+"]";h.dataPathArr[y]=f;G=e.validate(h);h.baseId=C,e.util.varOccurences(G,g)<2?a+=" "+e.util.varReplace(G,g,H)+" ":a+=" var "+g+" = "+H+"; "+G+" ",c&&(a+=" if (!"+m+") break; ")}e.errorPath=V}E&&(a+=" } "),a+=" }  ",c&&(a+=" if ("+m+") { ",p+="}")}var K=e.opts.useDefaults&&!e.compositeRule;if(b.length){var B=b;if(B)for(var J,W=-1,Z=B.length-1;W<Z;){var Y=o[J=B[W+=1]];if(e.opts.strictKeywords?"object"==typeof Y&&Object.keys(Y).length>0:e.util.schemaHasRules(Y,e.RULES.all)){var X=e.util.getProperty(J),ee=(H=d+X,K&&void 0!==Y.default);h.schema=Y,h.schemaPath=n+X,h.errSchemaPath=l+"/"+e.util.escapeFragment(J),h.errorPath=e.util.getPath(e.errorPath,J,e.opts.jsonPointers),h.dataPathArr[y]=e.util.toQuotedString(J);G=e.validate(h);if(h.baseId=C,e.util.varOccurences(G,g)<2){G=e.util.varReplace(G,g,H);var te=H}else{te=g;a+=" var "+g+" = "+H+"; "}if(ee)a+=" "+G+" ";else{if(F&&F[J]){a+=" if ( "+te+" === undefined ",O&&(a+=" || ! Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(J)+"') "),a+=") { "+m+" = false; ";V=e.errorPath,U=l;var re,ae=e.util.escapeQuotes(J);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(V,J,e.opts.jsonPointers)),l=e.errSchemaPath+"/required",(re=re||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+ae+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+ae+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ";M=a;a=re.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+M+"]); ":a+=" validate.errors = ["+M+"]; return false; ":a+=" var err = "+M+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=U,e.errorPath=V,a+=" } else { "}else c?(a+=" if ( "+te+" === undefined ",O&&(a+=" || ! Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(J)+"') "),a+=") { "+m+" = true; } else { "):(a+=" if ("+te+" !== undefined ",O&&(a+=" &&   Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(J)+"') "),a+=" ) { ");a+=" "+G+" } "}}c&&(a+=" if ("+m+") { ",p+="}")}}if(P.length){var ie=P;if(ie)for(var se,oe=-1,ne=ie.length-1;oe<ne;){Y=w[se=ie[oe+=1]];if(e.opts.strictKeywords?"object"==typeof Y&&Object.keys(Y).length>0:e.util.schemaHasRules(Y,e.RULES.all)){h.schema=Y,h.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(se),h.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(se),a+=O?" "+_+" = "+_+" || Object.keys("+d+"); for (var "+v+"=0; "+v+"<"+_+".length; "+v+"++) { var "+f+" = "+_+"["+v+"]; ":" for (var "+f+" in "+d+") { ",a+=" if ("+e.usePattern(se)+".test("+f+")) { ",h.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers);H=d+"["+f+"]";h.dataPathArr[y]=f;G=e.validate(h);h.baseId=C,e.util.varOccurences(G,g)<2?a+=" "+e.util.varReplace(G,g,H)+" ":a+=" var "+g+" = "+H+"; "+G+" ",c&&(a+=" if (!"+m+") break; "),a+=" } ",c&&(a+=" else "+m+" = true; "),a+=" }  ",c&&(a+=" if ("+m+") { ",p+="}")}}}return c&&(a+=" "+p+" if ("+u+" == errors) {"),a},propertyNames:function(e,t,r){var a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="errs__"+i,h=e.util.copy(e);h.level++;var p="valid"+h.level;if(a+="var "+u+" = errors;",e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all)){h.schema=o,h.schemaPath=n,h.errSchemaPath=l;var m="key"+i,f="idx"+i,v="i"+i,y="' + "+m+" + '",g="data"+(h.dataLevel=e.dataLevel+1),_="dataProperties"+i,b=e.opts.ownProperties,w=e.baseId;b&&(a+=" var "+_+" = undefined; "),a+=b?" "+_+" = "+_+" || Object.keys("+d+"); for (var "+f+"=0; "+f+"<"+_+".length; "+f+"++) { var "+m+" = "+_+"["+f+"]; ":" for (var "+m+" in "+d+") { ",a+=" var startErrs"+i+" = errors; ";var P=m,S=e.compositeRule;e.compositeRule=h.compositeRule=!0;var E=e.validate(h);h.baseId=w,e.util.varOccurences(E,g)<2?a+=" "+e.util.varReplace(E,g,P)+" ":a+=" var "+g+" = "+P+"; "+E+" ",e.compositeRule=h.compositeRule=S,a+=" if (!"+p+") { for (var "+v+"=startErrs"+i+"; "+v+"<errors; "+v+"++) { vErrors["+v+"].propertyName = "+m+"; }   var err =   ",!1!==e.createErrors?(a+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { propertyName: '"+y+"' } ",!1!==e.opts.messages&&(a+=" , message: 'property name \\'"+y+"\\' is invalid' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?a+=" throw new ValidationError(vErrors); ":a+=" validate.errors = vErrors; return false; "),c&&(a+=" break; "),a+=" } }"}return c&&(a+="  if ("+u+" == errors) {"),a},required:function(e,t,r){var a=" ",i=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,d="data"+(s||""),u="valid"+i,h=e.opts.$data&&o&&o.$data;h&&(a+=" var schema"+i+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; ");var p="schema"+i;if(!h)if(o.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var m=[],f=o;if(f)for(var v,y=-1,g=f.length-1;y<g;){v=f[y+=1];var _=e.schema.properties[v];_&&(e.opts.strictKeywords?"object"==typeof _&&Object.keys(_).length>0:e.util.schemaHasRules(_,e.RULES.all))||(m[m.length]=v)}}else m=o;if(h||m.length){var b=e.errorPath,w=h||m.length>=e.opts.loopRequired,P=e.opts.ownProperties;if(c)if(a+=" var missing"+i+"; ",w){h||(a+=" var "+p+" = validate.schema"+n+"; ");var S="' + "+(O="schema"+i+"["+($="i"+i)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(b,O,e.opts.jsonPointers)),a+=" var "+u+" = true; ",h&&(a+=" if (schema"+i+" === undefined) "+u+" = true; else if (!Array.isArray(schema"+i+")) "+u+" = false; else {"),a+=" for (var "+$+" = 0; "+$+" < "+p+".length; "+$+"++) { "+u+" = "+d+"["+p+"["+$+"]] !== undefined ",P&&(a+=" &&   Object.prototype.hasOwnProperty.call("+d+", "+p+"["+$+"]) "),a+="; if (!"+u+") break; } ",h&&(a+="  }  "),a+="  if (!"+u+") {   ",(k=k||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+S+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+S+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ";var E=a;a=k.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+E+"]); ":a+=" validate.errors = ["+E+"]; return false; ":a+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else { "}else{a+=" if ( ";var x=m;if(x)for(var $=-1,j=x.length-1;$<j;){A=x[$+=1],$&&(a+=" || "),a+=" ( ( "+(z=d+(R=e.util.getProperty(A)))+" === undefined ",P&&(a+=" || ! Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(A)+"') "),a+=") && (missing"+i+" = "+e.util.toQuotedString(e.opts.jsonPointers?A:R)+") ) "}a+=") {  ";var k;S="' + "+(O="missing"+i)+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(b,O,!0):b+" + "+O),(k=k||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+S+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+S+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ";E=a;a=k.pop(),!e.compositeRule&&c?e.async?a+=" throw new ValidationError(["+E+"]); ":a+=" validate.errors = ["+E+"]; return false; ":a+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else { "}else if(w){h||(a+=" var "+p+" = validate.schema"+n+"; ");var O;S="' + "+(O="schema"+i+"["+($="i"+i)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(b,O,e.opts.jsonPointers)),h&&(a+=" if ("+p+" && !Array.isArray("+p+")) {  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+S+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+S+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+p+" !== undefined) { "),a+=" for (var "+$+" = 0; "+$+" < "+p+".length; "+$+"++) { if ("+d+"["+p+"["+$+"]] === undefined ",P&&(a+=" || ! Object.prototype.hasOwnProperty.call("+d+", "+p+"["+$+"]) "),a+=") {  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+S+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+S+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",h&&(a+="  }  ")}else{var C=m;if(C)for(var A,F=-1,D=C.length-1;F<D;){A=C[F+=1];var R=e.util.getProperty(A),z=(S=e.util.escapeQuotes(A),d+R);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(b,A,e.opts.jsonPointers)),a+=" if ( "+z+" === undefined ",P&&(a+=" || ! Object.prototype.hasOwnProperty.call("+d+", '"+e.util.escapeQuotes(A)+"') "),a+=") {  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+S+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+S+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=b}else c&&(a+=" if (true) {");return a},uniqueItems:function(e,t,r){var a,i=" ",s=e.level,o=e.dataLevel,n=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,u="data"+(o||""),h="valid"+s,p=e.opts.$data&&n&&n.$data;if(p?(i+=" var schema"+s+" = "+e.util.getData(n.$data,o,e.dataPathArr)+"; ",a="schema"+s):a=n,(n||p)&&!1!==e.opts.uniqueItems){p&&(i+=" var "+h+"; if ("+a+" === false || "+a+" === undefined) "+h+" = true; else if (typeof "+a+" != 'boolean') "+h+" = false; else { "),i+=" var i = "+u+".length , "+h+" = true , j; if (i > 1) { ";var m=e.schema.items&&e.schema.items.type,f=Array.isArray(m);if(!m||"object"==m||"array"==m||f&&(m.indexOf("object")>=0||m.indexOf("array")>=0))i+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+u+"[i], "+u+"[j])) { "+h+" = false; break outer; } } } ";else{i+=" var itemIndices = {}, item; for (;i--;) { var item = "+u+"[i]; ";var v="checkDataType"+(f?"s":"");i+=" if ("+e.util[v](m,"item",e.opts.strictNumbers,!0)+") continue; ",f&&(i+=" if (typeof item == 'string') item = '\"' + item; "),i+=" if (typeof itemIndices[item] == 'number') { "+h+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}i+=" } ",p&&(i+="  }  "),i+=" if (!"+h+") {   ";var y=y||[];y.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { i: i, j: j } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(i+=" , schema:  ",i+=p?"validate.schema"+l:""+n,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var g=i;i=y.pop(),!e.compositeRule&&d?e.async?i+=" throw new ValidationError(["+g+"]); ":i+=" validate.errors = ["+g+"]; return false; ":i+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",d&&(i+=" else { ")}else d&&(i+=" if (true) { ");return i},validate:Ia},_i=aa.toHash,bi=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"],wi=function(e,t){for(var r=0;r<t.length;r++){e=JSON.parse(JSON.stringify(e));var a,i=t[r].split("/"),s=e;for(a=1;a<i.length;a++)s=s[i[a]];for(a=0;a<bi.length;a++){var o=bi[a],n=s[o];n&&(s[o]={anyOf:[n,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return e},Pi=Fa.MissingRef,Si=function e(t,r,a){var i=this;if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");"function"==typeof r&&(a=r,r=void 0);var s=o(t).then((function(){var e=i._addSchema(t,void 0,r);return e.validate||function e(t){try{return i._compile(t)}catch(e){if(e instanceof Pi)return a(e);throw e}function a(a){var s=a.missingSchema;if(c(s))throw new Error("Schema "+s+" is loaded but "+a.missingRef+" cannot be resolved");var n=i._loadingSchemas[s];return n||(n=i._loadingSchemas[s]=i._opts.loadSchema(s)).then(l,l),n.then((function(e){if(!c(s))return o(e).then((function(){c(s)||i.addSchema(e,s,void 0,r)}))})).then((function(){return e(t)}));function l(){delete i._loadingSchemas[s]}function c(e){return i._refs[e]||i._schemas[e]}}}(e)}));a&&s.then((function(e){a(null,e)}),a);return s;function o(t){var r=t.$schema;return r&&!i.getSchema(r)?e.call(i,{$ref:r},!0):Promise.resolve()}};var Ei=function(e,t,r){var a,i,s=" ",o=e.level,n=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,h="data"+(n||""),p="valid"+o,m="errs__"+o,f=e.opts.$data&&l&&l.$data;f?(s+=" var schema"+o+" = "+e.util.getData(l.$data,n,e.dataPathArr)+"; ",i="schema"+o):i=l;var v,y,g,_,b,w="definition"+o,P=this.definition,S="";if(f&&P.$data){b="keywordValidate"+o;var E=P.validateSchema;s+=" var "+w+" = RULES.custom['"+t+"'].definition; var "+b+" = "+w+".validate;"}else{if(!(_=e.useCustomRule(this,l,e.schema,e)))return;i="validate.schema"+c,b=_.code,v=P.compile,y=P.inline,g=P.macro}var x=b+".errors",$="i"+o,j="ruleErr"+o,k=P.async;if(k&&!e.async)throw new Error("async keyword in sync schema");if(y||g||(s+=x+" = null;"),s+="var "+m+" = errors;var "+p+";",f&&P.$data&&(S+="}",s+=" if ("+i+" === undefined) { "+p+" = true; } else { ",E&&(S+="}",s+=" "+p+" = "+w+".validateSchema("+i+"); if ("+p+") { ")),y)P.statements?s+=" "+_.validate+" ":s+=" "+p+" = "+_.validate+"; ";else if(g){var O=e.util.copy(e);S="";O.level++;var C="valid"+O.level;O.schema=_.validate,O.schemaPath="";var A=e.compositeRule;e.compositeRule=O.compositeRule=!0;var F=e.validate(O).replace(/validate\.schema/g,b);e.compositeRule=O.compositeRule=A,s+=" "+F}else{(I=I||[]).push(s),s="",s+="  "+b+".call( ",e.opts.passContext?s+="this":s+="self",v||!1===P.schema?s+=" , "+h+" ":s+=" , "+i+" , "+h+" , validate.schema"+e.schemaPath+" ",s+=" , (dataPath || '')",'""'!=e.errorPath&&(s+=" + "+e.errorPath);var D=n?"data"+(n-1||""):"parentData",R=n?e.dataPathArr[n]:"parentDataProperty",z=s+=" , "+D+" , "+R+" , rootData )  ";s=I.pop(),!1===P.errors?(s+=" "+p+" = ",k&&(s+="await "),s+=z+"; "):s+=k?" var "+(x="customErrors"+o)+" = null; try { "+p+" = await "+z+"; } catch (e) { "+p+" = false; if (e instanceof ValidationError) "+x+" = e.errors; else throw e; } ":" "+x+" = null; "+p+" = "+z+"; "}if(P.modifying&&(s+=" if ("+D+") "+h+" = "+D+"["+R+"];"),s+=""+S,P.valid)u&&(s+=" if (true) { ");else{var I;s+=" if ( ",void 0===P.valid?(s+=" !",s+=g?""+C:""+p):s+=" "+!P.valid+" ",s+=") { ",a=this.keyword,(I=I||[]).push(s),s="",(I=I||[]).push(s),s="",!1!==e.createErrors?(s+=" { keyword: '"+(a||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(s+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(s+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),s+=" } "):s+=" {} ";var N=s;s=I.pop(),!e.compositeRule&&u?e.async?s+=" throw new ValidationError(["+N+"]); ":s+=" validate.errors = ["+N+"]; return false; ":s+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var T=s;s=I.pop(),y?P.errors?"full"!=P.errors&&(s+="  for (var "+$+"="+m+"; "+$+"<errors; "+$+"++) { var "+j+" = vErrors["+$+"]; if ("+j+".dataPath === undefined) "+j+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+j+".schemaPath === undefined) { "+j+'.schemaPath = "'+d+'"; } ',e.opts.verbose&&(s+=" "+j+".schema = "+i+"; "+j+".data = "+h+"; "),s+=" } "):!1===P.errors?s+=" "+T+" ":(s+=" if ("+m+" == errors) { "+T+" } else {  for (var "+$+"="+m+"; "+$+"<errors; "+$+"++) { var "+j+" = vErrors["+$+"]; if ("+j+".dataPath === undefined) "+j+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+j+".schemaPath === undefined) { "+j+'.schemaPath = "'+d+'"; } ',e.opts.verbose&&(s+=" "+j+".schema = "+i+"; "+j+".data = "+h+"; "),s+=" } } "):g?(s+="   var err =   ",!1!==e.createErrors?(s+=" { keyword: '"+(a||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(s+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(s+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),s+=" } "):s+=" {} ",s+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?s+=" throw new ValidationError(vErrors); ":s+=" validate.errors = vErrors; return false; ")):!1===P.errors?s+=" "+T+" ":(s+=" if (Array.isArray("+x+")) { if (vErrors === null) vErrors = "+x+"; else vErrors = vErrors.concat("+x+"); errors = vErrors.length;  for (var "+$+"="+m+"; "+$+"<errors; "+$+"++) { var "+j+" = vErrors["+$+"]; if ("+j+".dataPath === undefined) "+j+".dataPath = (dataPath || '') + "+e.errorPath+";  "+j+'.schemaPath = "'+d+'";  ',e.opts.verbose&&(s+=" "+j+".schema = "+i+"; "+j+".data = "+h+"; "),s+=" } } else { "+T+" } "),s+=" } ",u&&(s+=" else { ")}return s},xi={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0},$i={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:xi.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:xi.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}},ji=/^[a-z_$][a-z0-9_$-]*$/i,ki=function(e,t){var r=this.RULES;if(r.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!ji.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(t){this.validateKeyword(t,!0);var a=t.type;if(Array.isArray(a))for(var i=0;i<a.length;i++)o(e,a[i],t);else o(e,a,t);var s=t.metaSchema;s&&(t.$data&&this._opts.$data&&(s={anyOf:[s,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),t.validateSchema=this.compile(s,!0))}function o(e,t,a){for(var i,s=0;s<r.length;s++){var o=r[s];if(o.type==t){i=o;break}}i||(i={type:t,rules:[]},r.push(i));var n={keyword:e,definition:a,custom:!0,code:Ei,implements:a.implements};i.rules.push(n),r.custom[e]=n}return r.keywords[e]=r.all[e]=!0,this},Oi=function(e){var t=this.RULES.custom[e];return t?t.definition:this.RULES.keywords[e]||!1},Ci=function(e){var t=this.RULES;delete t.keywords[e],delete t.all[e],delete t.custom[e];for(var r=0;r<t.length;r++)for(var a=t[r].rules,i=0;i<a.length;i++)if(a[i].keyword==e){a.splice(i,1);break}return this},Ai=function e(t,r){e.errors=null;var a=this._validateKeyword=this._validateKeyword||this.compile($i,!0);if(a(t))return!0;if(e.errors=a.errors,r)throw new Error("custom keyword definition is invalid: "+this.errorsText(a.errors));return!1};var Fi={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1},Di=Ni;Ni.prototype.validate=function(e,t){var r;if("string"==typeof e){if(!(r=this.getSchema(e)))throw new Error('no schema with key or ref "'+e+'"')}else{var a=this._addSchema(e);r=a.validate||this._compile(a)}var i=r(t);!0!==r.$async&&(this.errors=r.errors);return i},Ni.prototype.compile=function(e,t){var r=this._addSchema(e,void 0,t);return r.validate||this._compile(r)},Ni.prototype.addSchema=function(e,t,r,a){if(Array.isArray(e)){for(var i=0;i<e.length;i++)this.addSchema(e[i],void 0,r,a);return this}var s=this._getId(e);if(void 0!==s&&"string"!=typeof s)throw new Error("schema id must be string");return Mi(this,t=_a.normalizeId(t||s)),this._schemas[t]=this._addSchema(e,r,a,!0),this},Ni.prototype.addMetaSchema=function(e,t,r){return this.addSchema(e,t,r,!0),this},Ni.prototype.validateSchema=function(e,t){var r=e.$schema;if(void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(!(r=r||this._opts.defaultMeta||function(e){var t=e._opts.meta;return e._opts.defaultMeta="object"==typeof t?e._getId(t)||t:e.getSchema(Ri)?Ri:void 0,e._opts.defaultMeta}(this)))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var a=this.validate(r,e);if(!a&&t){var i="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw new Error(i);this.logger.error(i)}return a},Ni.prototype.getSchema=function(e){var t=Ti(this,e);switch(typeof t){case"object":return t.validate||this._compile(t);case"string":return this.getSchema(t);case"undefined":return function(e,t){var r=_a.schema.call(e,{schema:{}},t);if(r){var a=r.schema,i=r.root,s=r.baseId,o=La.call(e,a,i,void 0,s);return e._fragments[t]=new ya({ref:t,fragment:!0,schema:a,root:i,baseId:s,validate:o}),o}}(this,e)}},Ni.prototype.removeSchema=function(e){if(e instanceof RegExp)return Li(this,this._schemas,e),Li(this,this._refs,e),this;switch(typeof e){case"undefined":return Li(this,this._schemas),Li(this,this._refs),this._cache.clear(),this;case"string":var t=Ti(this,e);return t&&this._cache.del(t.cacheKey),delete this._schemas[e],delete this._refs[e],this;case"object":var r=this._opts.serialize,a=r?r(e):e;this._cache.del(a);var i=this._getId(e);i&&(i=_a.normalizeId(i),delete this._schemas[i],delete this._refs[i])}return this},Ni.prototype.addFormat=function(e,t){"string"==typeof t&&(t=new RegExp(t));return this._formats[e]=t,this},Ni.prototype.errorsText=function(e,t){if(!(e=e||this.errors))return"No errors";for(var r=void 0===(t=t||{}).separator?", ":t.separator,a=void 0===t.dataVar?"data":t.dataVar,i="",s=0;s<e.length;s++){var o=e[s];o&&(i+=a+o.dataPath+" "+o.message+r)}return i.slice(0,-r.length)},Ni.prototype._addSchema=function(e,t,r,a){if("object"!=typeof e&&"boolean"!=typeof e)throw new Error("schema should be object or boolean");var i=this._opts.serialize,s=i?i(e):e,o=this._cache.get(s);if(o)return o;a=a||!1!==this._opts.addUsedSchema;var n=_a.normalizeId(this._getId(e));n&&a&&Mi(this,n);var l,c=!1!==this._opts.validateSchema&&!t;c&&!(l=n&&n==_a.normalizeId(e.$schema))&&this.validateSchema(e,!0);var d=_a.ids.call(this,e),u=new ya({id:n,schema:e,localRefs:d,cacheKey:s,meta:r});"#"!=n[0]&&a&&(this._refs[n]=u);this._cache.put(s,u),c&&l&&this.validateSchema(e,!0);return u},Ni.prototype._compile=function(e,t){if(e.compiling)return e.validate=i,i.schema=e.schema,i.errors=null,i.root=t||i,!0===e.schema.$async&&(i.$async=!0),i;var r,a;e.compiling=!0,e.meta&&(r=this._opts,this._opts=this._metaOpts);try{a=La.call(this,e.schema,t,e.localRefs)}catch(t){throw delete e.validate,t}finally{e.compiling=!1,e.meta&&(this._opts=r)}return e.validate=a,e.refs=a.refs,e.refVal=a.refVal,e.root=a.root,a;function i(){var t=e.validate,r=t.apply(this,arguments);return i.errors=t.errors,r}},Ni.prototype.compileAsync=Si,Ni.prototype.addKeyword=ki,Ni.prototype.getKeyword=Oi,Ni.prototype.removeKeyword=Ci,Ni.prototype.validateKeyword=Ai,Ni.ValidationError=Fa.Validation,Ni.MissingRefError=Fa.MissingRef,Ni.$dataMetaSchema=wi;var Ri="http://json-schema.org/draft-07/schema",zi=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],Ii=["/properties"];function Ni(e){if(!(this instanceof Ni))return new Ni(e);var t,r;e=this._opts=aa.copy(e)||{},function(e){var t=e._opts.logger;if(!1===t)e.logger={log:Qi,warn:Qi,error:Qi};else{if(void 0===t&&(t=console),!("object"==typeof t&&t.log&&t.warn&&t.error))throw new Error("logger must implement log, warn and error methods");e.logger=t}}(this),this._schemas={},this._refs={},this._fragments={},this._formats=oi(e.format),this._cache=e.cache||new Ba,this._loadingSchemas={},this._compilations=[],this.RULES=((t=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}]).all=_i(r=["type","$comment"]),t.types=_i(["number","integer","string","array","object","boolean","null"]),t.forEach((function(e){e.rules=e.rules.map((function(e){var a;if("object"==typeof e){var i=Object.keys(e)[0];a=e[i],e=i,a.forEach((function(e){r.push(e),t.all[e]=!0}))}return r.push(e),t.all[e]={keyword:e,code:gi[e],implements:a}})),t.all.$comment={keyword:"$comment",code:gi.$comment},e.type&&(t.types[e.type]=e)})),t.keywords=_i(r.concat(["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"])),t.custom={},t),this._getId=function(e){switch(e.schemaId){case"auto":return Ui;case"id":return Vi;default:return qi}}(e),e.loopRequired=e.loopRequired||1/0,"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),void 0===e.serialize&&(e.serialize=za),this._metaOpts=function(e){for(var t=aa.copy(e._opts),r=0;r<zi.length;r++)delete t[zi[r]];return t}(this),e.formats&&function(e){for(var t in e._opts.formats){var r=e._opts.formats[t];e.addFormat(t,r)}}(this),e.keywords&&function(e){for(var t in e._opts.keywords){var r=e._opts.keywords[t];e.addKeyword(t,r)}}(this),function(e){var t;e._opts.$data&&(t=Fi,e.addMetaSchema(t,t.$id,!0));if(!1===e._opts.meta)return;var r=xi;e._opts.$data&&(r=wi(r,Ii));e.addMetaSchema(r,Ri,!0),e._refs["http://json-schema.org/schema"]=Ri}(this),"object"==typeof e.meta&&this.addMetaSchema(e.meta),e.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),function(e){var t=e._opts.schemas;if(!t)return;if(Array.isArray(t))e.addSchema(t);else for(var r in t)e.addSchema(t[r],r)}(this)}function Ti(e,t){return t=_a.normalizeId(t),e._schemas[t]||e._refs[t]||e._fragments[t]}function Li(e,t,r){for(var a in t){var i=t[a];i.meta||r&&!r.test(a)||(e._cache.del(i.cacheKey),delete t[a])}}function Vi(e){return e.$id&&this.logger.warn("schema $id ignored",e.$id),e.id}function qi(e){return e.id&&this.logger.warn("schema id ignored",e.id),e.$id}function Ui(e){if(e.$id&&e.id&&e.$id!=e.id)throw new Error("schema $id is different from id");return e.$id||e.id}function Mi(e,t){if(e._schemas[t]||e._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}function Qi(){}const Hi=new Di({allErrors:!0,jsonPointers:!0}),Gi={type:"object",properties:{type:{type:"string"},style:{},discover_existing:{type:"boolean"},standard_configuration:{type:"boolean"},title:{type:["boolean","string"]},am_pm:{type:"boolean"},time_step:{type:"integer",minimum:1,maximum:60},domains:{type:"object",additionalProperties:{type:["object","null","boolean"],properties:{icon:{type:"string"},actions:{type:"array",items:{type:"object",properties:{icon:{type:"string"},name:{type:"string"},service:{type:"string"},service_data:{type:"object"},variable:{type:"object",oneOf:[{properties:{field:{type:"string"},name:{type:"string"},unit:{type:"string"},min:{type:"number",minimum:0},max:{type:"number",minimum:1},step:{type:"number",minimum:.1},optional:{type:"boolean"}},required:["field"],additionalProperties:!1},{properties:{field:{type:"string"},name:{type:"string"},options:{type:"array",items:{type:"object",properties:{value:{type:"string"},name:{type:"string"},icon:{type:"string"}},required:["value"],additionalProperties:!1}}},required:["field"],additionalProperties:!1}]}},required:["service"],additionalProperties:!1}},include:{type:"array",items:{type:"string"}},exclude:{type:"array",items:{type:"string"}}},additionalProperties:!1}},entities:{type:"object",additionalProperties:{type:["object","null","boolean"],properties:{name:{type:"string"},icon:{type:"string"},actions:{type:"array",items:{type:"object",properties:{icon:{type:"string"},name:{type:"string"},service:{type:"string"},service_data:{type:"object"},variable:{type:"object",oneOf:[{properties:{field:{type:"string"},name:{type:"string"},unit:{type:"string"},min:{type:"number",minimum:0},max:{type:"number",minimum:1},step:{type:"number",minimum:.1},optional:{type:"boolean"}},required:["field"],additionalProperties:!1},{properties:{field:{type:"string"},name:{type:"string"},options:{type:"array",items:{type:"object",properties:{value:{type:"string"},name:{type:"string"},icon:{type:"string"}},required:["value"],additionalProperties:!1}}},required:["field"],additionalProperties:!1}]}},required:["service"],additionalProperties:!1}}},additionalProperties:!1}},groups:{type:"object",additionalProperties:{type:"object",properties:{name:{type:"string"},icon:{type:"string"},entities:{type:"array",items:{type:"string"}},domains:{type:"array",items:{type:"string"}}},additionalProperties:!1,oneOf:[{required:["entities"]},{required:["domains"]}]}}},additionalProperties:!1};const Ki=/^D([0-7]+)T([0-9SR\-\+]+)([A0-9+]+)$/,Bi=/^(A([0-9]+))+$/,Ji=/^([0-9]{4})?(S[SR])([0-9]{4})?$/;let Wi=class extends ae{constructor(){super(...arguments),this._val=0,this.event=null,this.formatAmPm="false",this.stepSize=10,this.sunrise=0,this.sunset=0,this.maxOffset=2}set value(e){let t=this.value;this._val=e,this.requestUpdate("value",t)}get value(){return ne(this._val,this.stepSize)}updated(){let e=new CustomEvent("change",{detail:{event:this.event}});this.dispatchEvent(e)}firstUpdated(){"undefined"==this.event&&(this.event=null);let e=this.event?{stepSize:this.stepSize,signed:!0,max:60*this.maxOffset}:{stepSize:this.stepSize};this.value=ce(this.value,e)}render(){return T`
      <div class="time-picker">
        <div class="hours-up">
          <mwc-button @click="${this.hoursUp}">
            <ha-icon icon="hass:chevron-up"></ha-icon>
          </mwc-button>
        </div>
        <div class="hours">${this.getHours()}</div>
        <div class="hours-down">
          <mwc-button @click="${this.hoursDown}">
            <ha-icon icon="hass:chevron-down"></ha-icon>
          </mwc-button>
        </div>
        <div class="separator">:</div>
        <div class="minutes-up">
          <mwc-button @click="${this.minutesUp}">
            <ha-icon icon="hass:chevron-up"></ha-icon>
          </mwc-button>
        </div>
        <div class="minutes">${this.getMinutes()}</div>
        <div class="minutes-down">
          <mwc-button @click="${this.minutesDown}">
            <ha-icon icon="hass:chevron-down"></ha-icon>
          </mwc-button>
        </div>
        ${this.getSuffix()}
        <div class="options">
          ${this.getSunModeToggle()}
        </div>
      </div>
    `}getHours(){return le(this.value,{amPm:"true"==this.formatAmPm}).hours}getMinutes(){return le(this.value,{amPm:"true"==this.formatAmPm}).minutes}hoursUp(){let e=this.event?{stepSize:this.stepSize,signed:!0,max:60*this.maxOffset}:{stepSize:this.stepSize};this.value=ce(this._val+60,e)}hoursDown(){let e=this.event?{stepSize:this.stepSize,signed:!0,max:60*this.maxOffset}:{stepSize:this.stepSize};this.value=ce(this._val-60,e)}minutesUp(){let e=this.event?{stepSize:this.stepSize,signed:!0,max:60*this.maxOffset}:{stepSize:this.stepSize};this.value=ce(this._val+this.stepSize,e)}minutesDown(){let e=this.event?{stepSize:this.stepSize,signed:!0,max:60*this.maxOffset}:{stepSize:this.stepSize};this.value=ce(this._val-this.stepSize,e)}getSunModeToggle(){if(isNaN(this.sunrise)||isNaN(this.sunset))return T``;let e=Math.abs(ce(this._val-this.sunrise,{stepSize:this.stepSize,signed:!0})),t=Math.abs(ce(this._val-this.sunset,{stepSize:this.stepSize,signed:!0}));return this.event||e<=60*this.maxOffset||t<=60*this.maxOffset?T`
          <mwc-button @click="${this.toggleMode}" class="${this.event?"active":""}">
            <ha-icon icon="hass:theme-light-dark"></ha-icon>
          </mwc-button>
      `:T`
          <mwc-button disabled="disabled">
            <ha-icon icon="hass:theme-light-dark"></ha-icon>
          </mwc-button>
      `}getAmPm(){return le(this._val,{amPm:"true"==this.formatAmPm}).amPm}getBeforeAfter(){return this.value<0?Pr("words.before"):Pr("words.after")}getSuffix(){return this.event?T`
      <div class="suffix">
        <mwc-button @click="${this.toggleBeforeAfter}">
          ${this.getBeforeAfter()}
        </mwc-button>
        <mwc-button @click="${this.toggleSunriseSunset}">
          <ha-icon icon="hass:${"sunrise"==this.event?"weather-sunny":"weather-night"}"></ha-icon>
        </mwc-button>
      </div>
    `:"true"==this.formatAmPm?T`
      <div class="suffix">
        <mwc-button @click="${this.toggleAmPm}">
          ${this.getAmPm()}
        </mwc-button>
      </div>
    `:T``}toggleAmPm(){this._val<720?this.value=ce(this._val+720):this.value=ce(this._val-720)}toggleBeforeAfter(){this.value=-this._val}toggleSunriseSunset(){this.event="sunrise"==this.event?"sunset":"sunrise",this.value=this._val}toggleMode(){let e=this.value;if(this.event){let t="sunrise"==this.event?this.sunrise:this.sunset;this.event=null,this.value=e+t}else{let t;Math.abs(e-this.sunrise)<Math.abs(e-this.sunset)?(t=this.sunrise,this.event="sunrise"):(t=this.sunset,this.event="sunset"),this.value=e-t}}};Wi.styles=te`
      div.time-picker {
        display: grid;
        grid-template-columns: min-content min-content min-content 1fr min-content;
        grid-template-rows: min-content min-content min-content;
        grid-template-areas: "hours-up   .         minutes-up   suffix options"
                             "hours      separator minutes      suffix options"
                             "hours-down .         minutes-down suffix options";
        grid-gap: 10px 0px;
        align-items: center;
      }

      div.hours-up { grid-area: hours-up; }
      div.hours { grid-area: hours; }
      div.hours-down { grid-area: hours-down; }
      div.separator { grid-area: separator; }
      div.minutes-up { grid-area: minutes-up; }
      div.minutes { grid-area: minutes; }
      div.minutes-down { grid-area: minutes-down; }
      div.suffix { grid-area: suffix; flex-grow: 1; }
      div.options { grid-area: options; }

      div.hours-up, div.hours-down, div.minutes-up, div.minutes-down {
        --mdc-icon-size: 42px;
      }

      div.hours, div.minutes {
        font-size: 42px;
        text-align: center;
      }

      div.separator {
        font-size: 36px;
      }

      div.suffix mwc-button {
        --mdc-typography-button-font-size: 16px;
        --mdc-icon-size: 32px;
      }

      mwc-button.active {
        background: var(--primary-color);
        --mdc-theme-primary: var(--text-primary-color);
        border-radius: 4px;
      }
  `,t([Z({type:Number})],Wi.prototype,"value",null),t([Z({type:String})],Wi.prototype,"event",void 0),t([Z({type:String})],Wi.prototype,"formatAmPm",void 0),t([Z({type:Number})],Wi.prototype,"stepSize",void 0),t([Z({type:Number})],Wi.prototype,"sunrise",void 0),t([Z({type:Number})],Wi.prototype,"sunset",void 0),Wi=t([J("time-picker")],Wi);function Zi(e){return"true"==e||"false"!=e&&!!e.length}let Yi=class extends ae{constructor(){super(...arguments),this.min=0,this.max=100,this.step=1,this.value=0,this.unit="",this.optional="false",this.disabled="false",this.scaleGain=1,this.scaleOffset=0}updated(){}firstUpdated(){(async()=>{await(async()=>{if(customElements.get("ha-checkbox")&&customElements.get("ha-paper-slider"))return;await customElements.whenDefined("partial-panel-resolver");const e=document.createElement("partial-panel-resolver");e.hass={panels:[{url_path:"tmp",component_name:"config"}]},e._updateRoutes(),await e.routerOptions.routes.tmp.load(),await customElements.whenDefined("ha-panel-config");const t=document.createElement("ha-panel-config");await t.routerOptions.routes.automation.load()})()})(),"%"==this.unit&&(this.scaleOffset=this.min,this.scaleGain=(this.max-this.min)/100,this.min=0,this.max=100),Zi(this.disabled)&&!Zi(this.optional)&&(this.disabled="false"),isNaN(this.value)&&(this.value=this.min),this.requestUpdate()}render(){return T`
      <div class="container">
        <div class="checkbox">
        ${this.getCheckbox()}
        </div>
        <div class="slider">
        ${this.getSlider()}
        </div>
        <div class="value${Zi(this.disabled)?" disabled":""}">
        ${this.getScaledValue()}${this.unit}
        </div>
    `}getScaledValue(){let e=this.value,t=Math.round((e-this.scaleOffset)/this.scaleGain);return t<this.min?t=this.min:t>this.max&&(t=this.max),Math.round(t*this.step/this.step)}getSlider(){return Zi(this.disabled)?T`
        <ha-paper-slider
        pin
        min=${this.min}
        max=${this.max}
        step=${this.step}
        value=${this.getScaledValue()}
        disabled
        ></ha-paper-slider>`:T`
        <ha-paper-slider
        pin
        min=${this.min}
        max=${this.max}
        step=${this.step}
        value=${this.getScaledValue()}
        @change=${this.updateValue}
        ></ha-paper-slider>`}getCheckbox(){return Zi(this.optional)?Zi(this.disabled)?T`<ha-checkbox @change="${this.toggleChecked}"></ha-checkbox>`:T`<ha-checkbox @change="${this.toggleChecked}" checked></ha-checkbox>`:T``}toggleChecked(e){let t=e.target.checked;this.disabled=t?"false":"true"}updateValue(e){let t=Number(e.target.value)*this.scaleGain+this.scaleOffset;t=Math.round(t*this.step)/this.step,this.value=t}};function Xi(e){return e.endTime-e.startTime}Yi.styles=te`

      :host {
        width: 100%;
      }

      div.container {
        display: grid;
        grid-template-columns: min-content 1fr max-content;
        grid-template-rows: min-content;
        grid-template-areas: "checkbox slider value";
      }

      div.checkbox {
        grid-area: checkbox;
        display: flex;
        align-items: center;
      }

      div.slider {
        grid-area: slider;
        display: flex;
        align-items: center;
      }

      div.value {
        grid-area: value;
        min-width: 40px;
        display: flex;
        align-items: center;
      }

      ha-paper-slider {
        width: 100%;
        --paper-slider-pin-start-color: var(--primary-color);
      }
      
       .disabled {
        color: var(--disabled-text-color);
      }
  `,t([Z({type:Number})],Yi.prototype,"min",void 0),t([Z({type:Number})],Yi.prototype,"max",void 0),t([Z({type:Number})],Yi.prototype,"step",void 0),t([Z({type:Number})],Yi.prototype,"value",void 0),t([Z({type:String})],Yi.prototype,"unit",void 0),t([Z({type:String})],Yi.prototype,"optional",void 0),t([Z({type:String})],Yi.prototype,"disabled",void 0),Yi=t([J("variable-slider")],Yi);let es=class extends ae{constructor(){super(...arguments),this.slots=[],this.actions=[],this.stepSize=15,this._activeSlot=null,this._activeThumb=null,this.temperatureUnit=""}updated(){}firstUpdated(){}render(){return T`
      <div class="slider-container">
        <div>
          <div class="slider-track">
            ${this.getSlots()}
          </div>
        </div>
        <div class="slider-legend">
          <div class="slider-legend-item empty"></div>
          <div class="slider-legend-item">03:00</div>
          <div class="slider-legend-item">06:00</div>
          <div class="slider-legend-item">09:00</div>
          <div class="slider-legend-item">12:00</div>
          <div class="slider-legend-item">15:00</div>
          <div class="slider-legend-item">18:00</div>
          <div class="slider-legend-item">21:00</div>
          <div class="slider-legend-item empty"></div>
        </div>
      </div>
      <div>
        ${null!==this._activeSlot&&this.slots.length<10?T`
        <mwc-button @click="${this._addSlot}">
          <ha-icon icon="hass:plus-circle-outline" class="padded-right"></ha-icon>
          Add
        </mwc-button>
        `:T`
        <mwc-button disabled>
          <ha-icon icon="hass:plus-circle-outline" class="padded-right"></ha-icon>
          Add
        </mwc-button>
        `}
        ${null!==this._activeSlot&&this.slots.length>3?T`
        <mwc-button @click="${this._removeSlot}">
          <ha-icon icon="hass:minus-circle-outline" class="padded-right"></ha-icon>
          Remove
        </mwc-button>
        `:T`
        <mwc-button disabled>
          <ha-icon icon="hass:minus-circle-outline" class="padded-right"></ha-icon>
          Remove
        </mwc-button>
        `}
      </div>
    `}getSlots(){let e=[];return this.slots.forEach((t,r)=>{e.push(T`
        <div class="slider-slot${this._activeSlot==r?" active":""}" @click="${this._handleSegmentClick}" index="${r}" style="width: ${Xi(t)/1440*100}%">
          ${this.getSlotAction(t)}
        </div>
      `),r<this.slots.length-1&&e.push(T`
        <div class="slider-thumb${this._activeThumb==r?" active":""}" index="${r}">
          <ha-icon icon="hass:unfold-more-vertical"  @mousedown="${this._handleTouchStart}" @touchstart="${this._handleTouchStart}"></ha-icon>
          <div class="slider-thumb-tooltip" value="time" @update="${this._updateMarker}">
            ${le(this.slots[r].endTime).time}
          </div>
        </div>`)}),e}getSlotAction(e){if(!e.action)return"";let t=this.actions.find(t=>t.id==e.action);if(e.variable&&e.variable.type==ie.Level){let r=e.variable,a=t.variable;if(r.enabled)return Lr(r,a,{temperature_unit:this.temperatureUnit})}else if(e.variable&&e.variable.type==ie.List){return Lr(e.variable,t.variable,{temperature_unit:this.temperatureUnit})}return"turn_on"==e.action?"on":"turn_off"==e.action?"off":""+e.action}_handleSegmentClick(e){let t=e.target,r=Number(t.getAttribute("index"));this._activeSlot=this._activeSlot==r?null:r;let a=new CustomEvent("update",{detail:{slot:this._activeSlot}});this.dispatchEvent(a)}_handleTouchStart(e){let t;if(t=e.target,!t)return;let r=t.parentNode,a=Number(r.getAttribute("index"));this._activeThumb=a;let i=r.parentElement,s=i.getBoundingClientRect(),o=r.previousElementSibling,n=r.nextElementSibling,l=r.querySelector(".slider-thumb-tooltip");const c=o.offsetWidth+n.offsetWidth,d=s.width;let u=Array.from(i.querySelectorAll(".slider-slot")),h=u.map(e=>e.offsetWidth),p=0,m=-1;u.forEach((e,t)=>{e==o?m=t:-1==m&&(p+=h[t])});let f=e=>{let t;t=e instanceof TouchEvent?e.changedTouches[0].pageX:e.pageX;let r=t-s.left;r<0?r=0:r>s.width&&(r=s.width),r>c+p&&(r=c+p),r<p&&(r=p),o.style.width=Math.round(r-p)+"px",n.style.width=Math.round(c-(r-p))+"px";let a=r/d*1440;a=a>=1440?a=1440:ne(a,this.stepSize),l.dispatchEvent(new CustomEvent("update",{detail:{time:a}}))};var v=()=>{window.removeEventListener("mousemove",f),window.removeEventListener("touchmove",f),window.removeEventListener("mouseup",v),window.addEventListener("touchend",v);let e=de(l.innerText),t=Xi(this.slots[m])+Xi(this.slots[m+1]),r=this.slots[m].startTime,a=[...this.slots];Object.assign(a[m],{endTime:e}),Object.assign(a[m+1],{startTime:e,endTime:r+t});let i=new CustomEvent("update",{detail:{slots:a}});this.dispatchEvent(i),f=()=>{},this._activeThumb=null};window.addEventListener("mouseup",v),window.addEventListener("touchend",v),window.addEventListener("mousemove",f),window.addEventListener("touchmove",f)}_updateMarker(e){let t=e.detail,r=0;if(t.hasOwnProperty("time"))r=Number(t.time);else if(t.hasOwnProperty("index")){let e=t.index;r=this.slots[e].endTime}1440==r&&(r-=1),e.target.innerText=le(r).time}_addSlot(){let e=this.slots[this._activeSlot],t=e.startTime,r=e.endTime,a=ne(t+Xi(e)/2,this.stepSize),i=[...this.slots];Object.assign(i[this._activeSlot],{endTime:a}),i.splice(this._activeSlot+1,0,{startTime:a,endTime:r});let s=new CustomEvent("update",{detail:{slots:i}});this.dispatchEvent(s)}_removeSlot(){let e=this._activeSlot==this.slots.length-1?this._activeSlot-1:this._activeSlot,t=Object.assign({},this.slots[e]);Object.assign(t,{endTime:this.slots[e+1].endTime});let r=[...this.slots];r.splice(e,2,t);let a=new CustomEvent("update",{detail:{slots:r}});this.dispatchEvent(a)}};es.styles=te`

      div.slider-track {
        height: 45px;
        width: 100%;
        display: flex;
      }
      
      div.slider-slot {
        height: calc(100%);
        width: 50%;
        display: flex;
        background: var(--primary-color);
        opacity: 0.85;
        z-index: 1;
        cursor: pointer;
        color: var(--text-primary-color);
        justify-content: center;
        align-items: center;
      }
      div.slider-slot.active {
        opacity: 0.85;
        background: var(--accent-color);
      }
      div.slider-slot:hover, div.slider-slot.active:hover {
        opacity: 1;
      }
      
      div.slider-track div.slider-slot:first-of-type {
        border-radius: 4px 0px 0px 4px;
      }
      div.slider-track div.slider-slot:last-of-type {
        border-radius: 0px 4px 4px 0px;
      }
      div.slider-thumb {
        height: 100%;
        width: 2px;
        background: var(--card-background-color);
        display: flex;
        cursor: pointer;
        z-index: 5;
        margin: 0px -1px;
      }
      div.slider-thumb ha-icon {
        background: var(--card-background-color);
        color: var(--primary-text-color);
        width: 26px;
        height: 26px;
        --mdc-icon-size: 26px;
        border-radius: 100%;
        margin-left: -12px;
        margin-top: 10px;
      }

      div.slider-legend {
        display: flex;
        width: 100%;
      }
      div.slider-legend-item {
        width: calc(100% / 8);
        font-size: 0.8em;
        display: flex;
        justify-content: center;
      }
      div.slider-legend-item.empty {
        width: calc(100% / 16);
        display: flex;
      }
      div.slider-thumb-tooltip {
        background: var(--primary-color);
        color: var(--text-primary-color);
        border-radius: 5px;
        font-size: 0.8em;
        position: absolute;
        height: 20px;
        width: 50px;
        margin-top: -21px;
        margin-left: -25px;
        text-align: center;
        line-height: 20px;
      }

      .padded-right {
        margin-right: 11px;
      }
      
      mwc-button {
        margin: 2px 0px;
      }

      mwc-button.active {
        background: var(--primary-color);
        --mdc-theme-primary: var(--text-primary-color);
        border-radius: 4px;
      }
  `,t([Z({type:Array})],es.prototype,"slots",void 0),t([Z({type:Array})],es.prototype,"actions",void 0),t([Z({type:Number})],es.prototype,"stepSize",void 0),t([Z({type:Number})],es.prototype,"_activeSlot",void 0),t([Z({type:Number})],es.prototype,"_activeThumb",void 0),t([Z({type:String})],es.prototype,"temperatureUnit",void 0),es=t([J("timeslot-editor")],es),window.customCards=window.customCards||[],window.customCards.push({type:"scheduler-card",name:"Scheduler Card",description:"Card to manage schedule entities made with scheduler-component."}),console.info(`%c   SCHEDULER-CARD   \n%c   Version: ${"1.5.1".padEnd(8," ")}\n%c   Language: ${Sr().padEnd(7," ")}`,"color: orange; font-weight: bold; background: black","color: white; font-weight: bold; background: dimgray","color: white; font-weight: bold; background: dimgray"),e.SchedulerCard=class extends ae{constructor(){super(...arguments),this._config=me,this.Config=new Yr,this._entities={},this.scheduleItems=[],this.newItem=!1,this.editItem=!1,this.newItemConfirmed=!1,this._entry=Object.assign({},ve),this._slots=[],this._slotNum=null,this._selectedGroup=""}static get styles(){return Xr}set hass(e){this._hass||this.init(e),this.updateScheduleList(e),this._hass=e}init(e){void 0!==e.states["sun.sun"]&&(this._config=Object.assign(Object.assign({},this._config),{sunrise:de(e.states["sun.sun"].attributes.next_rising),sunset:de(e.states["sun.sun"].attributes.next_setting)})),e.config.unit_system&&e.config.unit_system.temperature&&(this._config=Object.assign(Object.assign({},this._config),{temperature_unit:e.config.unit_system.temperature})),e.user.is_admin||(this._config=Object.assign(Object.assign({},this._config),{is_admin:!1})),this.Config.LoadEntities(e.states)}updateScheduleList(e){let t=Cr(e.states,(e,t)=>Jr(t));qr(t,this._entities)||(this._entities=t,this.scheduleItems=Object.values(t).map(e=>function(e,t){if(!e.attributes.actions||!e.attributes.entries)return null;let r=e.attributes.actions.map(e=>{let r=Gr(e);if(!t.FindEntity(r.entity))return null;let a=Kr(r,t.GetActionsForEntity(r.entity));if(!a)return null;let i={entity:r.entity,action:a.id};if(a.variable&&a.variable.type==ie.Level){if(a.variable.type==ie.Level){let e;e=r.service_data&&a.variable.field in r.service_data?{type:ie.Level,value:Number(r.service_data[a.variable.field]),enabled:!0}:{type:ie.Level,value:null,enabled:!1},i=$r(i,{variable:e})}}else if(a.variable&&a.variable.type==ie.List){let e;e=r.service_data&&a.variable.field in r.service_data?{type:ie.List,value:String(r.service_data[a.variable.field])}:{type:ie.List,value:null},i=$r(i,{variable:e})}return i}),a=[];return e.attributes.entries.forEach(e=>{let t,i=Ki.exec(e),s=Bi.exec(i[3]).map(Number),o=Ji.exec(i[2]);return t=o?{event:"SR"==o[2]?se.Sunrise:se.Sunset,value:o[1]?-de(o[1]):de(o[3])}:{value:de(i[2])},s.filter(e=>r[e]).forEach(e=>{a.push($r(r[e],{time:t,days:he(i[1].split("").map(Number))}))})}),a.length?{entries:a,id:e.entity_id,enabled:"off"!=e.state}:null}(e,this.Config)).filter(e=>e))}setConfig(e){!function(e){if(!Hi.validate(Gi,e)){let e=Hi.errors.map(e=>{let t="",r=e.dataPath.substr(1).split("/"),a=r.pop();return r.length&&(t+=`in ${r.join("/")} `),"type"==e.keyword&&(t+="type of "),a?a&&(t+=(isNaN(+a)?`'${a}'`:`[item ${a}]`)+" "):t+="card ",t+=e.message,e.params.hasOwnProperty("additionalProperty")&&(t+=` '${e.params.additionalProperty}'`),t.charAt(0).toUpperCase()+t.slice(1)+"."});throw new Error("Invalid configuration provided. "+e.join(" //////////////////////////////////// "))}}(e);this._config=Object.assign(Object.assign({},this._config),jr(e,Object.keys(this._config))),this.Config.setUserConfig(jr(e,["groups","domains","entities","discover_existing","standard_configuration"]))}getCardSize(){return this._hass&&this.scheduleItems.length?6+2*this.scheduleItems.length:6}render(){return this.newItem||this.editItem?this.newItem&&!this.newItemConfirmed?T`
        <ha-card>
          ${this.getTitle()}
          <div class="card-section first">
            <div class="header">${Pr("fields.group")}</div>
            <div class="option-list">
            ${this.getGroups()}
            </div>
          </div>
          <div class="card-section">
            <div class="header">${Pr("fields.entity")}</div>
            <div class="option-list">
            ${this.getEntities()}
            </div>
          </div>
          ${this.getActions()}
          <div class="card-section last">
            <mwc-button outlined @click="${this._cancelEditClick}">${Pr("actions.cancel")}</mwc-button>
            ${this._entry.action?T`<mwc-button outlined @click="${this._confirmItemClick}">${Pr("actions.next")}</mwc-button>`:T`<mwc-button outlined disabled>${Pr("actions.next")}</mwc-button>`}
          </div>
        </ha-card>
      `:this._entry.action==ye?T`
      <ha-card>
        ${this.getTitle()}
        ${this.showRoutineEditor()}
      </ha-card>
      `:T`
      <ha-card>
        ${this.getTitle()}
        ${this.showEditor()}
      </ha-card>
      `:T`
      <ha-card>
        ${this.getTitle()}
        <div class="card-section first">
        ${this.getEntries()}
        </div>
        ${this._config.is_admin?T`
        <div class="card-section last">
          <mwc-button outlined @click="${this._addItemClick}">${Pr("actions.add")}</mwc-button>
        </div>`:""}
      </ha-card>
      `}getTitle(){return"string"==typeof this._config.title?T`<div class="card-header">${this._config.title}</div>`:this._config.title?T`<div class="card-header">${Pr("scheduler")}</div>`:T``}getEntries(){return this.scheduleItems&&this.scheduleItems.length?this.scheduleItems.map(e=>{let t=this.Config.FindEntity(e.entries[0].entity),r=this.Config.FindAction(e.entries[0].entity,e.entries[0].action);if(!t||!r)return T``;if(1==e.entries.length)return T`
          <div class="list-item${e.enabled?"":" disabled"}" @click="${()=>this._editItemClick(e.id)}">
            <div class="list-item-icon">
              ${t.icon?T`<ha-icon icon="${Nr(t.icon)}"></ha-icon>`:""}
            </div>
            <div class="list-item-name">
              ${Ir(t.name)}
            </div>
            <div class="list-item-action">
              ${Tr(e.entries[0],r,{temperature_unit:this._config.temperature_unit})}
            </div>
            <div class="list-item-days">
              ${Vr(Rr(e.entries[0].days))}
            </div>
            <div class="list-item-time">
              ${Vr(zr(e.entries[0].time,{amPm:this._config.am_pm,sunrise:this._config.sunrise,sunset:this._config.sunset}))}
            </div>
            <div class="list-item-switch">
              ${e.enabled?T`<ha-switch checked="checked" @click="${t=>this.toggleDisable(e.id,t)}"></ha-switch>`:T`<ha-switch @click="${t=>this.toggleDisable(e.id,t)}"></ha-switch>`}
            </div>
          </div>
      `;{let r=e.entries.map(e=>{let t=Tr(e,this.Config.FindAction(e.entity,e.action),{temperature_unit:this._config.temperature_unit}),r=zr(e.time,{amPm:this._config.am_pm,sunrise:this._config.sunrise,sunset:this._config.sunset});return T`${t} ${r}<br>`});return T`
          <div class="list-item${e.enabled?"":" disabled"}" @click="${()=>this._editItemClick(e.id)}">
            <div class="list-item-icon">
              ${t.icon?T`<ha-icon icon="${Nr(t.icon)}"></ha-icon>`:""}
            </div>
            <div class="list-item-name">
              ${Ir(t.name)}
            </div>
            <div class="list-item-action">
              ${r}
            </div>
            <div class="list-item-days">
              ${Vr(Rr(e.entries[0].days))}
            </div>
            <div class="list-item-time">
            </div>
            <div class="list-item-switch">
              ${e.enabled?T`<ha-switch checked="checked" @click="${t=>this.toggleDisable(e.id,t)}"></ha-switch>`:T`<ha-switch @click="${t=>this.toggleDisable(e.id,t)}"></ha-switch>`}
            </div>
          </div>
        `}}):[T`
      <div class="text-field">
        ${Pr("instructions.no_entries_defined")}
      </div>
    `]}toggleDisable(e,t){t.stopPropagation(),!t.target.checked?this._hass.callService("switch","turn_on",{entity_id:e}):this._hass.callService("switch","turn_off",{entity_id:e})}getGroups(){let e=this.Config.GetGroups();return e.length?e.map(e=>T`
        <mwc-button class="${this._selectedGroup==e.id?" active":""}" @click="${()=>{this.selectGroup(e.id)}}">
          ${e.icon?T`<ha-icon icon="${Nr(e.icon)}" class="padded-right"></ha-icon>`:""}
          ${Ir(e.name)}
        </mwc-button>
      `):[T`<div class="text-field">${Pr("instructions.no_groups_defined")}</div>`]}selectGroup(e){this._selectedGroup=e,1==this.Config.GetEntitiesForGroup(e).length?this.selectEntity(this.Config.GetEntitiesForGroup(e)[0].id):this._entry=Object.assign({},ve)}getEntities(){if(!this._selectedGroup)return[T`<div class="text-field">${Pr("instructions.no_group_selected")}</div>`];let e=this.Config.GetEntitiesForGroup(this._selectedGroup);return e.length?e.map(e=>T`
        <mwc-button class="${this._entry.entity==e.id?" active":""}" @click="${()=>{this.selectEntity(e.id)}}">
          ${e.icon?T`<ha-icon icon="${Nr(e.icon)}" class="padded-right"></ha-icon>`:""}
          ${Ir(e.name)}
        </mwc-button>
      `):[T`<div class="text-field">${Pr("instructions.no_entities_for_group")}</div>`]}selectEntity(e){this._entry=Object.assign(Object.assign({},this._entry),{entity:e}),1==this.Config.GetActionsForEntity(e).length&&this.selectAction(this.Config.GetActionsForEntity(e)[0].id)}getActions(){if(!this._entry.entity)return T`
          <div class="card-section">
            <div class="header">${Pr("fields.action")}</div>
            <div class="option-list">
              <div class="text-field">${Pr("instructions.no_entity_selected")}</div>
            </div>
          </div>
      `;let e=this.Config.GetActionsForEntity(this._entry.entity);if(!e.length)return T`
          <div class="card-section">
            <div class="header">${Pr("fields.action")}</div>
            <div class="option-list">
              <div class="text-field">${Pr("instructions.no_actions_for_entity")}</div>
            </div>
          </div>
      `;1==e.length&&this.selectAction(e[0].id);let t=e.filter(e=>e.id!=ye).map(e=>T`
        <mwc-button class="${this._entry.action==e.id?" active":""}" @click="${()=>{this.selectAction(e.id)}}">
          ${e.icon?T`<ha-icon icon="${Nr(e.icon)}" class="padded-right"></ha-icon>`:""}
          ${Ir(e.name)}
        </mwc-button>
      `),r=[T``];return r=e.filter(e=>e.id==ye).map(e=>T`
        <div class="card-section first">
          <div class="header">or</div>
          <div class="option-list">
            <mwc-button class="${this._entry.action==e.id?" active":""}" @click="${()=>{this.selectAction(e.id)}}">
              ${e.icon?T`<ha-icon icon="${Nr(e.icon)}" class="padded-right"></ha-icon>`:""}
              ${Ir(e.name)}
            </mwc-button>
          </div>
        </div>
      `),T`
          <div class="card-section">
            <div class="header">${Pr("fields.action")}</div>
            <div class="option-list">
              ${t}
            </div>
          </div>
          ${r}
      `}selectAction(e){this._entry=Object.assign(Object.assign({},this._entry),{action:e})}showEditor(){let e=this.Config.FindEntity(this._entry.entity),t=this.Config.FindAction(this._entry.entity,this._entry.action);return e&&t?T`
    <div class="card-section first">
      <div class="header">${Pr("fields.action")}</div>
      <div class="summary">
        <div class="summary-entity">
          <div class="summary-icon">
            ${e.icon?T`<ha-icon icon="${Nr(e.icon)}"></ha-icon>`:""}
          </div>
          <div class="summary-text">
            ${Ir(e.name)}
          </div>
        </div>
        <div class="summary-arrow">
          <ha-icon icon="hass:arrow-right"></ha-icon>
        </div>
        <div class="summary-action">
          <div class="summary-icon">
            ${t.icon?T`<ha-icon icon="${Nr(t.icon)}"></ha-icon>`:""}
          </div>
          <div class="summary-text">
            ${Ir(t.name)}
          </div>
        </div>
      </div>
     </div>
     ${t.variable&&t.variable.type==ie.Level?this.getLevelPanel(t.variable):""}
     ${t.variable&&t.variable.type==ie.List?this.getListPanel(t.variable):""}
     ${this.getDayPicker()}
      
    <div class="card-section">
      <div class="header">${Pr("fields.time")}</div>
      <time-picker value=${this._entry.time.value} event=${this._entry.time.event} stepSize="${this._config.time_step}" formatAmPm="${this._config.am_pm}" sunrise="${this._config.sunrise}" sunset="${this._config.sunset}" @change="${this.updateTime}"></timepicker>
    </div>

    <div class="card-section last">
      <mwc-button outlined @click="${this._cancelEditClick}">${Pr("actions.cancel")}</mwc-button>
      ${this.newItem||!this._config.is_admin?"":T`<mwc-button outlined @click="${this._deleteItemClick}">${Pr("actions.delete")}</mwc-button>`}
      <mwc-button outlined @click="${this._saveItemClick}">${Pr("actions.save")}</mwc-button>
    </div>
    `:T``}getDayPicker(){var e,t,r,a,i,s;let o=(null===(e=this._entry.days)||void 0===e?void 0:e.custom_days)?null===(t=this._entry.days)||void 0===t?void 0:t.custom_days:[],n=(null===(r=this._entry.days)||void 0===r?void 0:r.type)==oe.Custom?T`
      <div class="day-list" id="day-list-custom">
        <mwc-button class="day-item${o.includes(1)?" active":""}" @click="${()=>this.selectDays(1)}">${Pr("days_short.mon")}</mwc-button>
        <mwc-button class="day-item${o.includes(2)?" active":""}" @click="${()=>this.selectDays(2)}">${Pr("days_short.tue")}</mwc-button>
        <mwc-button class="day-item${o.includes(3)?" active":""}" @click="${()=>this.selectDays(3)}">${Pr("days_short.wed")}</mwc-button>
        <mwc-button class="day-item${o.includes(4)?" active":""}" @click="${()=>this.selectDays(4)}">${Pr("days_short.thu")}</mwc-button>
        <mwc-button class="day-item${o.includes(5)?" active":""}" @click="${()=>this.selectDays(5)}">${Pr("days_short.fri")}</mwc-button>
        <mwc-button class="day-item${o.includes(6)?" active":""}" @click="${()=>this.selectDays(6)}">${Pr("days_short.sat")}</mwc-button>
        <mwc-button class="day-item${o.includes(7)?" active":""}" @click="${()=>this.selectDays(7)}">${Pr("days_short.sun")}</mwc-button>
      </div>`:"";return T`
    <div class="card-section">
      <div class="header">${Pr("fields.days")}</div>
      <div class="day-list">
        <mwc-button class="day-item${(null===(a=this._entry.days)||void 0===a?void 0:a.type)==oe.Daily?" active":""}" @click="${()=>this.selectDays("daily")}">${Pr("fields.day_type_daily")}</mwc-button>
        <mwc-button class="day-item${(null===(i=this._entry.days)||void 0===i?void 0:i.type)==oe.Weekdays?" active":""}" @click="${()=>this.selectDays("weekdays")}">${Pr("fields.day_type_weekdays")}</mwc-button>
        <mwc-button class="day-item${(null===(s=this._entry.days)||void 0===s?void 0:s.type)==oe.Custom?" active":""}" @click="${()=>this.selectDays("custom")}">${Pr("fields.day_type_custom")}</mwc-button>
      </div>
      ${n}
    </div>`}updateTime(e){let t=e.target,r=Number(t.value),a="sunrise"==e.detail.event?se.Sunrise:se.Sunset;Object.assign(this._entry,{time:e.detail.event?{event:a,value:r}:{value:r}})}selectDays(e){var t;let r=Object.assign({},this._entry.days);if("string"==typeof e){let t=oe.Custom;"daily"==e?t=oe.Daily:"weekdays"==e&&(t=oe.Weekdays),Object.assign(r,{type:t}),t!=oe.Custom||r.custom_days||Object.assign(r,{custom_days:ue(this._entry.days)})}else{let a=(null===(t=this._entry.days)||void 0===t?void 0:t.custom_days)?[...this._entry.days.custom_days]:[];a.includes(e)?a.length>1&&(a=a.filter(t=>t!=e)):a.push(e),Object.assign(r,{custom_days:a})}this._entry=Object.assign(Object.assign({},this._entry),{days:r})}showRoutineEditor(){var e,t;let r=this.Config.FindEntity(this._entry.entity),a=this.Config.FindAction(this._entry.entity,this._entry.action);if(!r||!a)return T``;let i=this.Config.GetActionsForEntity(this._entry.entity).filter(e=>e.routine),s=null!==this._slotNum?this._slots[this._slotNum]:null,o=s?i.find(e=>e.id==s.action):null;if(null!==this._slotNum&&o&&o.variable){let r=[...this._slots],a=Object.assign({},r[this._slotNum]);if((null===(e=this._entry.variable)||void 0===e?void 0:e.type)==ie.Level){let e=this._entry.variable;Object.assign(a,{variable:{value:e.value,enabled:e.enabled}})}else if((null===(t=this._entry.variable)||void 0===t?void 0:t.type)==ie.List){let e=this._entry.variable;Object.assign(a,{variable:{value:e.value}})}r[this._slotNum]=a,this._slots=r}return r&&a?T`
    <div class="card-section first">
      <div class="header">${Pr("fields.action")}</div>
      <div class="summary">
        <div class="summary-entity">
          <div class="summary-icon">
            ${r.icon?T`<ha-icon icon="${Nr(r.icon)}"></ha-icon>`:""}
          </div>
          <div class="summary-text">
            ${Ir(r.name)}
          </div>
        </div>
        <div class="summary-arrow">
          <ha-icon icon="hass:arrow-right"></ha-icon>
        </div>
        <div class="summary-action">
          <div class="summary-icon">
            ${a.icon?T`<ha-icon icon="${Nr(a.icon)}"></ha-icon>`:""}
          </div>
          <div class="summary-text">
            ${Ir(a.name)}
          </div>
        </div>
      </div>
     </div>
    ${this.getDayPicker()}
      
    <div class="card-section">
      <div class="header">${Pr("fields.time")}</div>
      <timeslot-editor
        actions=${JSON.stringify(i)}
        slots=${JSON.stringify(this._slots)}
        @update=${this.handlePlannerUpdate}
      >
      </timeslot-editor>
    </div>
    <div class="card-section">
      <div class="header">${Pr("fields.action")}</div>
      <div class="option-list">
        <div class="text-field">${this.getPlannerActions()}</div>
      </div>
    </div>
     ${o&&o.variable?this.getLevelPanel(o.variable,!0):""}

    <div class="card-section last">
      <mwc-button outlined @click="${this._cancelEditClick}">${Pr("actions.cancel")}</mwc-button>
      ${this.newItem||!this._config.is_admin?"":T`<mwc-button outlined @click="${this._deleteItemClick}">${Pr("actions.delete")}</mwc-button>`}
      <mwc-button outlined @click="${this._saveItemClick}">${Pr("actions.save")}</mwc-button>
    </div>
    `:T``}handlePlannerUpdate(e){e.target;if(e.detail.hasOwnProperty("slot")){let t=Number(e.detail.slot);this._slotNum=t;let r=this._slots[t];if(r.variable){let e=r.variable;Object.assign(this._entry,{variable:{level:Number(e.value),levelEnabled:e.enabled}})}else Object.assign(this._entry,{variable:void 0})}else if(e.detail.hasOwnProperty("slots")){let t=e.detail.slots;this._slots=[...t]}this.requestUpdate()}getPlannerActions(){if(null===this._slotNum)return T`<div class="text-field">select a timeslot first</div>`;let e=this.Config.GetActionsForEntity(this._entry.entity),t=this._slots[this._slotNum];return e.filter(e=>e.id!=ye).map(e=>T`
        <mwc-button class="${t.action==e.id?" active":""}" @click="${()=>{this.selectPlannerAction(e)}}">
          ${e.icon?T`<ha-icon icon="${Nr(e.icon)}" class="padded-right"></ha-icon>`:""}
          ${Ir(e.name)}
        </mwc-button>
      `)}selectPlannerAction(e){let t=[...this._slots],r=Object.assign({},t[this._slotNum]);if(Object.assign(r,{action:r.action==e.id?null:e.id}),r.action&&e.variable&&e.variable.type==ie.Level){let t=r.variable,a=e.variable;Object.assign(this._entry,{variable:{level:void 0!==t.value?t.value:a.min,levelEnabled:void 0!==t.enabled?t.enabled:!a.optional}})}t[this._slotNum]=r,this._slots=t,this.requestUpdate()}getLevelPanel(e,t=!1){e.unit.length||"temperature"!=e.field||Object.assign(e,{unit:this._config.temperature_unit});let r=this._entry.variable;return T`
    <div class="card-section">
      <div class="header">${e.name}</div>
      <div class="option-item">
        <variable-slider
          min=${e.min}
          max=${e.max}
          step=${e.step}
          value=${r.value}      
          unit=${e.unit}
          optional=${e.optional}
          disabled=${!r.enabled}
          @change="${e=>{this.updateLevel(e,t)}}"
        >
        </variable-slider>
      </div>
     </div>`}updateLevel(e,t){let r=e.target;if(!this._entry.variable)return;let a={type:ie.Level,value:Number(r.value),enabled:"false"==String(r.disabled)};Object.assign(this._entry,{variable:a}),t&&this.requestUpdate()}getListPanel(e){let t,r=e.options;return t=r.length?r.map(e=>{var t;return T`
        <mwc-button class="${(null===(t=this._entry.variable)||void 0===t?void 0:t.value)==e.value?" active":""}" @click="${()=>{this.selectListItem(e.value)}}">
          ${e.icon?T`<ha-icon icon="${Nr(e.icon)}" class="padded-right"></ha-icon>`:""}
          ${Ir(e.value)}
        </mwc-button>
      `}):T`<div class="text-field">${Pr("instructions.no_entries_defined")}</div>`,T`
    <div class="card-section">
      <div class="header">${e.name}</div>
      ${t}
     </div>`}selectListItem(e){let t={type:ie.List,value:String(e)};this._entry=Object.assign(Object.assign({},this._entry),{variable:t})}_addItemClick(){this.newItem=!0,this.newItemConfirmed=!1,this._entry=Object.assign({},ve);let e=this.Config.GetGroups();1==e.length&&(this.selectGroup(e[0].id),this._entry.action&&this._confirmItemClick())}_cancelEditClick(){this.newItem=!1,this.editItem=!1}_confirmItemClick(){this.newItemConfirmed=!0;let e=this.Config.FindAction(this._entry.entity,this._entry.action);if(e&&e.variable){let t;if((null==e?void 0:e.variable.type)==ie.Level){let r=e.variable;t={type:ie.Level,value:null,enabled:!r.optional}}else if((null==e?void 0:e.variable.type)==ie.List){let r=e.variable;t={type:ie.List,value:r.options[0].value}}this._entry=Object.assign(this._entry,{variable:t})}}_saveItemClick(){let e,t;if(this._entry.action==ye){t=this._slots.filter(e=>e.action).map(e=>Object.assign(Object.assign({},e),{time:{value:e.startTime},days:this._entry.days,action:e.action,entity:this._entry.entity}))}else t=[this._entry];e=function(e,t){let r=[],a=[];return e.forEach(e=>{let i=t.FindAction(e.entity,e.action),s={entity:e.entity,service:Fr(i.service)?i.service:`${Fr(e.entity)}.${i.service}`,service_data:{}};var o,n;i.hasOwnProperty("service_data")&&Object.assign(s,{service_data:i.service_data}),"variable"in e&&"variable"in i&&Object.assign(s,{service_data:(o=e.variable,n=i.variable,o.type==ie.Level?o.enabled?{[n.field]:String(o.value)}:{}:o.type==ie.List?{[n.field]:String(o.value)}:{})});let l=a.findIndex(e=>qr(e,s));l<0&&(l=a.push(s)-1);let c={actions:[l]};e.time.event?Object.assign(c,{event:pe(e.time.event),offset:le(e.time.value).time}):Object.assign(c,{time:le(e.time.value).time}),e.days.type!=oe.Daily&&Object.assign(c,{days:ue(e.days)}),r.push(c)}),{actions:a,entries:r}}(t,this.Config),this.newItem?this._hass.callService("scheduler","add",e):this.editItem&&this._hass.callService("scheduler","edit",Object.assign(e,{entity_id:this.editItem})),this.newItem=!1,this.editItem=!1}_deleteItemClick(){let e=this.editItem;this._hass.callService("scheduler","remove",{entity_id:e}),this.newItem=!1,this.editItem=!1}_editItemClick(e){let t=this.scheduleItems.find(t=>t.id==e);t&&(1==t.entries.length?this._entry=Object.assign({},t.entries[0]):(this._entry=Object.assign({},t.entries[0]),this._slots=function(e){let t=e.map(e=>{let t={startTime:e.time.value,endTime:e.time.value,action:e.action};return e.hasOwnProperty("level")&&Object.assign(t,{variable:e.variable}),t});t.find(e=>0==e.startTime)||t.push({startTime:0,endTime:0}),t.sort((e,t)=>e.startTime>t.startTime?1:-1);let r,a=1440;for(r=t.length-1;r>=0;r--)t[r].endTime=a,a=t[r].startTime;return t}(t.entries),this._slotNum=null),this.editItem=e)}},t([Z({type:Array})],e.SchedulerCard.prototype,"scheduleItems",void 0),t([Z({type:Object})],e.SchedulerCard.prototype,"_hass",void 0),t([Z({type:Boolean})],e.SchedulerCard.prototype,"newItem",void 0),t([Z({type:Boolean})],e.SchedulerCard.prototype,"editItem",void 0),t([Z({type:Boolean})],e.SchedulerCard.prototype,"newItemConfirmed",void 0),t([Z({type:Object})],e.SchedulerCard.prototype,"_entry",void 0),t([Z({type:Array})],e.SchedulerCard.prototype,"_slots",void 0),t([Z({type:Number})],e.SchedulerCard.prototype,"_slotNum",void 0),t([Z({type:String})],e.SchedulerCard.prototype,"_selectedGroup",void 0),e.SchedulerCard=t([J("scheduler-card")],e.SchedulerCard)}({});
